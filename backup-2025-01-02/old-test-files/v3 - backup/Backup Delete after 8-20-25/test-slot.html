<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Slot Machine Test</title>
    <style>
        body {
            background: #1a1a2e;
            color: #fff;
            font-family: monospace;
            padding: 20px;
        }
        #test-results {
            background: #0f0f23;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            white-space: pre-wrap;
            max-height: 400px;
            overflow-y: auto;
        }
        .test-pass { color: #4ade80; }
        .test-fail { color: #f87171; }
        .test-info { color: #60a5fa; }
        button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background: #2563eb;
        }
    </style>
</head>
<body>
    <h1>Slot Machine Test Suite</h1>
    <button onclick="runTests()">Run Tests</button>
    <div id="test-results"></div>

    <script>
        const results = document.getElementById('test-results');
        
        function log(message, type = 'info') {
            const className = type === 'pass' ? 'test-pass' : 
                            type === 'fail' ? 'test-fail' : 'test-info';
            results.innerHTML += `<span class="${className}">${message}</span>\n`;
        }
        
        async function runTests() {
            results.innerHTML = '';
            log('Starting Slot Machine Tests...', 'info');
            log('=====================================', 'info');
            
            // Test 1: Check winner position calculation
            log('\nTest 1: Winner Position Calculation', 'info');
            const winnerPosition = 20;
            const itemHeight = 80;
            const expectedTransform = -(winnerPosition * itemHeight - itemHeight); // -1520px
            log(`Winner at index ${winnerPosition} should land at ${expectedTransform}px`, 'info');
            if (expectedTransform === -1520) {
                log('✓ Position calculation correct', 'pass');
            } else {
                log(`✗ Expected -1520px, got ${expectedTransform}px`, 'fail');
            }
            
            // Test 2: Viewport coverage
            log('\nTest 2: Viewport Coverage at -1520px', 'info');
            const viewportHeight = 240;
            const itemsVisible = viewportHeight / itemHeight;
            const firstVisibleIndex = Math.abs(expectedTransform) / itemHeight;
            const lastVisibleIndex = firstVisibleIndex + itemsVisible - 1;
            log(`At -1520px, visible items: ${firstVisibleIndex} to ${lastVisibleIndex}`, 'info');
            log(`Center item index: ${Math.floor((firstVisibleIndex + lastVisibleIndex) / 2)}`, 'info');
            if (Math.floor((firstVisibleIndex + lastVisibleIndex) / 2) === 20) {
                log('✓ Winner will be centered in viewport', 'pass');
            } else {
                log('✗ Winner not centered', 'fail');
            }
            
            // Test 3: Transform regex patterns
            log('\nTest 3: Transform Regex Patterns', 'info');
            const testTransforms = [
                'translateY(-1520px)',
                'translate3d(0, -1520px, 0)',
                'translate3d(0px, -1520px, 0px)'
            ];
            
            testTransforms.forEach(transform => {
                const matchY = transform.match(/translateY\((-?\d+(?:\.\d+)?)px\)/);
                const match3d = transform.match(/translate3d\([^,]+,\s*(-?\d+(?:\.\d+)?)px/);
                const value = matchY?.[1] || match3d?.[1];
                
                if (value === '-1520') {
                    log(`✓ Parsed "${transform}" correctly: ${value}px`, 'pass');
                } else {
                    log(`✗ Failed to parse "${transform}": got ${value}`, 'fail');
                }
            });
            
            // Test 4: Array indexing without padding
            log('\nTest 4: Array Indexing (No Padding)', 'info');
            const testArray = new Array(100).fill(null).map((_, i) => `Item${i}`);
            testArray[20] = 'WINNER';
            log(`Array[20] = "${testArray[20]}"`, 'info');
            log(`Items 19-21: ["${testArray[19]}", "${testArray[20]}", "${testArray[21]}"]`, 'info');
            if (testArray[20] === 'WINNER') {
                log('✓ Winner at correct index without padding', 'pass');
            } else {
                log('✗ Winner position incorrect', 'fail');
            }
            
            // Test 5: SimpleSpinAnimation landing
            log('\nTest 5: SimpleSpinAnimation Landing', 'info');
            const finalPositions = [-1520, -1520, -1520, -1520, -1520];
            log(`Final positions: ${JSON.stringify(finalPositions)}`, 'info');
            const allCorrect = finalPositions.every(pos => pos === -1520);
            if (allCorrect) {
                log('✓ All reels will land at -1520px', 'pass');
            } else {
                log('✗ Reel positions incorrect', 'fail');
            }
            
            log('\n=====================================', 'info');
            log('Tests Complete!', 'info');
        }
        
        // Auto-run tests on load
        window.addEventListener('load', runTests);
    </script>
</body>
</html>