<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
    />
    <title>Help Us Make This Less Terrible | The Finals Loadout</title>
    <meta
      name="description"
      content="Spin the wheel, vent your frustrations, and maybe win a reward. Submit your feedback to help us make The Finals Loadout Generator slightly less terrible."
    />
    <link rel="canonical" href="https://thefinalsloadout.com/feedback/" />

    <!-- Open Graph -->
    <meta
      property="og:title"
      content="Help Us Make This Less Terrible | The Finals Loadout"
    />
    <meta
      property="og:description"
      content="Your feedback powers this site. Report bugs, suggest features, or just scream into the void."
    />
    <meta
      property="og:image"
      content="https://www.thefinalsloadout.com/images/feedback-logo3.webp"
    />
    <meta
      property="og:url"
      content="https://www.thefinalsloadout.com/feedback/"
    />
    <meta property="og:type" content="website" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta
      name="twitter:title"
      content="Help Us Make This Less Terrible | The Finals Loadout"
    />
    <meta
      name="twitter:description"
      content="Submit feedback and you might just get your ridiculous idea added to the next patch."
    />
    <meta
      name="twitter:image"
      content="https://www.thefinalsloadout.com/images/feedback-logo3.webp"
    />

    <!-- Structured Data -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "WebPage",
        "name": "Help Us Make This Less Terrible | The Finals Loadout",
        "description": "Submit feedback to improve The Finals Loadout Generator. Whether it's bugs, feature requests, or passionate rants — we want to hear it.",
        "url": "https://www.thefinalsloadout.com/feedback/",
        "image": "https://www.thefinalsloadout.com/images/feedback-logo3.webp",
        "author": {
          "@type": "Organization",
          "name": "Paul Takisaki"
        }
      }
    </script>

    <!-- Google Analytics -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-GVGKYFGZ1Z"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "G-GVGKYFGZ1Z");
    </script>

    <!-- Fonts & Favicon -->
    <link rel="icon" type="image/x-icon" href="images/favicon.ico" />
    <link
      href="https://fonts.googleapis.com/css2?family=Oswald:wght@200..700&display=swap"
      rel="stylesheet"
    />

    <!-- Styles -->
    <link rel="stylesheet" href="../style.css" />
    <link rel="stylesheet" href="styles.css" />
  </head>

  <body>
    <!-- Scroll Progress Bar -->
    <div class="scroll-progress-bar" id="scrollProgressBar"></div>

    <!-- Return to Top Button -->
    <button
      class="return-to-top"
      id="returnToTop"
      aria-label="Return to top"
      title="Return to top"
    >
      <svg
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
      >
        <polyline points="18 15 12 9 6 15"></polyline>
      </svg>
    </button>

    <nav class="main-nav">
      <a href="../index.html">LOADOUT GENERATOR</a>
      <a href="../ragequit/index.html">New Rage Quit</a>
      <a href="../patch-notes/index.html">Patch Notes</a>
      <a href="../meta-weapons/">Meta Weapons</a>
    </nav>

    <header class="headerSection">
      <img
        src="images/feedback-logo3.webp"
        alt="Feedback Roulette"
        class="feedback-logo"
      />
      <h1 class="feedback-title">Help Us Make This Less Terrible</h1>
      <p class="feedback-subtitle">
        Your feedback directly shapes The Finals Random Loadout Generator
        experience.
      </p>
    </header>

    <main class="feedback-container">
      <!-- Developer Note -->
      <section
        class="developer-note"
        style="
          background: rgba(0, 212, 255, 0.1);
          border-left: 4px solid #00d4ff;
          padding: 15px 20px;
          border-radius: 8px;
          margin-bottom: 20px;
          text-align: center;
        "
      >
        <p
          style="
            color: #f5f5f5;
            margin: 0;
            font-size: 0.95rem;
            line-height: 1.4;
          "
        >
          Built this as a solo project while learning to code. Feedback, bugs,
          and brutal honesty all welcome—I don't rage quit.
        </p>
      </section>

      <!-- Tally Feedback Form -->
      <section class="feedback-form-section">
        <iframe
          data-tally-src="https://tally.so/r/wkveY1"
          loading="lazy"
          width="100%"
          height="1200"
          frameborder="0"
          marginheight="0"
          marginwidth="0"
          title="Tally Form"
          style="height: 1200px; overflow: hidden"
        ></iframe>
      </section>
    </main>

    <footer class="footerSection" style="text-align: center">
      <div class="container" style="text-align: center">
        <div
          class="footerRow"
          style="justify-content: center; text-align: center"
        >
          <p style="text-align: center; width: 100%; margin: 0 auto">
            © 2025 TheFinalsLoadout.com | Created by
            <strong
              ><a
                href="https://www.paultakisaki.com/"
                rel="author"
                style="color: #ffb700"
                >Paul Takisaki</a
              ></strong
            >
            |
            <a href="../legal/index.html" style="color: #ffb700"
              >Legal Disclaimer</a
            >
          </p>
        </div>
      </div>
    </footer>

    <script>
      // Enhanced feedback system with session tracking
      let feedbackCount = parseInt(
        localStorage.getItem("feedbackCount") || "0"
      );
      let isSpinning = false;

      // Enhanced topic setting with glow effects
      function setTopic(category) {
        const typeSelect = document.getElementById("feedback-type");
        const label = document.getElementById("feedback-label");
        const textarea = document.getElementById("feedback-text");

        const prompts = {
          bug: {
            label: "What's broken?",
            placeholder:
              "Describe the bug: What happened? What did you expect? Steps to reproduce?",
            value: "bug",
          },
          weapons: {
            label: "Which weapon made you rage?",
            placeholder:
              "Tell us about weapon balance issues, overpowered weapons, or underpowered ones...",
            value: "weapon",
          },
          ideas: {
            label: "What's your dream feature?",
            placeholder:
              "Describe your idea: What would make this site amazing? New features, improvements?",
            value: "feature",
          },
          ui: {
            label: "What confused you?",
            placeholder:
              "UI/UX feedback: What was confusing? Hard to find? Could be improved?",
            value: "ui",
          },
          rage: {
            label: "What made you rage?",
            placeholder:
              "Let it all out. What frustrated you about the site or the game?",
            value: "rage",
          },
          love: {
            label: "What do you love?",
            placeholder:
              "Tell us what's working great! What features do you love?",
            value: "love",
          },
        };

        if (prompts[category]) {
          label.textContent = prompts[category].label;
          textarea.placeholder = prompts[category].placeholder;
          typeSelect.value = prompts[category].value;

          // Add glow effect to form
          const form = document.querySelector(".enhanced-form");
          form.style.boxShadow = "0 0 30px rgba(255, 183, 0, 0.4)";
          setTimeout(() => {
            form.style.boxShadow = "0 15px 35px rgba(0, 0, 0, 0.5)";
          }, 2000);
        }
      }

      // Weapon rating system
      document.querySelectorAll(".weapon-star").forEach((star) => {
        star.addEventListener("click", function () {
          const rating = this.dataset.rating;
          document.getElementById("rating").value = rating;

          document.querySelectorAll(".weapon-star").forEach((s, index) => {
            if (index < rating) {
              s.style.filter = "sepia(1) hue-rotate(45deg) brightness(1.2)";
              s.style.transform = "scale(1.2)";
            } else {
              s.style.filter = "grayscale(1)";
              s.style.transform = "scale(1)";
            }
          });
        });
      });

      // Enhanced form submission with session tracking
      document
        .getElementById("feedback-form")
        .addEventListener("submit", function (event) {
          event.preventDefault();

          feedbackCount++;
          localStorage.setItem("feedbackCount", feedbackCount.toString());

          const sendButton = document.getElementById("send-button");
          sendButton.classList.add("sending");
          sendButton.querySelector(".button-text").textContent = "SENDING...";

          // Simulate API call
          setTimeout(() => {
            showSuccessState();

            // Check for feedback frenzy mode
            if (feedbackCount >= 5) {
              triggerFeedbackFrenzy();
            }
          }, 2000);
        });

      // Enhanced success state with redirect
      function showSuccessState() {
        const form = document.getElementById("feedback-form");
        const response = document.getElementById("feedback-response");

        form.style.display = "none";
        response.style.display = "block";

        // Start countdown timer
        let countdown = 3;
        const countdownElement = document.getElementById("countdown");
        const timer = setInterval(() => {
          countdown--;
          countdownElement.textContent = countdown;
          if (countdown <= 0) {
            clearInterval(timer);
            window.location.href = "../index.html";
          }
        }, 1000);
      }

      // Feedback Frenzy Mode - Easter Egg
      function triggerFeedbackFrenzy() {
        // Create confetti effect
        for (let i = 0; i < 50; i++) {
          const confetti = document.createElement("div");
          confetti.className = "confetti";
          confetti.style.left = Math.random() * 100 + "%";
          confetti.style.backgroundColor = [
            "#ff4444",
            "#ffb700",
            "#4444ff",
            "#44ff44",
          ][Math.floor(Math.random() * 4)];
          confetti.style.animationDelay = Math.random() * 3 + "s";
          document.body.appendChild(confetti);

          setTimeout(() => confetti.remove(), 5000);
        }

        // Show special badge
        const badge = document.createElement("div");
        badge.className = "frenzy-badge";
        badge.innerHTML = "🏆 FEEDBACK FRENZY UNLOCKED! 🏆";
        document.body.appendChild(badge);

        setTimeout(() => badge.remove(), 5000);
      }

      // Simulated sound effect
      function playTickSound() {
        // Create a simple tick sound using Web Audio API
        try {
          const audioContext = new (window.AudioContext ||
            window.webkitAudioContext)();
          const oscillator = audioContext.createOscillator();
          const gainNode = audioContext.createGain();

          oscillator.connect(gainNode);
          gainNode.connect(audioContext.destination);

          oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
          gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
          gainNode.gain.exponentialRampToValueAtTime(
            0.01,
            audioContext.currentTime + 0.1
          );

          oscillator.start(audioContext.currentTime);
          oscillator.stop(audioContext.currentTime + 0.1);
        } catch (e) {
          // Fallback for browsers without Web Audio API
          console.log("Tick sound played");
        }
      }

      // Form focus glow effect
      const form = document.querySelector(".enhanced-form");
      form.addEventListener("focusin", function () {
        this.style.boxShadow = "0 0 30px rgba(255, 183, 0, 0.4)";
      });

      form.addEventListener("focusout", function () {
        this.style.boxShadow = "0 15px 35px rgba(0, 0, 0, 0.5)";
      });

      // ============================================
      // ENHANCED FUNCTIONALITY
      // ============================================

      // Enhanced form functionality
      function initEnhancedForm() {
        // Show/hide conditional fields
        const feedbackType = document.getElementById("feedback-type");
        const stepsGroup = document.getElementById("steps-group");
        const responsePrefs = document.getElementById("response-prefs");
        const emailInput = document.getElementById("email");

        feedbackType.addEventListener("change", function () {
          // Show reproduction steps for bugs
          if (this.value === "bug") {
            stepsGroup.style.display = "block";
          } else {
            stepsGroup.style.display = "none";
          }
        });

        emailInput.addEventListener("input", function () {
          // Show response preferences when email is entered
          if (this.value.trim()) {
            responsePrefs.style.display = "block";
          } else {
            responsePrefs.style.display = "none";
          }
        });

        // File upload functionality
        initFileUpload();

        // Tags functionality
        initTagsSystem();
      }

      // File upload system
      function initFileUpload() {
        const fileUploadArea = document.getElementById("file-upload-area");
        const fileInput = document.getElementById("screenshots");
        const uploadedFiles = document.getElementById("uploaded-files");
        let selectedFiles = [];

        // Click to upload
        fileUploadArea.addEventListener("click", () => {
          fileInput.click();
        });

        // Drag and drop
        fileUploadArea.addEventListener("dragover", (e) => {
          e.preventDefault();
          fileUploadArea.classList.add("dragover");
        });

        fileUploadArea.addEventListener("dragleave", () => {
          fileUploadArea.classList.remove("dragover");
        });

        fileUploadArea.addEventListener("drop", (e) => {
          e.preventDefault();
          fileUploadArea.classList.remove("dragover");
          handleFiles(e.dataTransfer.files);
        });

        fileInput.addEventListener("change", (e) => {
          handleFiles(e.target.files);
        });

        function handleFiles(files) {
          Array.from(files).forEach((file) => {
            if (file.size > 10 * 1024 * 1024) {
              // 10MB limit
              alert("File too large. Please choose files under 10MB.");
              return;
            }

            selectedFiles.push(file);
            displayFile(file);
          });
        }

        function displayFile(file) {
          const fileDiv = document.createElement("div");
          fileDiv.className = "uploaded-file";

          const isImage = file.type.startsWith("image/");
          const isVideo = file.type.startsWith("video/");

          fileDiv.innerHTML = `
            ${
              isImage
                ? `<img src="${URL.createObjectURL(
                    file
                  )}" class="file-preview" alt="Preview">`
                : isVideo
                ? `<video src="${URL.createObjectURL(
                    file
                  )}" class="file-preview" controls></video>`
                : `<div class="file-preview" style="display: flex; align-items: center; justify-content: center; background: #333;">📄</div>`
            }
            <div class="file-name">${file.name}</div>
            <button class="file-remove" onclick="removeFile(this)">×</button>
          `;

          uploadedFiles.appendChild(fileDiv);
        }

        window.removeFile = function (button) {
          const fileDiv = button.parentElement;
          const fileName = fileDiv.querySelector(".file-name").textContent;
          selectedFiles = selectedFiles.filter(
            (file) => file.name !== fileName
          );
          fileDiv.remove();
        };
      }

      // Tags system
      function initTagsSystem() {
        const tagInput = document.getElementById("tag-input");
        const selectedTags = document.getElementById("selected-tags");
        const tagSuggestions = document.querySelectorAll(".tag-suggestion");
        let tags = [];

        // Add tag from input
        tagInput.addEventListener("keypress", (e) => {
          if (e.key === "Enter") {
            e.preventDefault();
            addTag(tagInput.value.trim());
            tagInput.value = "";
          }
        });

        // Add tag from suggestions
        tagSuggestions.forEach((suggestion) => {
          suggestion.addEventListener("click", () => {
            addTag(suggestion.dataset.tag);
          });
        });

        function addTag(tagText) {
          if (!tagText || tags.includes(tagText)) return;

          tags.push(tagText);
          const tagElement = document.createElement("span");
          tagElement.className = "selected-tag";
          tagElement.innerHTML = `
            ${tagText}
            <button class="tag-remove" onclick="removeTag('${tagText}')">×</button>
          `;
          selectedTags.appendChild(tagElement);
        }

        window.removeTag = function (tagText) {
          tags = tags.filter((tag) => tag !== tagText);
          const tagElements = selectedTags.querySelectorAll(".selected-tag");
          tagElements.forEach((element) => {
            if (element.textContent.includes(tagText)) {
              element.remove();
            }
          });
        };
      }

      // Auto-save draft functionality
      function initAutoSave() {
        const form = document.getElementById("feedback-form");
        const inputs = form.querySelectorAll("input, textarea, select");

        function saveDraft() {
          const formData = new FormData(form);
          const draft = {};
          for (let [key, value] of formData.entries()) {
            draft[key] = value;
          }
          localStorage.setItem("feedbackDraft", JSON.stringify(draft));
        }

        function loadDraft() {
          const saved = localStorage.getItem("feedbackDraft");
          if (saved) {
            const draft = JSON.parse(saved);
            Object.keys(draft).forEach((key) => {
              const field = form.querySelector(`[name="${key}"]`);
              if (field) {
                field.value = draft[key];
                if (field.type === "radio" && field.value === draft[key]) {
                  field.checked = true;
                }
              }
            });
          }
        }

        // Auto-save every 30 seconds
        inputs.forEach((input) => {
          input.addEventListener("input", () => {
            clearTimeout(window.autoSaveTimeout);
            window.autoSaveTimeout = setTimeout(saveDraft, 2000);
          });
        });

        // Load draft on page load
        loadDraft();

        // Clear draft on successful submission
        form.addEventListener("submit", () => {
          localStorage.removeItem("feedbackDraft");
        });
      }

      // Character counter for textareas
      function initCharacterCounters() {
        const textareas = document.querySelectorAll("textarea");

        textareas.forEach((textarea) => {
          const counter = document.createElement("div");
          counter.className = "character-counter";
          counter.style.cssText = `
            text-align: right;
            color: #888;
            font-size: 0.8rem;
            margin-top: 5px;
          `;

          function updateCounter() {
            const length = textarea.value.length;
            const maxLength = textarea.maxLength || 1000;
            counter.textContent = `${length}/${maxLength}`;

            if (length > maxLength * 0.9) {
              counter.style.color = "#ff4444";
            } else if (length > maxLength * 0.7) {
              counter.style.color = "#ffb700";
            } else {
              counter.style.color = "#888";
            }
          }

          textarea.addEventListener("input", updateCounter);
          textarea.parentNode.appendChild(counter);
          updateCounter();
        });
      }

      // Form validation enhancements
      function initFormValidation() {
        const form = document.getElementById("feedback-form");

        form.addEventListener("submit", function (e) {
          let isValid = true;

          // Validate priority selection
          const prioritySelected = document.querySelector(
            'input[name="priority"]:checked'
          );
          if (!prioritySelected) {
            e.preventDefault();
            alert("Please select a priority level");
            isValid = false;
          }

          // Validate feedback length
          const feedbackText = document.getElementById("feedback-text");
          if (feedbackText.value.trim().length < 10) {
            e.preventDefault();
            alert(
              "Please provide more detailed feedback (at least 10 characters)"
            );
            isValid = false;
          }

          if (isValid) {
            // Show enhanced loading state
            const submitBtn = document.getElementById("send-button");
            submitBtn.innerHTML =
              '<span class="button-text">ANALYZING FEEDBACK...</span>';
            submitBtn.style.background =
              "linear-gradient(45deg, #4444ff, #6666ff)";
          }
        });
      }

      // Initialize everything on load
      window.addEventListener("load", function () {
        initEnhancedForm();
        initAutoSave();
        initCharacterCounters();
        initFormValidation();
      });
    </script>

    <!-- Tally Form Script -->
    <script>
      let d = document,
        s = d.createElement("script");
      s.src = "https://tally.so/widgets/embed.js";
      s.onload = () => Tally.loadEmbeds();
      d.body.appendChild(s);
    </script>

    <!-- Scroll Progress Bar and Return to Top Script -->
    <script>
      // Scroll Progress Bar
      function updateScrollProgress() {
        const scrollTop =
          window.pageYOffset || document.documentElement.scrollTop;
        const scrollHeight =
          document.documentElement.scrollHeight -
          document.documentElement.clientHeight;
        const scrollProgress = (scrollTop / scrollHeight) * 100;
        document.getElementById("scrollProgressBar").style.width =
          scrollProgress + "%";
      }

      // Return to Top Button
      const returnToTopBtn = document.getElementById("returnToTop");

      function toggleReturnToTop() {
        if (window.pageYOffset > 300) {
          returnToTopBtn.classList.add("visible");
        } else {
          returnToTopBtn.classList.remove("visible");
        }
      }

      returnToTopBtn.addEventListener("click", () => {
        window.scrollTo({
          top: 0,
          behavior: "smooth",
        });
      });

      // Add scroll event listeners
      window.addEventListener("scroll", () => {
        updateScrollProgress();
        toggleReturnToTop();
      });

      // Initial check
      toggleReturnToTop();
    </script>
  </body>
</html>
