<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
    <link rel="canonical" href="https://www.thefinalsloadout.com/" />

    <!-- Critical CSS for instant render - FIXED with proper heights -->
    <style>
      :root{--bg-dark:#0a0a0a;--text-primary:#fff;--font-display:"Bebas Neue",sans-serif;--font-body:"Inter",sans-serif}
      *{box-sizing:border-box;margin:0;padding:0}
      html{font-size:16px;-webkit-font-smoothing:antialiased}
      body{font-family:var(--font-body);background:#0a0a0a;color:#fff;line-height:1.6;min-height:100vh;overflow-x:hidden}
      .container{max-width:1200px;margin:0 auto;padding:0 1rem}
      .slot-machine-container{width:100%;padding:1rem}
      .slot-machine{position:relative;background:#1a1a1a;border-radius:12px;overflow:hidden}
      .slot-columns{display:flex;justify-content:center;gap:1rem;padding:2rem 1rem}
      .slot-column{flex:1;max-width:150px;background:#0f0f0f;border-radius:8px;overflow:hidden}
      .slot-window{position:relative;height:200px;overflow:hidden} /* Fixed: 200px to show 2.5 items */
      .slot-items{position:absolute;width:100%;transition:none}
      .slot-item{height:80px;display:flex;align-items:center;justify-content:center;padding:0.5rem}
      .generate-btn{background:linear-gradient(135deg,#ff3366,#ff6b9d);color:#fff;border:none;padding:1rem 2rem;font-size:1.125rem;font-weight:700;border-radius:8px;cursor:pointer;text-transform:uppercase}
      .header{text-align:center;padding:2rem 0}
      .title{font-family:"Bebas Neue",sans-serif;font-size:clamp(2rem,5vw,3.5rem);line-height:1.2;text-transform:uppercase}
      .pre-slot-container{min-height:0} /* Fixed: Remove unnecessary gap */
      .history-section{margin-top:3rem}
      .top-controls{margin-bottom:2rem} /* Add spacing after button */
    </style>

    <!-- Preconnect for faster font loading -->
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    
    <!-- Preload critical resources -->
    <link rel="preload" href="/v3/style.css?v=20250818-vegas" as="style" />
    <link rel="preload" href="/images/placeholder.webp" as="image" type="image/webp" />
    <link rel="preload" href="/fonts/bebas-neue-v2-latin-regular.woff2" as="font" type="font/woff2" crossorigin />

    <!-- Meta Tags -->
    <title>The Finals BEST Random Loadout Generator | Fun & Unique Loadouts</title>
    <meta name="description" content="Get the best random loadouts for The Finals game to have fun and be challenged. Find new weapon builds for Light, Medium, and Heavy playstyles." />
    <meta name="author" content="Paul Takisaki" />

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/images/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon-92x192.png" />

    <!-- Open Graph -->
    <meta property="og:title" content="The Finals Loadout Roulette" />
    <meta property="og:description" content="Randomize your loadout and dominate The Finals with style." />
    <meta property="og:image" content="https://www.thefinalsloadout.com/wt-progress/images/social1200x630.png" />
    <meta property="og:url" content="https://www.thefinalsloadout.com/" />
    <meta property="og:type" content="website" />

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="The Finals Loadout Roulette" />
    <meta name="twitter:description" content="Spin the wheel. Wreck the arena." />
    <meta name="twitter:image" content="https://www.thefinalsloadout.com/wt-progress/images/social1200x630.png" />

    <!-- Fonts - Load with display swap -->
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Inter:wght@400;600&display=swap" rel="stylesheet" />

    <!-- Styles - Non-critical styles load async -->
    <link rel="stylesheet" href="/v3/style.css?v=20250818-vegas" />
    <link rel="preload" href="/v3/spin-animation.css?v=20250816" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="/v3/polish-styles-fixed.css?v=20250819" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="/v3/bonus-styles.css?v=20250816" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="/v3/selection-styles.css?v=20250816" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="/v3/automated-flow-styles.css?v=20250816" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="/v3/history-styles.css?v=20250816" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="/v3/history-styles-refined.css?v=20250816" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <!-- Override CSS - MUST load last to fix heights -->
    <link rel="stylesheet" href="/v3/style-override-fix.css?v=20250819">
    <noscript>
      <link rel="stylesheet" href="/v3/spin-animation.css?v=20250816">
      <link rel="stylesheet" href="/v3/polish-styles-fixed.css?v=20250819">
      <link rel="stylesheet" href="/v3/bonus-styles.css?v=20250816">
      <link rel="stylesheet" href="/v3/selection-styles.css?v=20250816">
      <link rel="stylesheet" href="/v3/automated-flow-styles.css?v=20250816">
      <link rel="stylesheet" href="/v3/history-styles.css?v=20250816">
      <link rel="stylesheet" href="/v3/history-styles-refined.css?v=20250816">
      <link rel="stylesheet" href="/v3/style-override-fix.css?v=20250819">
    </noscript>
  </head>
  <body>
    <!-- Scroll Progress Bar -->
    <div class="scroll-progress-bar" id="scrollProgressBar"></div>

    <!-- Return to Top Button -->
    <button class="return-to-top" id="returnToTop" aria-label="Return to top" title="Return to top">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <polyline points="18 15 12 9 6 15"></polyline>
      </svg>
    </button>

    <!-- Navigation -->
    <nav class="main-nav">
      <div class="nav-links">
        <a href="/" class="nav-link active">LOADOUT GENERATOR</a>
        <a href="/ragequit/" class="nav-link">RAGE QUIT</a>
        <a href="/patch-notes/" class="nav-link">PATCH NOTES</a>
        <a href="/meta-weapons/" class="nav-link">META WEAPONS</a>
        <a href="/wt-progress/" class="nav-link">WORLD TOUR TRACKER (NEW)</a>
      </div>
      <div class="nav-controls">
        <!-- Filter Toggle Button -->
        <button id="filter-toggle" class="filter-toggle-button nav-button" aria-label="Toggle filters">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
          </svg>
        </button>
        <!-- Sound Toggle Button -->
        <button id="sound-toggle" class="sound-toggle-button nav-button" aria-label="Toggle sound">
          <svg class="sound-on" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
            <path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"></path>
          </svg>
          <svg class="sound-off" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: none">
            <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
            <line x1="23" y1="9" x2="17" y2="15"></line>
            <line x1="17" y1="9" x2="23" y2="15"></line>
          </svg>
        </button>
      </div>
    </nav>

    <!-- Filter Panel (Hidden by default) -->
    <div id="filter-panel-overlay" class="filter-panel-overlay"></div>
    <div id="filter-panel" class="filter-panel">
      <div class="filter-header">
        <h3 class="filter-title">FILTERS</h3>
        <button id="clear-all-filters" class="filter-clear-all" aria-label="Clear all filters">CLEAR ALL</button>
        <button id="close-filter-panel" class="filter-close" aria-label="Close filters">Ã—</button>
      </div>
      <div class="filter-content">
        <!-- Weapons Filter -->
        <div class="filter-category" data-category="weapons">
          <div class="filter-category-header">
            <span class="filter-category-title">WEAPONS</span>
            <span class="filter-count" id="weapons-count">0/0</span>
          </div>
          <div class="filter-controls">
            <button class="filter-control-btn" data-action="select-all">Select All</button>
            <button class="filter-control-btn" data-action="select-none">Clear</button>
            <button class="filter-control-btn" data-action="select-meta">Meta Only</button>
          </div>
          <div class="filter-items" id="weapons-filters">
            <!-- Populated by JavaScript -->
          </div>
        </div>

        <!-- Specializations Filter -->
        <div class="filter-category" data-category="specializations">
          <div class="filter-category-header">
            <span class="filter-category-title">SPECIALIZATIONS</span>
            <span class="filter-count" id="specializations-count">0/0</span>
          </div>
          <div class="filter-controls">
            <button class="filter-control-btn" data-action="select-all">Select All</button>
            <button class="filter-control-btn" data-action="select-none">Clear</button>
          </div>
          <div class="filter-items" id="specializations-filters">
            <!-- Populated by JavaScript -->
          </div>
        </div>

        <!-- Gadgets Filter -->
        <div class="filter-category" data-category="gadgets">
          <div class="filter-category-header">
            <span class="filter-category-title">GADGETS</span>
            <span class="filter-count" id="gadgets-count">0/0</span>
          </div>
          <div class="filter-controls">
            <button class="filter-control-btn" data-action="select-all">Select All</button>
            <button class="filter-control-btn" data-action="select-none">Clear</button>
            <button class="filter-control-btn" data-action="select-utility">Utility Only</button>
          </div>
          <div class="filter-items" id="gadgets-filters">
            <!-- Populated by JavaScript -->
          </div>
        </div>

        <!-- Quick Presets -->
        <div class="filter-presets">
          <h4 class="preset-title">QUICK PRESETS</h4>
          <div class="preset-buttons">
            <button class="preset-btn" data-preset="meta">META BUILD</button>
            <button class="preset-btn" data-preset="meme">MEME BUILD</button>
            <button class="preset-btn" data-preset="tryhard">TRYHARD</button>
            <button class="preset-btn" data-preset="casual">CASUAL</button>
          </div>
        </div>

        <!-- Apply/Reset -->
        <div class="filter-actions">
          <button id="apply-filters" class="apply-filters-btn">APPLY FILTERS</button>
          <button id="reset-filters" class="reset-filters-btn">RESET ALL</button>
        </div>
      </div>
    </div>

    <!-- Main Content -->
    <main class="container">
      <!-- Header -->
      <header class="header">
        <h1 class="title">THE FINALS<br />RANDOM LOADOUT GENERATOR</h1>
        <p class="subtitle">CHALLENGE YOURSELF WITH UNIQUE BUILDS</p>
      </header>

      <!-- Generate Button (moved to top) -->
      <section class="controls top-controls">
        <button id="generate-btn" class="generate-btn primary-btn">GENERATE LOADOUT</button>
      </section>

      <!-- Pre-Slot Animation Container -->
      <section id="pre-slot-container" class="pre-slot-container">
        <!-- Will be populated by AutomatedFlowManager -->
      </section>

      <!-- Slot Machine Container -->
      <section id="slot-machine-container" class="slot-machine-container" style="display: none">
        <div class="slot-machine">
          <div class="slot-header">
            <h2 class="slot-title">SPINNING YOUR LOADOUT...</h2>
            <div class="class-indicator">
              <span class="class-label">CLASS:</span>
              <span class="class-value" id="selected-class">-</span>
            </div>
          </div>

          <!-- Slot Columns -->
          <div class="slot-columns">
            <div class="slot-column" data-type="weapon">
              <div class="column-header">WEAPON</div>
              <div class="slot-window">
                <div class="slot-items"></div>
              </div>
            </div>

            <div class="slot-column" data-type="specialization">
              <div class="column-header">SPECIALIZATION</div>
              <div class="slot-window">
                <div class="slot-items"></div>
              </div>
            </div>

            <div class="slot-column" data-type="gadget-1">
              <div class="column-header">GADGET 1</div>
              <div class="slot-window">
                <div class="slot-items"></div>
              </div>
            </div>

            <div class="slot-column" data-type="gadget-2">
              <div class="column-header">GADGET 2</div>
              <div class="slot-window">
                <div class="slot-items"></div>
              </div>
            </div>

            <div class="slot-column" data-type="gadget-3">
              <div class="column-header">GADGET 3</div>
              <div class="slot-window">
                <div class="slot-items"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- Result Display -->
        <div id="loadout-result" class="loadout-result" style="display: none">
          <h3 class="result-title">YOUR LOADOUT</h3>
          <div class="result-items">
            <!-- Results will be populated here -->
          </div>
          <div class="result-analysis">
            <!-- AI Analysis placeholder -->
          </div>
          <!-- Spin Again Button (moved inside result container) -->
          <div class="spin-again-container" id="spin-again-section">
            <button id="spin-again-btn" class="spin-again-btn primary-btn">SPIN AGAIN</button>
          </div>
        </div>
      </section>

      <!-- History Section -->
      <section id="history-section" class="history-section">
        <h2 class="section-title">LOADOUT HISTORY</h2>
        <div id="history-container" class="history-container">
          <p class="empty-history">No loadouts generated yet. Click the button above to start!</p>
        </div>
      </section>
    </main>

    <!-- Footer -->
    <footer class="footer" style="text-align:center;padding:1.5rem 1rem;color:#888;margin-top:2rem;border-top:1px solid rgba(255,255,255,0.1);background:rgba(10,10,15,0.9);position:relative;z-index:10;font-size:0.75rem;">
      <!-- Support Section -->
      <div style="margin-bottom:1.5rem;padding:1.5rem;background:linear-gradient(135deg,rgba(80,200,120,0.05) 0%,rgba(0,255,204,0.05) 100%);border-radius:12px;border:1px solid rgba(80,200,120,0.2);">
        <div style="display:flex;align-items:center;justify-content:center;gap:1rem;flex-wrap:wrap;">
          <span style="font-size:1.5rem;">â˜•</span>
          <div>
            <p style="margin:0;color:#50c878;font-weight:600;font-size:0.9rem;">Enjoying the loadout generator?</p>
            <p style="margin:0.25rem 0 0.75rem 0;color:#b8bfc6;font-size:0.8rem;">Help keep it running with a coffee!</p>
          </div>
        </div>
        <a href="https://ko-fi.com/nextroundonme" target="_blank" rel="noopener" style="display:inline-block;padding:0.75rem 2rem;background:linear-gradient(135deg,#50c878,#00ffcc);color:#0a0a0f;text-decoration:none;border-radius:8px;font-weight:700;font-size:0.9rem;transition:all 0.3s ease;box-shadow:0 4px 15px rgba(80,200,120,0.3);position:relative;overflow:hidden;" onmouseover="this.style.transform='translateY(-2px)';this.style.boxShadow='0 6px 25px rgba(80,200,120,0.5)';" onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='0 4px 15px rgba(80,200,120,0.3)';">
          <span style="position:relative;z-index:1;">ðŸ’š Support Me</span>
        </a>
      </div>
      
      <div class="footer-content">
        <div class="footer-section">
          <h3>About</h3>
          <p>The Finals Random Loadout Generator creates unique weapon and gadget combinations for every class.</p>
        </div>
        <div class="footer-section">
          <h3>Connect</h3>
          <p>Created by <a href="https://www.paultakisaki.com/" target="_blank" rel="noopener">Paul Takisaki</a></p>
          <p><a href="https://github.com/yourgithub" target="_blank" rel="noopener">GitHub</a></p>
        </div>
        <div class="footer-section">
          <h3>Legal</h3>
          <p>The Finals is a trademark of Embark Studios. This is a fan-made tool.</p>
          <p>&copy; 2024 The Finals Loadout Generator</p>
        </div>
      </div>
    </footer>

    <!-- Scripts - Critical path optimized -->
    <!-- Core dependencies load first but async -->
    <script src="/js/name-to-asset.js?v=20250816" async></script>
    <script src="/v3/image-preloader.js?v=20250816" async></script>
    <script src="/v3/loadout-loader.js?v=20250818-fix" async></script>
    
    <!-- Main app scripts defer until DOM ready -->
    <script src="/v3/sound-manager-fixed.js?v=20250819" defer></script>
    <script src="/v3/simple-spin-animation.js?v=20250816" defer></script>
    <script src="/v3/animation-engine-v2.js?v=20250816" defer></script>
    <script src="/v3/slot-machine.js?v=20250816" defer></script>
    <script src="/v3/filter-system.js?v=20250816" defer></script>
    <script src="/v3/bonus-system.js?v=20250816" defer></script>
    <script src="/v3/automated-flow.js?v=20250816" defer></script>
    <script src="/v3/history-system.js?v=20250816" defer></script>
    <script src="/v3/history-system-enhanced.js?v=20250816" defer></script>
    <script src="/v3/app.js?v=20250816" defer></script>

    <!-- Debug overlay for animation -->
    <div id="anim-debug" style="position:fixed;right:8px;top:8px;padding:6px 8px;background:#111a;color:#0f0;font:12px/1.3 monospace;z-index:9999;border-radius:6px;pointer-events:none;border:1px solid #0f0">IDLE</div>

    <!-- Non-critical monitoring loads last -->
    <script>
      // Defer Jam.dev and Sentry to after load
      window.addEventListener('load', function() {
        // Jam.dev Recording
        var jamScript1 = document.createElement('script');
        jamScript1.type = 'module';
        jamScript1.src = 'https://js.jam.dev/recorder.js';
        document.head.appendChild(jamScript1);
        
        var jamScript2 = document.createElement('script');
        jamScript2.type = 'module';
        jamScript2.src = 'https://js.jam.dev/capture.js';
        document.head.appendChild(jamScript2);
        
        // Sentry Error Monitoring
        var sentryScript = document.createElement('script');
        sentryScript.src = 'https://browser.sentry-cdn.com/7.118.0/bundle.min.js';
        sentryScript.crossOrigin = 'anonymous';
        sentryScript.onload = function() {
          Sentry.init({ 
            dsn: "https://6e4ccf13ff7d6e8aec9f31a703e13358@o4509838584905728.ingest.us.sentry.io/4509838592245760",
            integrations: [
              Sentry.browserTracingIntegration(),
              Sentry.replayIntegration()
            ],
            tracesSampleRate: 0.1,
            replaysSessionSampleRate: 0.1,
            replaysOnErrorSampleRate: 1.0,
            environment: "production"
          });
        };
        document.head.appendChild(sentryScript);
      });
    </script>

    <!-- Service Worker Registration -->
    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', function() {
          navigator.serviceWorker.register('/v3/sw.js').then(function(registration) {
            console.log('ServiceWorker registration successful');
          }, function(err) {
            console.log('ServiceWorker registration failed: ', err);
          });
        });
      }
    </script>
  </body>
</html>