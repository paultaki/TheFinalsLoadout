<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Check Effective Item Height</title>
    <link rel="stylesheet" href="style.css">
    <style>
        body { 
            background: #111; 
            color: #0f0; 
            font-family: monospace; 
            padding: 20px;
        }
        .diagnostic {
            margin: 20px;
            padding: 20px;
            background: rgba(0,255,0,0.1);
            border: 1px solid #0f0;
        }
        .measurement {
            margin: 10px 0;
            padding: 10px;
            background: rgba(0,0,0,0.5);
        }
    </style>
</head>
<body>
    <h2>Effective Height Diagnostic</h2>
    
    <div class="slot-machine" style="margin: 50px auto; max-width: 400px;">
        <div class="slot-columns">
            <div class="slot-column">
                <div class="column-header">TEST</div>
                <div class="slot-window">
                    <div class="slot-items" id="test-container"></div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="diagnostic">
        <h3>Measurements</h3>
        <div id="measurements"></div>
    </div>
    
    <script>
        const container = document.getElementById('test-container');
        const measurements = document.getElementById('measurements');
        
        // Create test items
        for (let i = 0; i < 5; i++) {
            const item = document.createElement('div');
            item.className = 'slot-item';
            item.id = `item-${i}`;
            item.innerHTML = `<div class="item-label">Test Item ${i}</div>`;
            container.appendChild(item);
        }
        
        // Measure after rendering
        setTimeout(() => {
            let html = '';
            
            // Get first item
            const item = document.querySelector('.slot-item');
            if (item) {
                const rect = item.getBoundingClientRect();
                const computed = window.getComputedStyle(item);
                
                html += '<div class="measurement">';
                html += '<strong>First Item Measurements:</strong><br>';
                html += `getBoundingClientRect().height: ${rect.height}px<br>`;
                html += `offsetHeight: ${item.offsetHeight}px<br>`;
                html += `clientHeight: ${item.clientHeight}px<br>`;
                html += `scrollHeight: ${item.scrollHeight}px<br>`;
                html += '<br><strong>Computed Styles:</strong><br>';
                html += `height: ${computed.height}<br>`;
                html += `padding-top: ${computed.paddingTop}<br>`;
                html += `padding-bottom: ${computed.paddingBottom}<br>`;
                html += `border-top: ${computed.borderTopWidth}<br>`;
                html += `border-bottom: ${computed.borderBottomWidth}<br>`;
                html += `box-sizing: ${computed.boxSizing}<br>`;
                html += `margin-top: ${computed.marginTop}<br>`;
                html += `margin-bottom: ${computed.marginBottom}<br>`;
                html += '</div>';
                
                // Calculate effective height
                const effectiveHeight = rect.height;
                const declaredHeight = parseFloat(computed.height);
                
                html += '<div class="measurement" style="border: 2px solid yellow;">';
                html += '<strong>Effective Height Analysis:</strong><br>';
                html += `Declared height: ${declaredHeight}px<br>`;
                html += `Actual height (getBoundingClientRect): ${effectiveHeight}px<br>`;
                html += `Difference: ${effectiveHeight - declaredHeight}px<br>`;
                
                if (Math.abs(effectiveHeight - 80) > 0.1) {
                    html += '<span style="color: red;">⚠️ HEIGHT MISMATCH! Expected 80px</span><br>';
                    html += `Adjust calculations by: ${effectiveHeight - 80}px`;
                } else {
                    html += '<span style="color: lime;">✓ Height matches expected 80px</span>';
                }
                html += '</div>';
                
                // Check spacing between items
                const items = document.querySelectorAll('.slot-item');
                if (items.length >= 2) {
                    const rect1 = items[0].getBoundingClientRect();
                    const rect2 = items[1].getBoundingClientRect();
                    const spacing = rect2.top - rect1.bottom;
                    
                    html += '<div class="measurement">';
                    html += '<strong>Item Spacing:</strong><br>';
                    html += `Item 0 bottom: ${rect1.bottom}px<br>`;
                    html += `Item 1 top: ${rect2.top}px<br>`;
                    html += `Gap between items: ${spacing}px<br>`;
                    
                    const effectiveItemHeight = rect2.top - rect1.top;
                    html += `<strong>Effective item height (center to center): ${effectiveItemHeight}px</strong>`;
                    
                    if (Math.abs(effectiveItemHeight - 80) > 0.1) {
                        html += '<br><span style="color: red;">⚠️ SPACING ISSUE!</span>';
                    }
                    html += '</div>';
                }
            }
            
            measurements.innerHTML = html;
            
            // Log for console
            const item0 = document.querySelector('.slot-item');
            if (item0) {
                console.log('Effective item height:', item0.getBoundingClientRect().height);
                console.log('Offset height:', item0.offsetHeight);
                console.log('Computed height:', window.getComputedStyle(item0).height);
            }
        }, 100);
    </script>
</body>
</html>