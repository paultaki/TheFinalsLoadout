<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>THE FINALS World Tour Tracker - Season 8</title>

    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        background: linear-gradient(
          135deg,
          #0a0a0a 0%,
          #1a1a1a 50%,
          #0d1117 100%
        );
        color: #ffffff;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        min-height: 100vh;
        padding-bottom: 300px; /* Massive padding to prevent cutoff */
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
        padding-bottom: 200px; /* Extra bottom padding */
      }

      .header {
        text-align: center;
        padding: 2rem 0;
        margin-bottom: 2rem;
      }

      .header h1 {
        font-size: 2.5rem;
        font-weight: 700;
        background: linear-gradient(135deg, #50c878, #20b2aa);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        margin-bottom: 0.5rem;
      }

      .season-badge {
        display: inline-block;
        background: linear-gradient(135deg, #50c878, #20b2aa);
        color: #000;
        padding: 0.25rem 0.75rem;
        border-radius: 20px;
        font-size: 0.85rem;
        font-weight: 700;
        margin-bottom: 1rem;
      }

      .card {
        background: rgba(255, 255, 255, 0.03);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 15px;
        padding: 1.5rem;
        margin-bottom: 2rem;
      }

      .card-title {
        font-size: 1.25rem;
        font-weight: 600;
        margin-bottom: 1rem;
        color: #50c878;
      }

      /* POINTS INPUT SECTION - SUPER CLEAR */
      .points-input-section {
        background: linear-gradient(
          135deg,
          rgba(255, 193, 7, 0.2) 0%,
          rgba(255, 193, 7, 0.05) 100%
        );
        border: 3px solid #ffc107;
        border-radius: 15px;
        padding: 2rem;
        margin-bottom: 2rem;
        text-align: center;
      }

      .points-input-label {
        display: block;
        color: #ffc107;
        font-weight: 700;
        font-size: 1.2rem;
        margin-bottom: 1rem;
        text-transform: uppercase;
      }

      #manualPointsInput {
        width: 200px;
        padding: 15px;
        font-size: 2.5rem;
        font-weight: 700;
        text-align: center;
        background: #000;
        color: #50c878;
        border: 3px solid #50c878;
        border-radius: 10px;
        margin: 0 auto;
        display: block;
      }

      #manualPointsInput:focus {
        outline: none;
        box-shadow: 0 0 20px rgba(80, 200, 120, 0.5);
      }

      .set-points-btn {
        margin-top: 1rem;
        padding: 1rem 2rem;
        background: #50c878;
        color: #000;
        border: none;
        border-radius: 10px;
        font-size: 1.1rem;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.3s;
      }

      .set-points-btn:hover {
        transform: scale(1.05);
        box-shadow: 0 5px 20px rgba(80, 200, 120, 0.5);
      }

      .current-total {
        margin-top: 1rem;
        font-size: 1.2rem;
        color: #b0b0b0;
      }

      .current-total-value {
        color: #50c878;
        font-weight: 700;
        font-size: 1.5rem;
      }

      /* Goal Section */
      .goal-select {
        width: 100%;
        padding: 0.75rem;
        background: rgba(80, 200, 120, 0.1);
        border: 2px solid #50c878;
        color: #fff;
        border-radius: 8px;
        font-size: 1rem;
        font-weight: 600;
        margin-bottom: 1rem;
      }

      .goal-select option {
        background: #1a1a1a;
        color: #fff;
      }

      /* Progress Bar */
      .progress-container {
        position: relative;
        height: 40px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 20px;
        overflow: hidden;
        margin-bottom: 1rem;
      }

      .progress-bar {
        height: 100%;
        background: linear-gradient(90deg, #50c878, #20b2aa);
        border-radius: 20px;
        transition: width 0.5s ease;
      }

      .progress-text {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-weight: 600;
        font-size: 1.1rem;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
      }

      /* Stats Grid */
      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
        margin: 1.5rem 0;
      }

      .stat-box {
        background: rgba(255, 255, 255, 0.02);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 10px;
        padding: 1rem;
        text-align: center;
      }

      .stat-value {
        font-size: 1.5rem;
        font-weight: 700;
        color: #50c878;
        margin-bottom: 0.25rem;
      }

      .stat-label {
        font-size: 0.8rem;
        color: #b0b0b0;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      /* Match Buttons */
      .match-buttons {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 0.75rem;
        margin: 1.5rem 0;
      }

      .match-btn {
        padding: 1rem;
        background: rgba(255, 255, 255, 0.05);
        border: 2px solid rgba(255, 255, 255, 0.2);
        color: #fff;
        border-radius: 10px;
        cursor: pointer;
        transition: all 0.3s;
        font-weight: 600;
        text-align: center;
      }

      .match-btn:hover {
        transform: translateY(-2px);
        background: rgba(80, 200, 120, 0.2);
        border-color: #50c878;
      }

      .match-btn.win {
        border-color: #ffd700;
        background: rgba(255, 215, 0, 0.1);
      }

      .match-btn-icon {
        display: block;
        font-size: 1.5rem;
        margin-bottom: 0.25rem;
      }

      .match-btn-points {
        display: block;
        color: #50c878;
        font-weight: 700;
      }

      /* Rank Grid */
      .rank-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
        gap: 0.5rem;
        max-height: 600px;
        overflow-y: auto;
        padding: 1rem;
        margin-bottom: 100px; /* Extra margin to prevent cutoff */
      }

      .rank-item {
        padding: 0.75rem;
        background: rgba(255, 255, 255, 0.02);
        border-radius: 8px;
        border: 1px solid rgba(255, 255, 255, 0.05);
        text-align: center;
        transition: all 0.3s;
      }

      .rank-item:hover {
        transform: scale(1.05);
        background: rgba(80, 200, 120, 0.1);
        border-color: rgba(80, 200, 120, 0.3);
      }

      .rank-item.completed {
        background: rgba(80, 200, 120, 0.15);
        border-color: #50c878;
      }

      .rank-item.current {
        background: rgba(255, 193, 7, 0.15);
        border-color: #ffc107;
        box-shadow: 0 0 10px rgba(255, 193, 7, 0.3);
      }

      /* Bottom Actions */
      .bottom-actions {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: rgba(10, 10, 10, 0.95);
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        padding: 1rem;
        display: flex;
        justify-content: center;
        gap: 1rem;
        z-index: 100;
      }

      .action-btn {
        padding: 0.75rem 1.5rem;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: #fff;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.3s;
      }

      .action-btn:hover {
        background: rgba(80, 200, 120, 0.2);
        border-color: #50c878;
      }

      /* Notification */
      .notification {
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 1rem 1.5rem;
        border-radius: 10px;
        background: rgba(80, 200, 120, 0.9);
        color: #000;
        font-weight: 600;
        transform: translateX(400px);
        transition: transform 0.3s;
        z-index: 1000;
      }

      .notification.show {
        transform: translateX(0);
      }

      /* Mobile adjustments */
      @media (max-width: 768px) {
        .container {
          padding-bottom: 300px;
        }

        .match-buttons {
          grid-template-columns: 1fr;
        }

        .stats-grid {
          grid-template-columns: repeat(2, 1fr);
        }

        .rank-grid {
          grid-template-columns: repeat(2, 1fr);
        }

        .bottom-actions {
          flex-wrap: wrap;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- Header -->
      <div class="header">
        <span class="season-badge">✨ SEASON 8</span>
        <h1>World Tour Progress Tracker</h1>
        <div style="color: #b0b0b0">
          September 11, 2025 - December 11, 2025 •
          <span id="daysRemaining">91</span> days remaining
        </div>
      </div>

      <!-- POINTS INPUT - SUPER OBVIOUS -->
      <div class="points-input-section">
        <label for="manualPointsInput" class="points-input-label">
          🎯 Enter Your Current World Tour Points 🎯
        </label>
        <input
          type="number"
          id="manualPointsInput"
          placeholder="0"
          min="0"
          max="2400"
        />
        <button class="set-points-btn" onclick="updatePoints()">
          Set Points
        </button>
        <div class="current-total">
          Your Total:
          <span id="totalPoints" class="current-total-value">0</span> points
        </div>
      </div>

      <!-- Goal Selection -->
      <div class="card">
        <h2 class="card-title">Goal & Progress</h2>
        <label for="goalSelect">Target Rank:</label>
        <select id="goalSelect" class="goal-select" onchange="updateGoal()">
          <!-- Will be populated by JS -->
        </select>

        <div class="progress-container">
          <div id="progressBar" class="progress-bar" style="width: 0%"></div>
          <div id="progressText" class="progress-text">0 / 0</div>
        </div>

        <div class="stats-grid">
          <div class="stat-box">
            <div class="stat-value" id="dailyRequired">0</div>
            <div class="stat-label">Daily Points Needed</div>
          </div>
          <div class="stat-box">
            <div class="stat-value" id="winRate">0%</div>
            <div class="stat-label">Win Rate</div>
          </div>
          <div class="stat-box">
            <div class="stat-value" id="totalMatches">0</div>
            <div class="stat-label">Total Matches</div>
          </div>
          <div class="stat-box">
            <div class="stat-value" id="todayPoints">0</div>
            <div class="stat-label">Today's Points</div>
          </div>
        </div>
      </div>

      <!-- Match Tracking -->
      <div class="card">
        <h2 class="card-title">Track Matches</h2>
        <div class="match-buttons">
          <button class="match-btn win" onclick="addMatch('win', 21)">
            <span class="match-btn-icon">🏆</span>
            <span>Win</span>
            <span class="match-btn-points">+21</span>
          </button>
          <button class="match-btn" onclick="addMatch('2nd', 12)">
            <span class="match-btn-icon">🥈</span>
            <span>2nd Place</span>
            <span class="match-btn-points">+12</span>
          </button>
          <button class="match-btn" onclick="addMatch('3rd', 8)">
            <span class="match-btn-icon">🥉</span>
            <span>3rd Place</span>
            <span class="match-btn-points">+8</span>
          </button>
          <button class="match-btn" onclick="addMatch('qualified', 5)">
            <span class="match-btn-icon">✅</span>
            <span>Qualified</span>
            <span class="match-btn-points">+5</span>
          </button>
          <button class="match-btn" onclick="addMatch('eliminated', 2)">
            <span class="match-btn-icon">❌</span>
            <span>Eliminated</span>
            <span class="match-btn-points">+2</span>
          </button>
          <button
            class="match-btn"
            onclick="undoLast()"
            style="border-color: #ff4757"
          >
            <span class="match-btn-icon">↩️</span>
            <span>Undo</span>
            <span class="match-btn-points" id="undoPoints">-0</span>
          </button>
        </div>
      </div>

      <!-- Rank Progression -->
      <div class="card">
        <h2 class="card-title">Rank Progression</h2>
        <div class="rank-grid" id="rankGrid">
          <!-- Will be populated by JS -->
        </div>
      </div>
    </div>

    <!-- Bottom Actions -->
    <div class="bottom-actions">
      <button class="action-btn" onclick="exportData()">📤 Export</button>
      <button class="action-btn" onclick="shareProgress()">🔗 Share</button>
      <button class="action-btn" onclick="resetAll()">🔄 Reset</button>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification"></div>

    <script>
      // Configuration
      const SEASON_START = "2025-09-11";
      const SEASON_END = "2025-12-11";

      // Ranks
      const ranks = [
        { name: "Bronze IV", points: 25, icon: "B4", tier: "bronze" },
        { name: "Bronze III", points: 50, icon: "B3", tier: "bronze" },
        { name: "Bronze II", points: 75, icon: "B2", tier: "bronze" },
        { name: "Bronze I", points: 100, icon: "B1", tier: "bronze" },
        { name: "Silver IV", points: 150, icon: "S4", tier: "silver" },
        { name: "Silver III", points: 200, icon: "S3", tier: "silver" },
        { name: "Silver II", points: 250, icon: "S2", tier: "silver" },
        { name: "Silver I", points: 300, icon: "S1", tier: "silver" },
        { name: "Gold IV", points: 375, icon: "G4", tier: "gold" },
        { name: "Gold III", points: 450, icon: "G3", tier: "gold" },
        { name: "Gold II", points: 525, icon: "G2", tier: "gold" },
        { name: "Gold I", points: 600, icon: "G1", tier: "gold" },
        { name: "Platinum IV", points: 700, icon: "P4", tier: "platinum" },
        { name: "Platinum III", points: 800, icon: "P3", tier: "platinum" },
        { name: "Platinum II", points: 900, icon: "P2", tier: "platinum" },
        { name: "Platinum I", points: 1000, icon: "P1", tier: "platinum" },
        { name: "Diamond IV", points: 1150, icon: "D4", tier: "diamond" },
        { name: "Diamond III", points: 1300, icon: "D3", tier: "diamond" },
        { name: "Diamond II", points: 1450, icon: "D2", tier: "diamond" },
        { name: "Diamond I", points: 1600, icon: "D1", tier: "diamond" },
        { name: "Emerald IV", points: 1800, icon: "E4", tier: "emerald" },
        { name: "Emerald III", points: 2000, icon: "E3", tier: "emerald" },
        { name: "Emerald II", points: 2200, icon: "E2", tier: "emerald" },
        { name: "Emerald I", points: 2400, icon: "E1", tier: "emerald" },
      ];

      // State
      let state = {
        currentPoints: 0,
        selectedGoal: "Emerald I",
        matches: [],
        lastAction: null,
      };

      // Initialize
      document.addEventListener("DOMContentLoaded", () => {
        loadState();
        initializeUI();
        updateDisplay();
      });

      // Load saved state
      function loadState() {
        const saved = localStorage.getItem("wtTrackerState");
        if (saved) {
          try {
            state = JSON.parse(saved);
          } catch (e) {
            console.error("Failed to load state:", e);
          }
        }
      }

      // Save state
      function saveState() {
        localStorage.setItem("wtTrackerState", JSON.stringify(state));
      }

      // Initialize UI
      function initializeUI() {
        // Set initial points value
        const input = document.getElementById("manualPointsInput");
        if (input) {
          input.value = state.currentPoints;
        }

        // Populate goal selector
        const select = document.getElementById("goalSelect");
        if (select) {
          ranks.forEach((rank) => {
            const option = document.createElement("option");
            option.value = rank.name;
            option.textContent = `${rank.name} (${rank.points} pts)`;
            if (rank.name === state.selectedGoal) {
              option.selected = true;
            }
            select.appendChild(option);
          });
        }
      }

      // Update points from input
      function updatePoints() {
        const input = document.getElementById("manualPointsInput");
        if (input) {
          const newPoints = parseInt(input.value) || 0;
          state.currentPoints = Math.max(0, Math.min(2400, newPoints));
          input.value = state.currentPoints;
          saveState();
          updateDisplay();
          showNotification(`Points set to ${state.currentPoints}`);
        }
      }

      // Add match
      function addMatch(type, points) {
        state.lastAction = { type: "add", points: points };
        state.currentPoints += points;
        state.matches.push({
          type: type,
          points: points,
          timestamp: new Date().toISOString(),
        });

        // Update input field
        const input = document.getElementById("manualPointsInput");
        if (input) {
          input.value = state.currentPoints;
        }

        saveState();
        updateDisplay();
        showNotification(`+${points} points (${type})`);
      }

      // Undo last action
      function undoLast() {
        if (state.matches.length > 0) {
          const lastMatch = state.matches.pop();
          state.currentPoints -= lastMatch.points;

          // Update input field
          const input = document.getElementById("manualPointsInput");
          if (input) {
            input.value = state.currentPoints;
          }

          saveState();
          updateDisplay();
          showNotification(`Undid ${lastMatch.type} (-${lastMatch.points})`);
        }
      }

      // Update goal
      function updateGoal() {
        const select = document.getElementById("goalSelect");
        if (select) {
          state.selectedGoal = select.value;
          saveState();
          updateDisplay();
        }
      }

      // Update display
      function updateDisplay() {
        // Update total points display
        const totalEl = document.getElementById("totalPoints");
        if (totalEl) {
          totalEl.textContent = state.currentPoints;
        }

        // Update days remaining
        const today = new Date();
        const seasonEnd = new Date(SEASON_END);
        const daysRemaining = Math.max(
          0,
          Math.ceil((seasonEnd - today) / (1000 * 60 * 60 * 24))
        );
        const daysEl = document.getElementById("daysRemaining");
        if (daysEl) {
          daysEl.textContent = daysRemaining;
        }

        // Update progress
        const goalRank = ranks.find((r) => r.name === state.selectedGoal);
        const goalPoints = goalRank ? goalRank.points : 2400;
        const progress = Math.min(
          100,
          (state.currentPoints / goalPoints) * 100
        );

        const progressBar = document.getElementById("progressBar");
        if (progressBar) {
          progressBar.style.width = `${progress}%`;
        }

        const progressText = document.getElementById("progressText");
        if (progressText) {
          progressText.textContent = `${state.currentPoints} / ${goalPoints}`;
        }

        // Update daily required
        const pointsNeeded = Math.max(0, goalPoints - state.currentPoints);
        const dailyRequired =
          daysRemaining > 0 ? Math.ceil(pointsNeeded / daysRemaining) : 0;
        const dailyEl = document.getElementById("dailyRequired");
        if (dailyEl) {
          dailyEl.textContent = dailyRequired;
        }

        // Update stats
        const wins = state.matches.filter((m) => m.type === "win").length;
        const winRate =
          state.matches.length > 0
            ? Math.round((wins / state.matches.length) * 100)
            : 0;
        const winRateEl = document.getElementById("winRate");
        if (winRateEl) {
          winRateEl.textContent = `${winRate}%`;
        }

        const totalMatchesEl = document.getElementById("totalMatches");
        if (totalMatchesEl) {
          totalMatchesEl.textContent = state.matches.length;
        }

        // Today's points
        const today2 = new Date().toDateString();
        const todayMatches = state.matches.filter(
          (m) => new Date(m.timestamp).toDateString() === today2
        );
        const todayPoints = todayMatches.reduce((sum, m) => sum + m.points, 0);
        const todayEl = document.getElementById("todayPoints");
        if (todayEl) {
          todayEl.textContent = todayPoints;
        }

        // Update undo button
        const undoEl = document.getElementById("undoPoints");
        if (undoEl) {
          if (state.matches.length > 0) {
            const lastMatch = state.matches[state.matches.length - 1];
            undoEl.textContent = `-${lastMatch.points}`;
          } else {
            undoEl.textContent = "-0";
          }
        }

        // Update rank grid
        updateRankGrid();
      }

      // Update rank grid
      function updateRankGrid() {
        const grid = document.getElementById("rankGrid");
        if (!grid) return;

        grid.innerHTML = ranks
          .map((rank) => {
            const isCompleted = state.currentPoints >= rank.points;
            const isCurrent =
              !isCompleted &&
              (ranks.indexOf(rank) === 0 ||
                state.currentPoints >= ranks[ranks.indexOf(rank) - 1]?.points);

            let className = "rank-item";
            if (isCompleted) className += " completed";
            if (isCurrent) className += " current";

            return `
                    <div class="${className}">
                        <div style="font-weight: 700; font-size: 1.2rem;">${
                          rank.icon
                        }</div>
                        <div>${rank.name}</div>
                        <div style="font-size: 0.85rem; color: #b0b0b0;">${
                          rank.points
                        } pts</div>
                        <div style="font-size: 0.85rem; color: ${
                          isCompleted ? "#50c878" : "#ff4757"
                        };">
                            ${
                              isCompleted
                                ? "✓"
                                : `+${rank.points - state.currentPoints}`
                            }
                        </div>
                    </div>
                `;
          })
          .join("");
      }

      // Show notification
      function showNotification(message) {
        const notification = document.getElementById("notification");
        if (notification) {
          notification.textContent = message;
          notification.classList.add("show");
          setTimeout(() => {
            notification.classList.remove("show");
          }, 3000);
        }
      }

      // Export data
      function exportData() {
        const dataStr = JSON.stringify(state, null, 2);
        const blob = new Blob([dataStr], { type: "application/json" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = `wt-tracker-${
          new Date().toISOString().split("T")[0]
        }.json`;
        a.click();
        URL.revokeObjectURL(url);
        showNotification("Data exported");
      }

      // Share progress
      function shareProgress() {
        const goalRank = ranks.find((r) => r.name === state.selectedGoal);
        const goalPoints = goalRank ? goalRank.points : 2400;
        const progress = ((state.currentPoints / goalPoints) * 100).toFixed(1);

        const text = `THE FINALS Season 8 Progress: ${state.currentPoints}/${goalPoints} points (${progress}%)`;

        if (navigator.share) {
          navigator.share({ text: text });
        } else {
          navigator.clipboard.writeText(text);
          showNotification("Progress copied to clipboard");
        }
      }

      // Reset all
      function resetAll() {
        if (confirm("Reset all data? This cannot be undone.")) {
          state = {
            currentPoints: 0,
            selectedGoal: "Emerald I",
            matches: [],
            lastAction: null,
          };
          saveState();
          location.reload();
        }
      }
    </script>
  </body>
</html>
