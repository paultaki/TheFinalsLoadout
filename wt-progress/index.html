<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>THE FINALS World Tour Tracker - Season 8 Rank Calculator | Real-Time Progress</title>
    <meta
      name="description"
      content="Track your World Tour progress in THE FINALS Season 8. Calculate daily points needed for any rank from Bronze to Emerald, visualize your pace, share progress screenshots. Free rank calculator with 24 ranks from Bronze IV to Emerald I."
    />

    <meta
      name="keywords"
      content="THE FINALS World Tour tracker, Emerald rank calculator, Season 8 progress, daily points calculator, rank tracker, gaming tools"
    />

    <!-- Mobile Web App Meta Tags -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="WT Tracker">

    <!-- Performance Optimizations -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" as="style">

    <!--  Open Graph / Facebook social   -->
    <meta property="og:type" content="website" />
    <meta
      property="og:url"
      content="https://www.thefinalsloadout.com/wt-progress/"
    />
    <meta
      property="og:title"
      content="S8 World Tour Progress Tracker - The Finals"
    />
    <meta
      property="og:description"
      content="Track your progress to any rank in The Finals Season 8"
    />
    <meta
      property="og:image"
      content="https://www.thefinalsloadout.com/wt-progress/images/social1200x630.png"
    />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:image:type" content="image/png" />
    <meta
      property="og:url"
      content="https://www.thefinalsloadout.com/wt-progress/"
    />

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta
      name="twitter:title"
      content="S8 World Tour Progress Tracker - The Finals"
    />
    <meta
      name="twitter:description"
      content="Track your progress to any rank in The Finals Season 8"
    />
    <meta
      name="twitter:image"
      content="https://www.thefinalsloadout.com/wt-progress/images/social1200x630.png"
    />
    <meta
      name="twitter:url"
      content="https://www.thefinalsloadout.com/wt-progress/"
    />

    <!-- Structured Data - WebApplication -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "THE FINALS World Tour Progress Tracker",
      "applicationCategory": "GameApplication",
      "operatingSystem": "Web",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "4.8",
        "ratingCount": "200"
      },
      "description": "Track World Tour progress and calculate points needed for any rank",
      "screenshot": "https://thefinalsloadout.com/wt-progress/images/screenshot.png"
    }
    </script>

    <!-- FAQ Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [{
        "@type": "Question",
        "name": "How many points do I need for Emerald rank in THE FINALS Season 8?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "You need 2,400 points to reach Emerald I, the highest rank in World Tour. Emerald IV starts at 1,800 points."
        }
      },{
        "@type": "Question",
        "name": "How do World Tour points work in Season 8?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "In World Tour Season 8: Win = 25 points, Lose Final = 14 points, Knocked out Round 2 = 6 points, Knocked out Round 1 = 2 points."
        }
      },{
        "@type": "Question",
        "name": "How long is THE FINALS Season 8?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Season 8 runs from December 11, 2024 to March 12, 2025, lasting 91 days total."
        }
      }]
    }
    </script>

    <link rel="icon" type="image/x-icon" href="images/favicon.ico" />
    <link rel="apple-touch-icon" href="images/logo.png" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      /* Accessibility - Screen reader only content */
      .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border-width: 0;
      }

      /* Focus indicators */
      *:focus {
        outline: 2px solid #50c878;
        outline-offset: 2px;
      }

      button:focus,
      input:focus,
      select:focus,
      a:focus {
        outline: 3px solid #50c878;
        outline-offset: 3px;
        box-shadow: 0 0 0 4px rgba(80, 200, 120, 0.2);
      }

      body {
        background: linear-gradient(
          135deg,
          #0a0a0a 0%,
          #1a1a1a 50%,
          #0d1117 100%
        );
        color: #ffffff;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        padding: 0;
        margin: 0;
        min-height: 100vh;
        position: relative;
        padding-top: 80px;
      }

      body::before {
        content: "";
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: radial-gradient(
            circle at 20% 50%,
            rgba(80, 200, 120, 0.05) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 80% 80%,
            rgba(0, 255, 204, 0.03) 0%,
            transparent 50%
          );
        pointer-events: none;
        z-index: 1;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px 20px 20px;
        position: relative;
        z-index: 2;
      }

      /* Season 8 Badge */
      .season-badge {
        display: inline-flex;
        align-items: center;
        background: linear-gradient(135deg, #50c878, #20b2aa);
        color: #000;
        padding: 0.25rem 0.75rem;
        border-radius: 20px;
        font-size: 0.85rem;
        font-weight: 700;
        margin-bottom: 1rem;
        animation: pulse 2s infinite;
      }

      @keyframes pulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.05); }
      }

      /* Step indicators */
      .step-indicator {
        display: inline-flex;
        align-items: center;
        background: linear-gradient(135deg, #50c878, #20b2aa);
        color: #000;
        padding: 0.25rem 0.75rem;
        border-radius: 20px;
        font-size: 0.9rem;
        font-weight: 800;
        margin-bottom: 0.5rem;
        text-transform: uppercase;
        letter-spacing: 1px;
        animation: pulse-attention 2s infinite;
      }

      @keyframes pulse-attention {
        0%, 100% {
          transform: scale(1);
          box-shadow: 0 0 0 0 rgba(80, 200, 120, 0.7);
        }
        50% {
          transform: scale(1.05);
          box-shadow: 0 0 20px 5px rgba(80, 200, 120, 0.3);
        }
      }

      /* First load animation */
      @keyframes highlight-first-load {
        0%, 100% {
          box-shadow: 0 0 30px rgba(80, 200, 120, 0.5);
          border-color: #50c878;
        }
        50% {
          box-shadow: 0 0 50px rgba(80, 200, 120, 0.8);
          border-color: #60d888;
        }
      }

      .highlight-action {
        animation: highlight-first-load 2s ease-in-out 3;
      }

      /* First time overlay */
      .first-time-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.9);
        z-index: 9999;
        display: flex;
        align-items: center;
        justify-content: center;
        backdrop-filter: blur(5px);
      }

      .first-time-content {
        background: linear-gradient(135deg, #1a1a1a 0%, #0d0d0d 100%);
        border: 3px solid #50c878;
        border-radius: 20px;
        padding: 2rem;
        max-width: 500px;
        text-align: center;
        box-shadow: 0 0 50px rgba(80, 200, 120, 0.5);
      }

      .first-time-title {
        font-size: 1.8rem;
        font-weight: 700;
        margin-bottom: 1.5rem;
        background: linear-gradient(135deg, #50c878, #20b2aa);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }

      .first-time-step {
        display: flex;
        align-items: center;
        margin: 1.5rem 0;
        text-align: left;
        padding: 1rem;
        background: rgba(80, 200, 120, 0.1);
        border-radius: 10px;
        border: 1px solid rgba(80, 200, 120, 0.3);
      }

      .first-time-step-number {
        background: linear-gradient(135deg, #50c878, #20b2aa);
        color: #000;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 800;
        font-size: 1.2rem;
        margin-right: 1rem;
        flex-shrink: 0;
      }

      .first-time-step-text {
        color: #fff;
        font-size: 1rem;
      }

      .first-time-button {
        background: linear-gradient(135deg, #50c878, #20b2aa);
        color: #000;
        border: none;
        padding: 1rem 2rem;
        border-radius: 10px;
        font-size: 1.1rem;
        font-weight: 700;
        cursor: pointer;
        margin-top: 1.5rem;
        transition: all 0.3s;
      }

      .first-time-button:hover {
        transform: scale(1.05);
        box-shadow: 0 5px 20px rgba(80, 200, 120, 0.5);
      }

      /* Help button */
      .help-button {
        position: fixed;
        bottom: 80px;
        right: 20px;
        background: linear-gradient(135deg, #50c878, #20b2aa);
        color: #000;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        font-weight: 700;
        cursor: pointer;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        transition: all 0.3s;
        z-index: 1000;
      }

      .help-button:hover {
        transform: scale(1.1);
        box-shadow: 0 6px 20px rgba(80, 200, 120, 0.5);
      }

      /* Track Your Progress Section */
      .track-progress-section {
        margin-bottom: 30px;
        box-sizing: border-box;
        width: 100%;
      }

      .track-progress-header {
        text-align: center;
        margin-bottom: 30px;
      }

      .setup-container {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 20px;
        margin-top: 20px;
        margin-bottom: 30px;
      }

      .setup-step {
        background: rgba(10, 10, 10, 0.6);
        border: 2px solid rgba(255, 255, 255, 0.1);
        border-radius: 12px;
        padding: 20px 25px 15px;
        position: relative;
      }

      .step-number {
        position: absolute;
        top: -22px;
        left: 25px;
        background: #50c878;
        color: #0a0a0a;
        width: 45px;
        height: 45px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        font-size: 1.65em;
        box-shadow: 0 2px 10px rgba(80, 200, 120, 0.5);
      }

      .step-title {
        font-size: 1.8em;
        margin-bottom: 20px;
        margin-top: 10px;
        color: #fff;
        font-weight: 600;
      }

      /* Goal Selector */
      .goal-selector-container {
        background: linear-gradient(135deg, rgba(80, 200, 120, 0.15) 0%, rgba(80, 200, 120, 0.05) 100%);
        border: 3px solid #50c878;
        border-radius: 15px;
        padding: 1.5rem;
        margin: 2rem 0;
        box-shadow: 0 0 30px rgba(80, 200, 120, 0.3);
        position: relative;
      }

      .goal-selector-container.highlight-action {
        animation: highlight-first-load 2s ease-in-out infinite;
      }

      .goal-selector-header {
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
        margin-bottom: 1rem;
        gap: 0.5rem;
      }

      .goal-selector-title {
        font-size: 1.35rem;
        font-weight: 700;
        color: #50c878;
        margin-bottom: 8px;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        justify-content: center;
        width: 100%;
      }

      .goal-hint {
        font-size: 1rem;
        color: #fff;
        background: rgba(80, 200, 120, 0.2);
        padding: 0.5rem 1rem;
        border-radius: 8px;
        margin-bottom: 1rem;
        font-weight: 600;
        border: 1px solid rgba(80, 200, 120, 0.4);
        text-transform: uppercase;
        letter-spacing: 0.5px;
        animation: pulse-attention 2s ease-in-out infinite;
        display: inline-block;
      }

      .goal-selector {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 1rem;
        width: 100%;
      }

      .goal-select {
        background: linear-gradient(135deg, rgba(80, 200, 120, 0.2) 0%, rgba(0, 0, 0, 0.8) 100%);
        border: 3px solid #50c878;
        color: #fff;
        padding: 1rem 1.5rem;
        border-radius: 12px;
        font-size: 1.15rem;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.3s;
        min-width: 280px;
        box-shadow: 0 4px 15px rgba(80, 200, 120, 0.3);
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .goal-select:hover {
        background: linear-gradient(135deg, rgba(80, 200, 120, 0.2) 0%, rgba(0, 0, 0, 0.7) 100%);
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(80, 200, 120, 0.4);
        border-color: #60d888;
      }

      /* Fix dropdown option styling */
      .goal-select option {
        background: #1a1a1a;
        color: #ffffff;
        padding: 0.5rem;
      }

      .goal-select option:hover,
      .goal-select option:focus {
        background: #2a2a2a;
        color: #50c878;
      }

      .goal-select option:checked {
        background: linear-gradient(135deg, rgba(80, 200, 120, 0.2) 0%, rgba(0, 0, 0, 0.9) 100%);
        color: #50c878;
      }

      .goal-display {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 1.1rem;
      }

      .goal-rank-icon {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        font-size: 0.8rem;
      }

      .goal-points {
        color: #b0b0b0;
        font-size: 0.9rem;
      }

      /* Stats Grid */
      .stats-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 20px;
        margin-bottom: 30px;
        align-items: stretch;
      }

      .stat-card {
        background: rgba(255, 255, 255, 0.03);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 15px;
        padding: 20px;
        text-align: center;
        transition: all 0.3s;
        display: flex;
        flex-direction: column;
        justify-content: center;
      }

      .stat-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        border-color: rgba(80, 200, 120, 0.3);
      }

      .stat-card.half-height {
        flex: 1;
        padding: 15px 20px;
        min-height: 0;
      }

      .stats-column {
        display: flex;
        flex-direction: column;
        gap: 20px;
      }

      .stat-card.primary {
        background: linear-gradient(
          135deg,
          rgba(80, 200, 120, 0.1) 0%,
          rgba(80, 200, 120, 0.05) 100%
        );
        border: 2px solid #50c878;
      }

      .stat-label {
        font-size: 0.9em;
        color: #b0b0b0;
        margin-bottom: 10px;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      .stat-value {
        font-size: 2.5em;
        font-weight: 700;
        background: linear-gradient(135deg, #50c878, #20b2aa);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }

      .points-input-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        position: relative;
        gap: 12px;
        padding: 1rem;
        background: linear-gradient(135deg, rgba(80, 200, 120, 0.15) 0%, rgba(80, 200, 120, 0.05) 100%);
        border-radius: 15px;
        border: 3px dashed rgba(80, 200, 120, 0.5);
        transition: all 0.3s;
      }

      .points-input-container.highlight-action {
        animation: highlight-first-load 2s ease-in-out infinite;
      }

      .points-input-container:hover {
        border-style: solid;
        border-color: #50c878;
        box-shadow: 0 0 20px rgba(80, 200, 120, 0.3);
      }

      .setup-step .input-hint {
        font-size: 0.9rem;
        color: #888;
        background: none;
        padding: 0;
        margin-top: 5px;
        border-radius: 0;
        font-weight: 400;
        text-transform: none;
        letter-spacing: normal;
        cursor: default;
        animation: none;
        box-shadow: none;
      }

      .input-hint {
        font-size: 1.1rem;
        color: #fff;
        background: linear-gradient(135deg, #50c878, #20b2aa);
        padding: 0.75rem 1.5rem;
        border-radius: 10px;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 1px;
        cursor: pointer;
        transition: all 0.3s;
        animation: pulse-attention 2s ease-in-out infinite;
        box-shadow: 0 4px 15px rgba(80, 200, 120, 0.3);
      }

      .input-hint:hover {
        transform: scale(1.05);
        box-shadow: 0 6px 20px rgba(80, 200, 120, 0.5);
      }

      .points-input-container:hover .input-hint {
        opacity: 0.8;
      }

      .setup-step .points-input {
        background: rgba(255, 255, 255, 0.05);
        border: 2px solid rgba(80, 200, 120, 0.5);
        color: #50c878;
        font-size: 3em;
        font-weight: 700;
        text-align: center;
        width: 100%;
        padding: 20px;
        cursor: text;
        transition: all 0.3s;
        border-radius: 10px;
        -webkit-appearance: none;
        -moz-appearance: textfield;
        box-shadow: none;
      }

      .setup-step .points-input:focus {
        outline: none;
        border-color: #50c878;
        background: rgba(255, 255, 255, 0.08);
        box-shadow: 0 0 20px rgba(80, 200, 120, 0.3);
      }

      .points-input {
        background: rgba(0, 0, 0, 0.6);
        border: 3px solid #50c878;
        color: #50c878;
        font-size: 3em;
        font-weight: 700;
        text-align: center;
        width: 200px;
        padding: 15px;
        cursor: pointer;
        transition: all 0.3s;
        border-radius: 12px;
        -webkit-appearance: none;
        -moz-appearance: textfield;
        box-shadow: 0 0 20px rgba(80, 200, 120, 0.2) inset;
      }
      
      .points-input::placeholder {
        color: rgba(80, 200, 120, 0.3);
        font-size: 0.5em;
      }

      .points-input:hover {
        background: rgba(80, 200, 120, 0.15);
        border-color: rgba(80, 200, 120, 0.6);
        transform: scale(1.02);
      }

      .points-input:focus {
        outline: 3px solid #50c878;
        outline-offset: 3px;
        background: rgba(80, 200, 120, 0.2);
        border: 3px solid #50c878;
        box-shadow: 0 0 30px rgba(80, 200, 120, 0.5);
        transform: scale(1.05);
      }

      /* Progress Section */
      .progress-section {
        margin: 30px 0;
        background: rgba(255, 255, 255, 0.03);
        border-radius: 15px;
        padding: 25px;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .progress-section h2 {
        margin-bottom: 20px;
        font-size: 1.5em;
        background: linear-gradient(135deg, #50c878, #20b2aa);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }

      .progress-container {
        position: relative;
        height: 40px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 20px;
        overflow: visible;
        margin-bottom: 50px;
        margin-top: 20px;
      }

      .progress-bar {
        height: 100%;
        background: linear-gradient(90deg, #50c878, #20b2aa);
        border-radius: 20px;
        transition: width 0.5s ease;
        box-shadow: 0 0 20px rgba(80, 200, 120, 0.5);
        position: relative;
        z-index: 1;
      }

      .progress-text {
        position: absolute;
        top: 50%;
        right: 20px;
        transform: translateY(-50%);
        font-weight: 600;
        font-size: 1.1em;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
        z-index: 2;
      }

      .progress-milestones {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 100%;
        z-index: 2;
        pointer-events: none;
      }

      .milestone-marker {
        position: absolute;
        top: -10px;
        transform: translateX(-50%);
        display: flex;
        flex-direction: column;
        align-items: center;
        z-index: 3;
      }

      .milestone-dot {
        width: 20px;
        height: 20px;
        border-radius: 50%;
        background: #1a1a2e;
        border: 3px solid rgba(255, 255, 255, 0.3);
        margin-bottom: 5px;
        transition: all 0.3s;
      }

      .milestone-dot.achieved {
        background: #50c878;
        border-color: #50c878;
        box-shadow: 0 0 10px rgba(80, 200, 120, 0.5);
      }

      .milestone-label {
        font-size: 0.75em;
        color: #888;
        text-transform: uppercase;
        margin-top: 25px;
        white-space: nowrap;
      }

      .milestone-label.achieved {
        color: #50c878;
        font-weight: 600;
      }

      .pace-indicator {
        text-align: center;
        padding: 10px;
        border-radius: 10px;
        font-weight: 600;
        transition: all 0.3s;
      }

      .pace-indicator.ahead {
        background: rgba(80, 200, 120, 0.2);
        color: #50c878;
      }

      .pace-indicator.behind {
        background: rgba(255, 71, 87, 0.2);
        color: #ff4757;
      }

      .pace-indicator.on-track {
        background: rgba(255, 193, 7, 0.2);
        color: #ffc107;
      }

      /* Quick Actions */
      .match-results-section {
        background: rgba(255, 255, 255, 0.03);
        border-radius: 15px;
        padding: 20px;
        margin: 30px 0;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .match-results-section h2 {
        margin-bottom: 20px;
        font-size: 1.5em;
        background: linear-gradient(135deg, #50c878, #20b2aa);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }

      .quick-actions {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 15px;
      }

      .quick-action-btn {
        background: rgba(10, 10, 10, 0.6);
        border: 2px solid;
        color: #ffffff;
        padding: 20px 15px;
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.3s;
        font-weight: 600;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 8px;
        min-height: 120px;
        position: relative;
      }

      .quick-action-icon {
        font-size: 2.5em;
        margin-bottom: 5px;
      }

      .quick-action-label {
        font-size: 1.1em;
        font-weight: 600;
        margin-bottom: 5px;
      }

      .quick-action-points {
        font-weight: 800;
        font-size: 1.3em;
        color: #50c878;
      }

      .quick-action-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.4);
      }

      .quick-action-btn.win {
        border-color: #ffd700;
        background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 215, 0, 0.05));
      }

      .quick-action-btn.win:hover {
        background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(255, 215, 0, 0.1));
        box-shadow: 0 5px 20px rgba(255, 215, 0, 0.3);
      }

      .quick-action-btn.second {
        border-color: #c0c0c0;
        background: linear-gradient(135deg, rgba(192, 192, 192, 0.1), rgba(192, 192, 192, 0.05));
      }

      .quick-action-btn.third {
        border-color: #cd7f32;
        background: linear-gradient(135deg, rgba(205, 127, 50, 0.1), rgba(205, 127, 50, 0.05));
      }

      .quick-action-btn.qualified {
        border-color: #50c878;
        background: linear-gradient(135deg, rgba(80, 200, 120, 0.1), rgba(80, 200, 120, 0.05));
      }

      .quick-action-btn.eliminated {
        border-color: #ff4757;
        background: linear-gradient(135deg, rgba(255, 71, 87, 0.1), rgba(255, 71, 87, 0.05));
      }

      .quick-action-btn.undo {
        border-color: #ff4757;
        background: linear-gradient(135deg, rgba(255, 71, 87, 0.1), rgba(255, 71, 87, 0.05));
      }

      .quick-action-btn.undo .quick-action-label {
        color: #ff4757;
      }

      /* Rank Ladder */
      .rank-ladder {
        background: rgba(255, 255, 255, 0.03);
        border-radius: 15px;
        padding: 20px;
        margin: 30px 0;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .rank-ladder h2 {
        margin-bottom: 20px;
        font-size: 1.5em;
        background: linear-gradient(135deg, #50c878, #20b2aa);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }

      #rankLadder {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 15px;
      }

      .rank-item {
        display: flex;
        align-items: center;
        padding: 12px 15px;
        background: rgba(255, 255, 255, 0.02);
        border-radius: 10px;
        border: 1px solid rgba(255, 255, 255, 0.05);
        transition: all 0.3s;
        opacity: 0;
        animation: fadeInUp 0.5s forwards;
        position: relative;
      }

      .rank-item-content {
        display: flex;
        align-items: center;
        flex: 1;
        gap: 10px;
      }

      .rank-status {
        width: 24px;
        height: 24px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.9em;
        border: 2px solid rgba(255, 255, 255, 0.2);
      }

      .rank-status.completed {
        background: #50c878;
        border-color: #50c878;
        color: #0a0a0a;
      }

      @keyframes fadeInUp {
        to {
          opacity: 1;
          transform: translateY(0);
        }
        from {
          opacity: 0;
          transform: translateY(20px);
        }
      }

      /* Scroll Reveal Animation */
      .scroll-reveal {
        opacity: 0;
        transform: translateY(30px);
        transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .scroll-reveal.revealed {
        opacity: 1;
        transform: translateY(0);
      }

      /* Stagger animations for children */
      .setup-container > .scroll-reveal:nth-child(1) { transition-delay: 0.1s; }
      .setup-container > .scroll-reveal:nth-child(2) { transition-delay: 0.2s; }
      .stats-grid > .scroll-reveal:nth-child(1) { transition-delay: 0.1s; }
      .stats-grid > .scroll-reveal:nth-child(2) { transition-delay: 0.2s; }
      .stats-grid > .scroll-reveal:nth-child(3) { transition-delay: 0.3s; }

      .rank-item:hover {
        transform: translateX(5px);
        background: rgba(80, 200, 120, 0.1);
        border-color: rgba(80, 200, 120, 0.3);
      }

      .rank-item.completed {
        background: rgba(80, 200, 120, 0.15);
        border-color: #50c878;
      }

      .rank-item.current {
        background: rgba(255, 193, 7, 0.15);
        border-color: #ffc107;
        box-shadow: 0 0 20px rgba(255, 193, 7, 0.3);
      }

      .rank-icon {
        width: 45px;
        height: 45px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        font-size: 0.9rem;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
      }

      /* Rank colors */
      .rank-bronze { background: linear-gradient(135deg, #CD7F32, #8B4513); }
      .rank-silver { background: linear-gradient(135deg, #C0C0C0, #808080); }
      .rank-gold { background: linear-gradient(135deg, #FFD700, #FFA500); }
      .rank-platinum { background: linear-gradient(135deg, #E5E4E2, #B0B0B0); }
      .rank-diamond { background: linear-gradient(135deg, #B9F2FF, #00CED1); }
      .rank-emerald { background: linear-gradient(135deg, #50C878, #2E8B57); }

      /* Daily Entries */
      .daily-entries-section {
        background: rgba(255, 255, 255, 0.03);
        border-radius: 15px;
        padding: 25px;
        margin: 30px 0;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .entry-form {
        display: grid;
        grid-template-columns: 1fr 1fr 2fr auto;
        gap: 10px;
        margin-bottom: 20px;
      }

      .entry-input {
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: #ffffff;
        padding: 10px;
        border-radius: 8px;
        font-size: 1em;
      }

      .entry-input:focus {
        border-color: #50c878;
        background: rgba(80, 200, 120, 0.1);
      }

      .add-entry-btn {
        background: linear-gradient(135deg, #50c878, #20b2aa);
        color: #000;
        border: none;
        padding: 10px 20px;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.3s;
      }

      .add-entry-btn:hover {
        transform: scale(1.05);
        box-shadow: 0 5px 15px rgba(80, 200, 120, 0.3);
      }

      .entries-list {
        max-height: 400px;
        overflow-y: auto;
      }

      .entry-item {
        display: grid;
        grid-template-columns: 100px 80px 1fr auto;
        align-items: center;
        padding: 12px;
        margin-bottom: 8px;
        background: rgba(255, 255, 255, 0.02);
        border-radius: 8px;
        border: 1px solid rgba(255, 255, 255, 0.05);
        transition: all 0.3s;
      }

      .entry-item:hover {
        background: rgba(80, 200, 120, 0.05);
        transform: translateX(5px);
      }

      .entry-points {
        color: #50c878;
        font-weight: 600;
      }

      /* Notification */
      .notification {
        position: fixed;
        top: 100px;
        right: 20px;
        padding: 15px 20px;
        border-radius: 10px;
        background: rgba(80, 200, 120, 0.9);
        color: #000;
        font-weight: 600;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
        transform: translateX(400px);
        transition: transform 0.3s;
        z-index: 1000;
      }

      .notification.show {
        transform: translateX(0);
      }

      .notification.error {
        background: rgba(255, 71, 87, 0.9);
        color: #fff;
      }

      /* Confetti */
      .confetti {
        position: fixed;
        width: 10px;
        height: 10px;
        background: #50c878;
        animation: confetti-fall 3s linear;
        z-index: 999;
      }

      @keyframes confetti-fall {
        to {
          transform: translateY(100vh) rotate(360deg);
          opacity: 0;
        }
      }

      /* Milestone Popup */
      .milestone-popup {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) scale(0);
        background: linear-gradient(135deg, rgba(10, 10, 10, 0.98) 0%, rgba(26, 26, 26, 0.98) 100%);
        border: 3px solid #50c878;
        border-radius: 20px;
        padding: 30px;
        text-align: center;
        z-index: 1001;
        animation: milestone-appear 0.5s forwards;
        box-shadow: 0 0 50px rgba(80, 200, 120, 0.5);
      }

      @keyframes milestone-appear {
        to {
          transform: translate(-50%, -50%) scale(1);
        }
      }

      .milestone-icon {
        font-size: 4em;
        margin-bottom: 15px;
      }

      .milestone-title {
        font-size: 2em;
        font-weight: 700;
        margin-bottom: 10px;
        background: linear-gradient(135deg, #50c878, #20b2aa);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }

      .milestone-message {
        font-size: 1.2em;
        color: #b0b0b0;
        margin-bottom: 20px;
      }

      .milestone-close {
        background: linear-gradient(135deg, #50c878, #20b2aa);
        color: #000;
        border: none;
        padding: 12px 30px;
        border-radius: 10px;
        cursor: pointer;
        font-weight: 700;
        font-size: 1.1em;
        transition: all 0.3s;
      }

      .milestone-close:hover {
        transform: scale(1.05);
        box-shadow: 0 5px 15px rgba(80, 200, 120, 0.3);
      }

      /* Celebration State */
      .celebration-mode {
        animation: celebration-pulse 2s infinite;
      }

      @keyframes celebration-pulse {
        0%, 100% {
          box-shadow: 0 0 30px rgba(80, 200, 120, 0.5);
        }
        50% {
          box-shadow: 0 0 50px rgba(80, 200, 120, 0.8);
        }
      }

      /* Mobile Responsive */
      @media (max-width: 768px) {
        body {
          padding-top: 60px;
        }

        .container {
          padding: 10px;
        }

        /* Make logo 30% bigger on mobile */
        .wt-logo {
          width: 52% !important;  /* 40% * 1.3 = 52% */
          max-width: 364px !important;  /* 280px * 1.3 = 364px */
        }

        .setup-container {
          grid-template-columns: 1fr;
          gap: 20px;
        }

        .setup-step {
          padding: 15px 15px 12px;
        }

        .stats-grid {
          grid-template-columns: 1fr;
        }

        .stats-column {
          display: contents;
        }

        .stats-column .stat-card {
          padding: 20px;
        }

        .goal-select {
          width: 100%;
          font-size: 1.1rem;
          padding: 1rem;
          touch-action: manipulation;
        }

        .entry-form {
          grid-template-columns: 1fr;
        }

        .quick-actions {
          grid-template-columns: repeat(2, 1fr);
          gap: 10px;
        }

        .quick-action-btn {
          min-height: 100px;
          padding: 15px 10px;
        }

        .quick-action-icon {
          font-size: 2em;
        }

        .quick-action-label {
          font-size: 0.95em;
        }

        .quick-action-points {
          font-size: 1.1em;
        }

        #rankLadder {
          grid-template-columns: 1fr;
        }

        .rank-item {
          font-size: 0.9rem;
        }

        /* Touch-friendly scrolling */
        .rank-ladder {
          -webkit-overflow-scrolling: touch;
          scroll-behavior: smooth;
        }

        /* Swipe hint */
        .rank-ladder::after {
          content: "‚Üï Swipe to scroll";
          display: block;
          text-align: center;
          color: #666;
          font-size: 0.8rem;
          margin-top: 10px;
        }
      }

      /* Loading state */
      .loading {
        opacity: 0.5;
        pointer-events: none;
      }

      /* Last updated indicator */
      .last-updated {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background: rgba(0, 0, 0, 0.8);
        padding: 8px 15px;
        border-radius: 20px;
        font-size: 0.85rem;
        color: #b0b0b0;
        border: 1px solid rgba(255, 255, 255, 0.1);
        z-index: 100;
      }

      /* Screenshot mode */
      .screenshot-mode .last-updated {
        display: none;
      }

      /* Nav */
      nav {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        background: rgba(10, 10, 10, 0.95);
        backdrop-filter: blur(10px);
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        z-index: 999;
        padding: 15px 0;
      }

      .nav-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .nav-logo {
        display: flex;
        align-items: center;
        gap: 10px;
        text-decoration: none;
        color: #fff;
        font-weight: 700;
        font-size: 1.2rem;
      }

      .nav-actions {
        display: flex;
        gap: 15px;
      }

      .nav-btn {
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: #fff;
        padding: 8px 16px;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s;
        font-weight: 600;
      }

      .nav-btn:hover {
        background: rgba(80, 200, 120, 0.2);
        border-color: #50c878;
      }

      /* Scrollbar styling */
      ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
      }

      ::-webkit-scrollbar-track {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 4px;
      }

      ::-webkit-scrollbar-thumb {
        background: rgba(80, 200, 120, 0.5);
        border-radius: 4px;
      }

      ::-webkit-scrollbar-thumb:hover {
        background: rgba(80, 200, 120, 0.7);
      }
    </style>
  </head>
  <body>
    <!-- First Time User Overlay -->
    <div id="firstTimeOverlay" class="first-time-overlay" style="display: none;">
      <div class="first-time-content">
        <h2 class="first-time-title">Welcome to World Tour Tracker!</h2>
        <p style="color: #b0b0b0; margin-bottom: 1.5rem;">Get started in just 2 simple steps:</p>

        <div class="first-time-step">
          <div class="first-time-step-number">1</div>
          <div class="first-time-step-text">
            <strong style="color: #50c878;">Select Your Goal Rank</strong><br>
            Choose your target rank from the dropdown menu
          </div>
        </div>

        <div class="first-time-step">
          <div class="first-time-step-number">2</div>
          <div class="first-time-step-text">
            <strong style="color: #50c878;">Enter Your Current Points</strong><br>
            Tap the points field and enter your current World Tour points
          </div>
        </div>

        <button class="first-time-button" onclick="closeFirstTimeOverlay()">Get Started!</button>
      </div>
    </div>

    <!-- Help Button -->
    <button class="help-button" onclick="showHelp()" title="Need help?">?</button>
    <!-- Mobile Menu Button and Overlay -->
    <style>
        /* Main Navigation Bar Styles */
        .main-nav {
            background: linear-gradient(135deg, rgba(26, 26, 26, 0.98) 0%, rgba(13, 13, 13, 0.98) 100%);
            border-bottom: 2px solid rgba(255, 51, 102, 0.3);
            padding: 15px 20px;
            position: sticky;
            top: 0;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }
        
        .nav-links {
            display: flex;
            justify-content: center;
            gap: 30px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .nav-link {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            font-family: 'Inter', sans-serif;
            font-weight: 600;
            font-size: 0.95rem;
            letter-spacing: 1px;
            text-transform: uppercase;
            transition: all 0.3s ease;
            padding: 8px 15px;
            border-radius: 8px;
            position: relative;
        }
        
        .nav-link:hover {
            color: #ff3366;
            background: rgba(255, 51, 102, 0.1);
            transform: translateY(-2px);
        }
        
        .nav-link.active {
            color: #ff3366;
            background: rgba(255, 51, 102, 0.15);
        }
        
        .nav-link.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 15px;
            right: 15px;
            height: 2px;
            background: linear-gradient(90deg, transparent, #ff3366, transparent);
        }
        
        /* Hide mobile menu button on desktop */
        @media (min-width: 769px) {
            #menuBtn, #simpleMenu, #menuOverlay {
                display: none !important;
            }
        }
        
        /* Mobile styles */
        @media (max-width: 768px) {
            /* Hide desktop nav on mobile */
            .desktop-nav {
                display: none !important;
            }
            #simpleMenu {
                position: fixed;
                top: 0;
                left: -280px;
                width: 280px;
                height: 100vh;
                background: linear-gradient(135deg, #1a1a1a 0%, #0d0d0d 100%);
                z-index: 99999;
                transition: left 0.3s ease;
                padding-top: 60px;
                box-shadow: 5px 0 20px rgba(0,0,0,0.7);
                border-right: 2px solid rgba(255, 51, 102, 0.3);
            }
            #simpleMenu.show {
                left: 0;
            }
            #simpleMenu a {
                display: block;
                color: white;
                padding: 15px;
                border-bottom: 1px solid #333;
                text-decoration: none;
                transition: all 0.3s;
            }
            #simpleMenu a:hover {
                background: rgba(255, 51, 102, 0.1);
                padding-left: 25px;
            }
            #simpleMenu a.active {
                color: #ff3366;
                background: rgba(255, 51, 102, 0.15);
            }
            #menuBtn {
                position: fixed;
                top: 10px;
                left: 10px;
                z-index: 100000;
                background: rgba(26, 26, 26, 0.95);
                color: #ff3366;
                border: 1px solid rgba(255, 51, 102, 0.3);
                border-radius: 8px;
                padding: 10px 12px;
                cursor: pointer;
                font-size: 20px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.3);
                transition: all 0.3s;
            }
            #menuBtn:hover {
                background: rgba(255, 51, 102, 0.1);
                transform: scale(1.1);
            }
            
            /* Dark overlay */
            #menuOverlay {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0,0,0,0.5);
                z-index: 99998;
                display: none;
            }
            #menuOverlay.show {
                display: block;
            }
        }
    </style>
    
    <button id="menuBtn" onclick="document.getElementById('simpleMenu').classList.toggle('show'); document.getElementById('menuOverlay').classList.toggle('show')">‚ò∞</button>
    
    <div id="menuOverlay" onclick="document.getElementById('simpleMenu').classList.remove('show'); this.classList.remove('show')"></div>
    
    <div id="simpleMenu">
        <a href="/">LOADOUT GENERATOR</a>
        <a href="/ragequit/">RAGE QUIT</a>
        <a href="/patch-notes/">PATCH NOTES</a>
        <a href="/meta-weapons/">META WEAPONS</a>
        <a href="/wt-progress/" class="active">WORLD TOUR</a>
    </div>
    
    <!-- Navigation Bar (Desktop) -->
    <nav class="main-nav desktop-nav">
        <div class="nav-links desktop-nav-links">
            <a href="/" class="nav-link">LOADOUT GENERATOR</a>
            <a href="/ragequit/" class="nav-link">RAGE QUIT</a>
            <a href="/patch-notes/" class="nav-link">PATCH NOTES</a>
            <a href="/meta-weapons/" class="nav-link">META WEAPONS</a>
            <a href="/wt-progress/" class="nav-link active">WORLD TOUR</a>
        </div>
    </nav>

    <!-- Original Navigation -->
    <nav>
      <div class="nav-container">
        <!-- Nav logo removed for cleaner look -->
        <div class="nav-actions">
          <button class="nav-btn" onclick="shareProgress()">üì§ Share</button>
          <button class="nav-btn" onclick="takeScreenshot()">üì∏ Screenshot</button>
          <button class="nav-btn" onclick="resetData()">üîÑ Reset</button>
        </div>
      </div>
    </nav>

    <div class="container">
      <!-- Hero Section -->
      <div style="text-align: center; max-width: 800px; margin: 1rem auto 1rem; padding: 2rem 1rem 0;">
        <img src="/wt-progress/images/wt-logo.webp" alt="World Tour" style="width: 40%; max-width: 280px; height: auto; margin: 0 auto 0.5rem; display: block;" class="wt-logo">
        <p style="font-size: 0.95rem; color: #b0b0b0; margin-bottom: 1rem;">
          September 11, 2025 - December 11, 2025 ‚Ä¢ 91 Days
        </p>
      </div>

      <!-- Main Container -->
      <div class="container">
        <!-- Track Your Progress Section -->
        <div class="track-progress-section">
          <div class="track-progress-header">
            <h2 style="font-size: 2em; background: linear-gradient(135deg, #50c878, #20b2aa); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 10px;">Track Your Progress</h2>
            <p style="color: #888; margin-bottom: 30px;">Set your goal and track your daily progress throughout Season 8</p>
          </div>

          <div class="setup-container">
            <div class="setup-step scroll-reveal">
              <div class="step-number">1</div>
              <h3 class="step-title">Select Your S8 Goal</h3>
              <div class="goal-selector" style="min-height: 100px; display: flex; align-items: center; justify-content: center;">
                <select id="goalSelect" class="goal-select" onchange="updateGoal()">
                  <!-- Options will be populated by JavaScript -->
                </select>
              </div>
            </div>

            <div class="setup-step scroll-reveal">
              <div class="step-number">2</div>
              <h3 class="step-title">Enter Current Points</h3>
              <div class="points-input-container" id="pointsInputContainer">
                <input
                  type="number"
                  id="currentPoints"
                  class="points-input"
                  value="0"
                  min="0"
                  max="2400"
                  aria-label="Current points"
                  title="Click to edit your current points"
                  placeholder="0"
                />
                <div class="input-hint">Tap to update your points</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Stats Grid -->
        <div class="stats-grid">

        <div class="stats-column scroll-reveal">
          <div class="stat-card half-height">
            <div class="stat-icon" style="font-size: 2em; margin-bottom: 10px;">üìÖ</div>
            <div class="stat-label">Days Remaining in Season 8</div>
            <div class="stat-value" id="daysRemaining" style="font-size: 2.7em;">--</div>
            <div class="stat-subtitle" id="seasonEndDate" style="font-size: 0.9em; color: #888; margin-top: 5px;">--</div>
          </div>
          <div class="stat-card half-height">
            <div class="stat-icon" style="font-size: 2em; margin-bottom: 10px;">üéØ</div>
            <div class="stat-label">Points to Next Rank</div>
            <div class="stat-value" id="pointsToNext" style="font-size: 2.7em;">
              <span class="next-rank-points">--</span>
            </div>
            <div class="stat-subtitle next-rank-name" style="font-size: 0.9em; color: #888; margin-top: 5px;">--</div>
          </div>
        </div>

        <div class="stat-card primary">
          <div class="stat-icon" style="font-size: 2em; margin-bottom: 10px;">‚¨áÔ∏è</div>
          <div class="stat-label">Daily Points Needed</div>
          <div class="stat-value" id="pointsPerDay" style="font-size: 3em;">--</div>
          <div class="stat-subtitle" id="dailyGoalStatus" style="font-size: 0.9em; color: #50c878; margin-top: 10px;"></div>
          <div class="goal-breakdown" id="goalBreakdown"></div>
        </div>

        <div class="stats-column scroll-reveal">
          <div class="stat-card half-height" style="position: relative; z-index: 1000 !important;">
            <div class="stat-icon" style="font-size: 2em; margin-bottom: 10px;">üìà</div>
            <div class="stat-label">Projected Completion
              <span class="tooltip-icon" style="cursor: help; color: #888; font-size: 0.9em;">‚ìò</span>
              <div class="tooltip-content" data-tooltip-type="projected" style="
                display: none;
                position: absolute;
                background: rgb(0, 0, 0) !important;
                background-color: rgb(0, 0, 0) !important;
                opacity: 1 !important;
                border: 1px solid #50c878;
                border-radius: 8px;
                padding: 15px;
                width: 280px;
                left: 50%;
                transform: translateX(-50%);
                top: calc(100% + 10px);
                z-index: 999999 !important;
                text-align: left;
                font-size: 0.85rem;
                box-shadow: 0 4px 12px rgba(0,0,0,0.5);
                pointer-events: none;
                backdrop-filter: none;
                color: white !important;
                text-transform: none !important;
                letter-spacing: normal !important;
                font-family: inherit !important;
              ">
                <div style="color: #50c878; font-weight: 600; margin-bottom: 10px;">How Projected Completion Works:</div>
                <div style="color: #b0b0b0; line-height: 1.6;">
                  <strong>Formula:</strong><br>
                  <span style="color: white;">Daily Avg = Current Points √∑ Days Passed</span><br>
                  <span style="color: white;">Projected = (Daily Avg √ó Total Days) √∑ Goal Points √ó 100%</span>
                  <br><br>
                  <strong style="color: white;">Example:</strong><br>
                  Current: 300 points in 10 days<br>
                  Goal: 2400 points<br>
                  Daily Avg: 300 √∑ 10 = 30 pts/day<br>
                  Projected total: 30 √ó 90 days = 2700 pts<br>
                  <span style="color: #50c878;">Completion: 2700 √∑ 2400 = 113%</span>
                  <br><br>
                  <em>Shows if you'll reach your goal at current pace.</em>
                </div>
              </div>
            </div>
            <div class="stat-value" id="completion" style="font-size: 2.7em;">--</div>
            <div class="stat-subtitle" id="completionStatus" style="font-size: 0.9em; color: #50c878; margin-top: 5px;"></div>
          </div>
          <div class="stat-card half-height" style="position: relative;">
            <div class="stat-icon" style="font-size: 2em; margin-bottom: 10px;">üìÜ</div>
            <div class="stat-label">Est. Completion Date
              <span class="tooltip-icon" style="cursor: help; color: #888; font-size: 0.9em;">‚ìò</span>
              <div class="tooltip-content" data-tooltip-type="completion" style="
                display: none;
                position: absolute;
                background: rgb(0, 0, 0) !important;
                background-color: rgb(0, 0, 0) !important;
                opacity: 1 !important;
                border: 1px solid #50c878;
                border-radius: 8px;
                padding: 0;
                width: 280px;
                left: 50%;
                transform: translateX(-50%);
                bottom: 100%;
                margin-bottom: 10px;
                z-index: 999999 !important;
                text-align: left;
                font-size: 0.85rem;
                box-shadow: 0 4px 12px rgba(0,0,0,0.5);
                pointer-events: none;
                backdrop-filter: none;
                color: white !important;
                text-transform: none !important;
                letter-spacing: normal !important;
                font-family: inherit !important;
                overflow: hidden;
              ">
                <div style="background: #000000; padding: 15px; position: relative;">
                  <div style="color: #50c878; font-weight: 600; margin-bottom: 10px;">How Completion Date Works:</div>
                <div style="color: #b0b0b0; line-height: 1.6;">
                  <strong>Formula:</strong><br>
                  <span style="color: white;">Days to Goal = Points Needed √∑ Daily Average</span><br>
                  <span style="color: white;">Completion Date = Today + Days to Goal</span>
                  <br><br>
                  <strong style="color: white;">Example:</strong><br>
                  Need: 2100 points<br>
                  Daily Avg: 30 pts/day<br>
                  Days to Goal: 2100 √∑ 30 = 70 days<br>
                  <span style="color: #50c878;">Completion: Today + 70 days</span>
                  <br><br>
                  <em>Shows when you'll reach your goal at current pace.</em>
                </div>
                </div>
              </div>
            </div>
            <div class="stat-value" id="completionDate" style="font-size: 2.7em;">--</div>
          </div>
        </div>
      </div>

        <!-- Add Match Results Section -->
        <div class="match-results-section scroll-reveal">
        <h2>Add Match Results</h2>
        <div class="quick-actions">
          <button class="quick-action-btn win" onclick="quickAddPoints(25)">
            <span class="quick-action-icon">üèÜ</span>
            <span class="quick-action-label">Win</span>
            <span class="quick-action-points">+25</span>
          </button>
          <button class="quick-action-btn third" onclick="quickAddPoints(14)">
            <span class="quick-action-icon">ü•â</span>
            <span class="quick-action-label">Lose Final</span>
            <span class="quick-action-points">+14</span>
          </button>
          <button class="quick-action-btn qualified" onclick="quickAddPoints(6)">
            <span class="quick-action-icon">‚úÖ</span>
            <span class="quick-action-label">Round 2 KO</span>
            <span class="quick-action-points">+6</span>
          </button>
          <button class="quick-action-btn eliminated" onclick="quickAddPoints(2)">
            <span class="quick-action-icon">‚ùå</span>
            <span class="quick-action-label">Round 1 KO</span>
            <span class="quick-action-points">+2</span>
          </button>
          <button id="undoButton" class="quick-action-btn undo" onclick="undoLastAdd()">
            <span class="quick-action-icon">‚Ü©Ô∏è</span>
            <span class="quick-action-label">Undo</span>
            <span class="quick-action-points" id="undoPoints">-0</span>
          </button>
        </div>
        </div>

        <!-- Progress Section -->
        <div class="progress-section scroll-reveal">
        <h2 id="progressTitle">Progress to Goal</h2>
        <div class="progress-container">
          <div id="progressBar" class="progress-bar" style="width: 0%"></div>
          <div id="progressText" class="progress-text">0%</div>
          <div class="progress-milestones" id="progressMilestones">
            <!-- Milestone markers will be added dynamically -->
          </div>
        </div>
        <div class="pace-indicator" id="paceIndicator">Calculating pace...</div>
        </div>

        <!-- Rank Ladder -->
        <div class="rank-ladder">
          <h2>Rank Progression</h2>
          <div id="rankLadder"></div>
        </div>

        <!-- Daily Entries -->
        <div class="daily-entries-section">
        <h2 style="margin-bottom: 20px; background: linear-gradient(135deg, #50c878, #20b2aa); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
          Daily Progress Log
        </h2>
        <div class="entry-form">
          <input type="date" id="dateInput" class="entry-input" />
          <input type="number" id="pointsInput" class="entry-input" placeholder="Points" />
          <input type="text" id="notesInput" class="entry-input" placeholder="Notes (optional)" />
          <button class="add-entry-btn" onclick="addDailyEntry()">Add Entry</button>
        </div>
        <div class="entries-list" id="entriesList"></div>

        <!-- Performance Graph Section -->
        <div class="graph-section" style="margin-top: 30px;">
          <button class="graph-toggle-btn" onclick="toggleGraph()" style="
            width: 100%;
            background: linear-gradient(135deg, rgba(80, 200, 120, 0.1), rgba(32, 178, 170, 0.1));
            border: 1px solid rgba(80, 200, 120, 0.3);
            color: #50c878;
            padding: 15px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s ease;
          ">
            <span id="graphToggleIcon">üìä</span>
            <span id="graphToggleText">Show Performance Graph</span>
            <span id="graphToggleArrow" style="margin-left: auto;">‚ñº</span>
          </button>

          <div id="graphContainer" style="
            display: none;
            margin-top: 20px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
          ">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
              <h3 style="
                background: linear-gradient(135deg, #50c878, #20b2aa);
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                margin: 0;
              ">Daily Performance Trend</h3>
              <select id="graphTimeRange" onchange="updateGraph()" style="
                background: rgba(255, 255, 255, 0.05);
                border: 1px solid rgba(255, 255, 255, 0.2);
                color: #ffffff;
                padding: 8px 12px;
                border-radius: 8px;
                cursor: pointer;
              ">
                <option value="7">Last 7 days</option>
                <option value="14">Last 14 days</option>
                <option value="30" selected>Last 30 days</option>
                <option value="all">All time</option>
              </select>
            </div>
            <canvas id="performanceChart" width="400" height="200"></canvas>
            <div id="graphStats" style="
              display: grid;
              grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
              gap: 15px;
              margin-top: 20px;
            ">
              <div class="graph-stat-card" style="
                background: rgba(80, 200, 120, 0.1);
                padding: 12px;
                border-radius: 8px;
                border: 1px solid rgba(80, 200, 120, 0.2);
              ">
                <div style="color: #888; font-size: 0.9em;">Average Daily</div>
                <div id="avgDaily" style="color: #50c878; font-size: 1.5em; font-weight: bold;">0</div>
              </div>
              <div class="graph-stat-card" style="
                background: rgba(32, 178, 170, 0.1);
                padding: 12px;
                border-radius: 8px;
                border: 1px solid rgba(32, 178, 170, 0.2);
              ">
                <div style="color: #888; font-size: 0.9em;">Best Day</div>
                <div id="bestDay" style="color: #20b2aa; font-size: 1.5em; font-weight: bold;">0</div>
              </div>
              <div class="graph-stat-card" style="
                background: rgba(255, 199, 0, 0.1);
                padding: 12px;
                border-radius: 8px;
                border: 1px solid rgba(255, 199, 0, 0.2);
              ">
                <div style="color: #888; font-size: 0.9em;">Current Streak</div>
                <div id="currentStreak" style="color: #ffc700; font-size: 1.5em; font-weight: bold;">0 days</div>
              </div>
              <div class="graph-stat-card" style="
                background: rgba(138, 43, 226, 0.1);
                padding: 12px;
                border-radius: 8px;
                border: 1px solid rgba(138, 43, 226, 0.2);
              ">
                <div style="color: #888; font-size: 0.9em;">Total Points</div>
                <div id="totalGraphPoints" style="color: #8a2be2; font-size: 1.5em; font-weight: bold;">0</div>
              </div>
            </div>
          </div>
        </div>

        </div>
    </div>

    <!-- Last Updated Indicator -->
    <div class="last-updated" id="lastUpdated">
      Last updated: just now
    </div>

    <!-- Notification -->
    <div id="notification" class="notification"></div>

    <script>
      // Season 8 Configuration
      const STORAGE_VERSION = 'v8.0';
      const SEASON_START_DATE = '2025-09-11';
      const SEASON_END_DATE = '2025-12-11';
      const SEASON_DAYS = 91;

      // Season 8 Ranks
      const ranks = [
        { name: "Bronze IV", points: 25, icon: "B4", color: "#CD7F32", tier: "bronze" },
        { name: "Bronze III", points: 50, icon: "B3", color: "#CD7F32", tier: "bronze" },
        { name: "Bronze II", points: 75, icon: "B2", color: "#CD7F32", tier: "bronze" },
        { name: "Bronze I", points: 100, icon: "B1", color: "#CD7F32", tier: "bronze" },
        { name: "Silver IV", points: 150, icon: "S4", color: "#C0C0C0", tier: "silver" },
        { name: "Silver III", points: 200, icon: "S3", color: "#C0C0C0", tier: "silver" },
        { name: "Silver II", points: 250, icon: "S2", color: "#C0C0C0", tier: "silver" },
        { name: "Silver I", points: 300, icon: "S1", color: "#C0C0C0", tier: "silver" },
        { name: "Gold IV", points: 375, icon: "G4", color: "#FFD700", tier: "gold" },
        { name: "Gold III", points: 450, icon: "G3", color: "#FFD700", tier: "gold" },
        { name: "Gold II", points: 525, icon: "G2", color: "#FFD700", tier: "gold" },
        { name: "Gold I", points: 600, icon: "G1", color: "#FFD700", tier: "gold" },
        { name: "Platinum IV", points: 700, icon: "P4", color: "#E5E4E2", tier: "platinum" },
        { name: "Platinum III", points: 800, icon: "P3", color: "#E5E4E2", tier: "platinum" },
        { name: "Platinum II", points: 900, icon: "P2", color: "#E5E4E2", tier: "platinum" },
        { name: "Platinum I", points: 1000, icon: "P1", color: "#E5E4E2", tier: "platinum" },
        { name: "Diamond IV", points: 1150, icon: "D4", color: "#B9F2FF", tier: "diamond" },
        { name: "Diamond III", points: 1300, icon: "D3", color: "#B9F2FF", tier: "diamond" },
        { name: "Diamond II", points: 1450, icon: "D2", color: "#B9F2FF", tier: "diamond" },
        { name: "Diamond I", points: 1600, icon: "D1", color: "#B9F2FF", tier: "diamond" },
        { name: "Emerald IV", points: 1800, icon: "E4", color: "#50C878", tier: "emerald" },
        { name: "Emerald III", points: 2000, icon: "E3", color: "#50C878", tier: "emerald" },
        { name: "Emerald II", points: 2200, icon: "E2", color: "#50C878", tier: "emerald" },
        { name: "Emerald I", points: 2400, icon: "E1", color: "#50C878", tier: "emerald" }
      ];

      // Storage Management with Versioning
      class StorageManager {
        constructor() {
          this.cache = {};
          this.cacheTimestamps = {};
          this.CACHE_TTL = 5 * 60 * 1000; // 5 minutes
          this.initializeStorage();
        }

        initializeStorage() {
          try {
            const version = localStorage.getItem('cacheVersion');
            
            if (version !== STORAGE_VERSION) {
              this.migrateData(version);
            }

            // Initialize with defaults if needed
            this.ensureDefaults();
            
            // Update last visit
            localStorage.setItem('lastVisit', Date.now().toString());
            
          } catch (error) {
            console.error('Storage initialization error:', error);
            this.handleStorageError(error);
          }
        }

        migrateData(oldVersion) {
          if (!oldVersion) {
            // Fresh install
            this.clearStorage();
          } else if (oldVersion === 'v7.0') {
            // Migrate from Season 7
            const shouldMigrate = confirm('Season 7 data detected. Would you like to convert your progress proportionally to Season 8? (Cancel for fresh start)');
            
            if (shouldMigrate) {
              this.migrateFromSeason7();
            } else {
              this.clearStorage();
            }
          }
          
          localStorage.setItem('cacheVersion', STORAGE_VERSION);
        }

        migrateFromSeason7() {
          try {
            const oldPoints = parseInt(localStorage.getItem('currentPoints') || '0');
            // Proportional conversion: S7 max was 2400, S8 max is 2400
            const conversionRatio = 2400 / 2400;
            const newPoints = Math.round(oldPoints * conversionRatio);
            
            localStorage.setItem('currentPoints', newPoints.toString());
            
            // Clear old daily entries as they won't match new point system
            localStorage.removeItem('dailyEntries');
            
            showNotification(`Migrated to Season 8! Your ${oldPoints} points converted to ${newPoints} points.`, 'success');
          } catch (error) {
            console.error('Migration error:', error);
            this.clearStorage();
          }
        }

        ensureDefaults() {
          const defaults = {
            currentPoints: '0',
            selectedGoal: 'Emerald I',
            dailyEntries: '[]',
            undoHistory: '[]',
            seasonStartDate: SEASON_START_DATE,
            seasonEndDate: SEASON_END_DATE,
            cacheVersion: STORAGE_VERSION
          };

          for (const [key, value] of Object.entries(defaults)) {
            if (!localStorage.getItem(key)) {
              localStorage.setItem(key, value);
            }
          }
        }

        get(key, defaultValue = null) {
          try {
            // Check cache first
            if (this.cache[key] && this.cacheTimestamps[key]) {
              const age = Date.now() - this.cacheTimestamps[key];
              if (age < this.CACHE_TTL) {
                return this.cache[key];
              }
            }

            const value = localStorage.getItem(key);
            if (value === null) return defaultValue;

            // Try to parse JSON
            try {
              const parsed = JSON.parse(value);
              this.cache[key] = parsed;
              this.cacheTimestamps[key] = Date.now();
              return parsed;
            } catch {
              return value;
            }
          } catch (error) {
            console.error(`Error getting ${key}:`, error);
            return defaultValue;
          }
        }

        set(key, value) {
          try {
            const stringValue = typeof value === 'string' ? value : JSON.stringify(value);
            
            // Compress large data
            if (key === 'dailyEntries' && stringValue.length > 10000) {
              this.compressEntries();
            }
            
            localStorage.setItem(key, stringValue);
            this.cache[key] = value;
            this.cacheTimestamps[key] = Date.now();
            
            // Update last updated time
            this.updateLastUpdated();
            
            return true;
          } catch (error) {
            if (error.name === 'QuotaExceededError') {
              this.handleQuotaExceeded();
            }
            console.error(`Error setting ${key}:`, error);
            return false;
          }
        }

        compressEntries() {
          const entries = this.get('dailyEntries', []);
          if (entries.length > 50) {
            // Keep only last 50 entries
            const compressed = entries.slice(-50);
            localStorage.setItem('dailyEntries', JSON.stringify(compressed));
            showNotification('Compressed old entries to save space', 'info');
          }
        }

        handleQuotaExceeded() {
          // Clear old data
          const entries = this.get('dailyEntries', []);
          if (entries.length > 10) {
            const recent = entries.slice(-10);
            this.set('dailyEntries', recent);
            showNotification('Cleared old entries due to storage limit', 'info');
          }
        }

        handleStorageError(error) {
          console.error('Storage error:', error);
          if (confirm('Storage error detected. Reset data?')) {
            this.clearStorage();
            location.reload();
          }
        }

        clearStorage() {
          const keysToKeep = ['cacheVersion'];
          const allKeys = Object.keys(localStorage);
          
          allKeys.forEach(key => {
            if (!keysToKeep.includes(key)) {
              localStorage.removeItem(key);
            }
          });
          
          this.cache = {};
          this.cacheTimestamps = {};
        }

        updateLastUpdated() {
          const now = Date.now();
          const lastVisit = parseInt(localStorage.getItem('lastVisit') || '0');
          const diff = now - lastVisit;
          
          let text = 'Last updated: ';
          if (diff < 60000) {
            text += 'just now';
          } else if (diff < 3600000) {
            text += `${Math.floor(diff / 60000)} minutes ago`;
          } else if (diff < 86400000) {
            text += `${Math.floor(diff / 3600000)} hours ago`;
          } else {
            text += `${Math.floor(diff / 86400000)} days ago`;
          }
          
          const element = document.getElementById('lastUpdated');
          if (element) {
            element.textContent = text;
          }
        }
      }

      // Initialize storage manager
      const storage = new StorageManager();

      // Global state
      let currentPoints = 0;
      let selectedGoal = 'Emerald I';
      let dailyEntries = [];
      let undoHistory = [];
      let daysRemaining = 0;
      let isUpdating = false;

      // Debounce function
      function debounce(func, wait) {
        let timeout;
        return function executedFunction(...args) {
          const later = () => {
            clearTimeout(timeout);
            func(...args);
          };
          clearTimeout(timeout);
          timeout = setTimeout(later, wait);
        };
      }

      // Graph functionality
      let performanceChart = null;
      let graphVisible = false;

      function toggleGraph() {
        const container = document.getElementById('graphContainer');
        const toggleText = document.getElementById('graphToggleText');
        const toggleArrow = document.getElementById('graphToggleArrow');
        const toggleBtn = document.querySelector('.graph-toggle-btn');

        graphVisible = !graphVisible;

        if (graphVisible) {
          container.style.display = 'block';
          toggleText.textContent = 'Hide Performance Graph';
          toggleArrow.textContent = '‚ñ≤';
          toggleBtn.style.background = 'linear-gradient(135deg, rgba(80, 200, 120, 0.2), rgba(32, 178, 170, 0.2))';
          updateGraph();
        } else {
          container.style.display = 'none';
          toggleText.textContent = 'Show Performance Graph';
          toggleArrow.textContent = '‚ñº';
          toggleBtn.style.background = 'linear-gradient(135deg, rgba(80, 200, 120, 0.1), rgba(32, 178, 170, 0.1))';
        }
      }

      function updateGraph() {
        const timeRange = document.getElementById('graphTimeRange').value;
        const entries = JSON.parse(localStorage.getItem('dailyEntries') || '[]');

        if (entries.length === 0) {
          const container = document.getElementById('graphContainer');
          const statsHtml = container.querySelector('#graphStats').outerHTML;
          container.innerHTML = '<div style="text-align: center; color: #666; padding: 40px;">No data to display yet. Add some daily entries to see your performance graph!</div>' + statsHtml;
          return;
        }

        // Sort entries by date
        entries.sort((a, b) => new Date(a.date) - new Date(b.date));

        // Filter based on time range
        let filteredEntries = entries;
        if (timeRange !== 'all') {
          const days = parseInt(timeRange);
          const cutoffDate = new Date();
          cutoffDate.setDate(cutoffDate.getDate() - days);
          filteredEntries = entries.filter(e => new Date(e.date) >= cutoffDate);
        }

        // Prepare data for chart
        const labels = filteredEntries.map(e => {
          const date = new Date(e.date);
          return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
        });
        const data = filteredEntries.map(e => e.points);

        // Calculate stats
        const avgDaily = Math.round(data.reduce((a, b) => a + b, 0) / data.length);
        const bestDay = Math.max(...data);
        const totalPoints = data.reduce((a, b) => a + b, 0);

        // Calculate streak
        let streak = 0;
        const today = new Date().toISOString().split('T')[0];
        for (let i = entries.length - 1; i >= 0; i--) {
          const entryDate = new Date(entries[i].date);
          const expectedDate = new Date();
          expectedDate.setDate(expectedDate.getDate() - streak);

          if (entryDate.toISOString().split('T')[0] === expectedDate.toISOString().split('T')[0]) {
            streak++;
          } else {
            break;
          }
        }

        // Update stats
        document.getElementById('avgDaily').textContent = avgDaily + ' pts';
        document.getElementById('bestDay').textContent = bestDay + ' pts';
        document.getElementById('currentStreak').textContent = streak + (streak === 1 ? ' day' : ' days');
        document.getElementById('totalGraphPoints').textContent = totalPoints.toLocaleString();

        // Create or update chart
        const ctx = document.getElementById('performanceChart').getContext('2d');

        if (performanceChart) {
          performanceChart.destroy();
        }

        // Calculate daily goal line
        const goalPoints = parseInt(localStorage.getItem('requiredPointsPerDay') || '0');
        const goalLine = new Array(labels.length).fill(goalPoints);

        performanceChart = new Chart(ctx, {
          type: 'line',
          data: {
            labels: labels,
            datasets: [{
              label: 'Daily Points',
              data: data,
              borderColor: '#50c878',
              backgroundColor: 'rgba(80, 200, 120, 0.1)',
              borderWidth: 3,
              pointBackgroundColor: '#50c878',
              pointBorderColor: '#fff',
              pointBorderWidth: 2,
              pointRadius: 5,
              pointHoverRadius: 7,
              tension: 0.3
            },
            {
              label: 'Daily Goal',
              data: goalLine,
              borderColor: 'rgba(255, 199, 0, 0.5)',
              backgroundColor: 'transparent',
              borderWidth: 2,
              borderDash: [5, 5],
              pointRadius: 0,
              pointHoverRadius: 0
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            interaction: {
              mode: 'index',
              intersect: false
            },
            plugins: {
              legend: {
                display: true,
                labels: {
                  color: '#888',
                  font: {
                    size: 12
                  }
                }
              },
              tooltip: {
                backgroundColor: 'rgba(0, 0, 0, 0.8)',
                titleColor: '#fff',
                bodyColor: '#fff',
                borderColor: '#50c878',
                borderWidth: 1,
                displayColors: true,
                callbacks: {
                  label: function(context) {
                    if (context.dataset.label === 'Daily Points') {
                      return context.dataset.label + ': ' + context.parsed.y + ' points';
                    }
                    return context.dataset.label + ': ' + context.parsed.y + ' points';
                  }
                }
              }
            },
            scales: {
              x: {
                grid: {
                  color: 'rgba(255, 255, 255, 0.05)',
                  drawBorder: false
                },
                ticks: {
                  color: '#888',
                  maxRotation: 45,
                  minRotation: 0
                }
              },
              y: {
                beginAtZero: true,
                grid: {
                  color: 'rgba(255, 255, 255, 0.05)',
                  drawBorder: false
                },
                ticks: {
                  color: '#888',
                  callback: function(value) {
                    return value + ' pts';
                  }
                }
              }
            }
          }
        });
      }

      // Initialize on load
      document.addEventListener('DOMContentLoaded', () => {
        // Scroll Reveal Animation
        const observerOptions = {
          threshold: 0.1,
          rootMargin: '0px 0px -50px 0px'
        };

        const scrollObserver = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              entry.target.classList.add('revealed');
            }
          });
        }, observerOptions);

        // Observe all elements with scroll-reveal class
        setTimeout(() => {
          document.querySelectorAll('.scroll-reveal').forEach(el => {
            scrollObserver.observe(el);
          });
        }, 100);
        initializeApp();
        checkFirstTimeUser();
        addInteractiveHighlights();

        // Add tooltip hover functionality for all tooltips
        const tooltipIcons = document.querySelectorAll('.tooltip-icon');

        tooltipIcons.forEach(icon => {
          const tooltipContent = icon.nextElementSibling;

          if (tooltipContent && tooltipContent.classList.contains('tooltip-content')) {
            // Store original parent for restoration
            const originalParent = tooltipContent.parentElement;

            icon.addEventListener('mouseenter', () => {
              // Hide all other tooltips first
              document.querySelectorAll('.tooltip-content').forEach(t => {
                if (t !== tooltipContent) t.style.display = 'none';
              });

              // Special handling for tooltips - move to body to escape parent stacking contexts
              if (tooltipContent.dataset.tooltipType === 'completion' || tooltipContent.dataset.tooltipType === 'projected') {
                // Move tooltip to body to escape all parent stacking contexts
                document.body.appendChild(tooltipContent);

                // Position it near the icon with responsive positioning
                const rect = icon.getBoundingClientRect();
                const viewportWidth = window.innerWidth;
                const tooltipWidth = 280;

                tooltipContent.style.position = 'fixed';

                // Horizontal positioning - keep on screen
                let leftPos = rect.left + rect.width/2 - tooltipWidth/2;
                if (leftPos < 10) leftPos = 10;
                if (leftPos + tooltipWidth > viewportWidth - 10) {
                  leftPos = viewportWidth - tooltipWidth - 10;
                }
                tooltipContent.style.left = leftPos + 'px';

                // Always show below the icon for both tooltips
                tooltipContent.style.top = (rect.bottom + 10) + 'px';
                tooltipContent.style.bottom = 'auto';

                // Check if tooltip would go off bottom of screen
                const spaceBelow = window.innerHeight - rect.bottom;
                if (spaceBelow < 350) {
                  // If not enough space below, show above
                  tooltipContent.style.top = 'auto';
                  tooltipContent.style.bottom = (window.innerHeight - rect.top + 10) + 'px';
                }

                tooltipContent.style.transform = 'none';
              }

              tooltipContent.style.display = 'block';
              tooltipContent.style.pointerEvents = 'none';

              // Force solid background
              tooltipContent.style.background = 'rgb(0, 0, 0)';
              tooltipContent.style.backgroundColor = 'rgb(0, 0, 0)';
              tooltipContent.style.opacity = '1';
              tooltipContent.style.zIndex = '999999';

              // Remove any filters
              tooltipContent.style.backdropFilter = 'none';
              tooltipContent.style.filter = 'none';
              tooltipContent.style.mixBlendMode = 'normal';
              tooltipContent.style.isolation = 'isolate';
            });

            icon.addEventListener('mouseleave', () => {
              tooltipContent.style.display = 'none';

              // Move tooltip back to original parent when hidden
              if ((tooltipContent.dataset.tooltipType === 'completion' || tooltipContent.dataset.tooltipType === 'projected') && originalParent) {
                originalParent.appendChild(tooltipContent);
                // Reset positioning styles
                tooltipContent.style.position = '';
                tooltipContent.style.left = '';
                tooltipContent.style.top = '';
                tooltipContent.style.bottom = '';
                tooltipContent.style.transform = '';
              }
            });
          }
        });

        // Hide tooltips on click outside
        document.addEventListener('click', (e) => {
          if (!e.target.classList.contains('tooltip-icon')) {
            document.querySelectorAll('.tooltip-content').forEach(t => {
              t.style.display = 'none';
            });
          }
        });
      });

      function initializeApp() {
        // Load saved data
        currentPoints = parseInt(storage.get('currentPoints', 0));
        selectedGoal = storage.get('selectedGoal', 'Emerald I');
        dailyEntries = storage.get('dailyEntries', []);
        undoHistory = storage.get('undoHistory', []);

        // Initialize UI
        initializeGoalSelector();
        initializePointsInput();
        calculateDaysRemaining();
        updateDashboard();
        renderRankLadder();
        renderDailyEntries();

        // Set today's date in entry form
        document.getElementById('dateInput').valueAsDate = new Date();

        // Update last updated indicator every minute
        setInterval(() => storage.updateLastUpdated(), 60000);
      }

      function initializeGoalSelector() {
        const select = document.getElementById('goalSelect');
        select.innerHTML = '';
        
        ranks.forEach(rank => {
          const option = document.createElement('option');
          option.value = rank.name;
          option.textContent = `${rank.name} (${rank.points} points)`;
          if (rank.name === selectedGoal) {
            option.selected = true;
          }
          select.appendChild(option);
        });

        updateGoalDisplay();
      }

      function initializePointsInput() {
        const input = document.getElementById('currentPoints');
        input.value = currentPoints;
        
        // Debounced update
        const debouncedUpdate = debounce((value) => {
          updateCurrentPoints(parseInt(value) || 0);
        }, 500);
        
        input.addEventListener('input', (e) => {
          debouncedUpdate(e.target.value);
        });

        input.addEventListener('focus', () => {
          input.select();
        });
      }

      function updateGoal() {
        const select = document.getElementById('goalSelect');
        selectedGoal = select.value;
        storage.set('selectedGoal', selectedGoal);
        
        updateGoalDisplay();
        updateDashboard();
        
        showNotification(`Goal updated to ${selectedGoal}!`, 'success');
      }

      function updateGoalDisplay() {
        const goalRank = ranks.find(r => r.name === selectedGoal);
        if (!goalRank) return;

        // These elements were removed, so check if they exist first
        const iconEl = document.getElementById('goalIcon');
        const nameEl = document.getElementById('goalName');
        const pointsEl = document.getElementById('goalPoints');

        if (iconEl) {
          iconEl.textContent = goalRank.icon;
          iconEl.className = `goal-rank-icon rank-${goalRank.tier}`;
        }
        if (nameEl) {
          nameEl.textContent = goalRank.name;
        }
        if (pointsEl) {
          pointsEl.textContent = `${goalRank.points} points`;
        }
      }

      function updateCurrentPoints(newPoints) {
        if (isUpdating) return;
        isUpdating = true;

        const oldPoints = currentPoints;
        const goalRank = ranks.find(r => r.name === selectedGoal);
        const maxPoints = goalRank ? goalRank.points : 2400;
        
        newPoints = Math.max(0, Math.min(maxPoints, newPoints));
        currentPoints = newPoints;

        // Update the input field
        const pointsInput = document.getElementById('currentPoints');
        if (pointsInput) {
          pointsInput.value = currentPoints;
        }
        
        storage.set('currentPoints', currentPoints);

        // Check for rank achievements
        checkMilestones(oldPoints, newPoints);

        updateDashboard();
        renderRankLadder();
        
        isUpdating = false;
      }

      function calculateDaysRemaining() {
        const today = new Date();
        const seasonEnd = new Date(SEASON_END_DATE);
        const diffTime = seasonEnd - today;
        daysRemaining = Math.max(0, Math.ceil(diffTime / (1000 * 60 * 60 * 24)));
        return daysRemaining;
      }

      function updateDashboard() {
        const goalRank = ranks.find(r => r.name === selectedGoal);
        const goalPoints = goalRank ? goalRank.points : 2400;
        const pointsNeeded = Math.max(0, goalPoints - currentPoints);
        const pointsPerDay = daysRemaining > 0 ? Math.ceil(pointsNeeded / daysRemaining) : 0;
        
        // Calculate projected completion based on average daily points
        // Season started on 2025-09-11, calculate days elapsed
        const seasonStart = new Date('2025-09-11');
        const today = new Date();
        const daysElapsed = Math.max(1, Math.ceil((today - seasonStart) / (1000 * 60 * 60 * 24)));
        const avgPointsPerDay = currentPoints / daysElapsed;
        const projectedTotalPoints = currentPoints + (avgPointsPerDay * daysRemaining);
        const completion = Math.round((projectedTotalPoints / goalPoints) * 100);

        // Calculate projected completion date
        let completionDateText = '--';
        let completionDateColor = '#50c878';
        let completionDateSubtext = '';
        const seasonEnd = new Date(SEASON_END_DATE);

        if (avgPointsPerDay > 0) {
          const pointsRemaining = goalPoints - currentPoints;

          // Check if already at or above goal
          if (pointsRemaining <= 0) {
            completionDateText = '‚úÖ GOAL REACHED!';
            completionDateColor = '#50c878';
          } else {
            const daysToGoal = Math.ceil(pointsRemaining / avgPointsPerDay);
            const completionDate = new Date();
            completionDate.setDate(completionDate.getDate() + daysToGoal);

            // Compare dates properly (set both to midnight for accurate comparison)
            const completionDateMidnight = new Date(completionDate);
            completionDateMidnight.setHours(0, 0, 0, 0);
            const seasonEndMidnight = new Date(seasonEnd);
            seasonEndMidnight.setHours(23, 59, 59, 999); // End of day for season end

            if (completionDateMidnight <= seasonEndMidnight) {
              // Will complete before season ends
              if (daysToGoal === 1) {
                completionDateText = 'Tomorrow';
              } else if (daysToGoal <= 7) {
                completionDateText = `In ${daysToGoal} days`;
              } else {
                completionDateText = completionDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
              }

              // Calculate how many days ahead of schedule
              const daysAhead = daysRemaining - daysToGoal;
              if (daysAhead > 0 && daysToGoal > 0) {
                completionDateSubtext = `${daysAhead} days ahead of schedule`;
                completionDateColor = '#50c878';
              }
            } else {
              // Won't complete at current pace
              completionDateText = `<span style="color: #ff4757;">‚ùå</span> <span style="color: #ff4757;">${completionDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}</span>`;
              completionDateColor = '#ff4757';

              // Calculate how many days past season end
              const daysOverdue = Math.ceil((completionDate - seasonEnd) / (1000 * 60 * 60 * 24));
              completionDateSubtext = `${daysOverdue} days past season end`;
            }
          }
        } else if (currentPoints === 0) {
          completionDateText = 'Start playing!';
          completionDateColor = '#888';
        }

        // Update stats with animation
        animateValue('daysRemaining', daysRemaining);
        animateValue('pointsPerDay', pointsPerDay);
        animateValue('completion', completion + '%');

        // Update completion date
        const completionDateEl = document.getElementById('completionDate');
        if (completionDateEl) {
          completionDateEl.innerHTML = completionDateText;
          completionDateEl.style.color = completionDateColor;
        }

        // Add completion date subtext
        const completionDateCard = completionDateEl?.closest('.stat-card');
        if (completionDateCard) {
          let subtextEl = completionDateCard.querySelector('.completion-date-subtext');
          if (!subtextEl && completionDateSubtext) {
            subtextEl = document.createElement('div');
            subtextEl.className = 'completion-date-subtext';
            subtextEl.style.fontSize = '0.9em';
            subtextEl.style.marginTop = '5px';
            completionDateCard.appendChild(subtextEl);
          }
          if (subtextEl) {
            subtextEl.textContent = completionDateSubtext;
            subtextEl.style.color = completionDateColor === '#ff4757' ? '#ff4757' : '#888';
          }
        }

        // Update season end date
        const seasonEndDateEl = document.getElementById('seasonEndDate');
        if (seasonEndDateEl) {
          const endDate = new Date(SEASON_END_DATE);
          seasonEndDateEl.textContent = `Season ends ${endDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}`;
        }

        // Update daily goal status
        const dailyGoalStatusEl = document.getElementById('dailyGoalStatus');
        if (dailyGoalStatusEl) {
          // Check if user has achieved daily goal today
          const today = new Date().toISOString().split('T')[0];
          const todayEntry = dailyEntries.find(e => e.date === today);

          if (todayEntry && todayEntry.points >= pointsPerDay) {
            dailyGoalStatusEl.textContent = 'Goal achieved for today! ‚úÖ';
            dailyGoalStatusEl.style.color = '#50c878';
          } else if (todayEntry && todayEntry.points > 0) {
            const remaining = pointsPerDay - todayEntry.points;
            dailyGoalStatusEl.textContent = `${remaining} more points needed today`;
            dailyGoalStatusEl.style.color = '#ffc107';
          } else if (pointsPerDay > 0) {
            dailyGoalStatusEl.textContent = '';
          } else {
            dailyGoalStatusEl.textContent = 'Goal already reached!';
            dailyGoalStatusEl.style.color = '#50c878';
          }
        }

        // Update completion status
        const completionStatusEl = document.getElementById('completionStatus');
        if (completionStatusEl) {
          if (completion >= 100) {
            completionStatusEl.textContent = 'On pace to reach goal! ‚úÖ';
            completionStatusEl.style.color = '#50c878';
          } else if (completion >= 80) {
            completionStatusEl.textContent = 'Slightly behind pace';
            completionStatusEl.style.color = '#ffc107';
          } else if (completion > 0) {
            completionStatusEl.textContent = 'Need to increase pace';
            completionStatusEl.style.color = '#ff4757';
          } else {
            completionStatusEl.textContent = '';
          }
        }

        // Update progress bar
        const progressBar = document.getElementById('progressBar');
        const progressText = document.getElementById('progressText');
        const progressTitle = document.getElementById('progressTitle');
        const progressPercent = Math.min(100, (currentPoints / goalPoints) * 100);

        progressBar.style.width = `${progressPercent}%`;
        progressText.textContent = `${Math.round(progressPercent)}%`;
        progressTitle.textContent = `Progress to ${selectedGoal}`;

        // Update milestone markers
        renderProgressMilestones(goalRank);

        // Check if goal achieved
        if (currentPoints >= goalPoints) {
          progressBar.parentElement.parentElement.classList.add('celebration-mode');
          document.getElementById('paceIndicator').textContent = `üéâ ${selectedGoal} Achieved! Congratulations!`;
          document.getElementById('paceIndicator').className = 'pace-indicator ahead';
        } else {
          progressBar.parentElement.parentElement.classList.remove('celebration-mode');
          updatePaceIndicator();
        }

        // Update next rank
        updateNextRank();

        // Update goal breakdown
        renderGoalBreakdown(pointsPerDay);
      }

      function updatePaceIndicator() {
        const goalRank = ranks.find(r => r.name === selectedGoal);
        const goalPoints = goalRank ? goalRank.points : 2400;

        const seasonStart = new Date(SEASON_START_DATE);
        const today = new Date();
        const seasonEnd = new Date(SEASON_END_DATE);

        const totalDays = Math.ceil((seasonEnd - seasonStart) / (1000 * 60 * 60 * 24));
        const daysElapsed = Math.ceil((today - seasonStart) / (1000 * 60 * 60 * 24));
        const daysRemaining = Math.ceil((seasonEnd - today) / (1000 * 60 * 60 * 24));

        const indicator = document.getElementById('paceIndicator');

        // Check if goal is already achieved
        if (currentPoints >= goalPoints) {
          indicator.textContent = 'üéâ Goal Achieved!';
          indicator.className = 'pace-indicator ahead';
          return;
        }

        // Calculate using same method as completion date for consistency
        const pointsNeeded = goalPoints - currentPoints;
        const avgPointsPerDay = daysElapsed > 0 ? currentPoints / daysElapsed : 0;

        if (avgPointsPerDay === 0) {
          indicator.textContent = '‚ö†Ô∏è Start earning points to see pace';
          indicator.className = 'pace-indicator behind';
          return;
        }

        const daysToGoal = Math.ceil(pointsNeeded / avgPointsPerDay);
        const daysAheadOrBehind = daysRemaining - daysToGoal;

        if (Math.abs(daysAheadOrBehind) <= 2) {
          indicator.textContent = '‚úÖ On track to reach goal';
          indicator.className = 'pace-indicator on-track';
        } else if (daysAheadOrBehind > 0) {
          indicator.textContent = `üöÄ ${daysAheadOrBehind} days ahead of schedule`;
          indicator.className = 'pace-indicator ahead';
        } else {
          // Calculate extra percentage needed per day
          const requiredDailyPoints = pointsNeeded / daysRemaining;
          const currentDailyRate = avgPointsPerDay;
          const extraPercentNeeded = Math.round(((requiredDailyPoints - currentDailyRate) / currentDailyRate) * 100);

          if (extraPercentNeeded > 0 && extraPercentNeeded < 500) {
            indicator.textContent = `‚ö†Ô∏è Behind schedule - need ${extraPercentNeeded}% more points per day`;
          } else {
            indicator.textContent = `‚ö†Ô∏è ${Math.abs(daysAheadOrBehind)} days behind schedule`;
          }
          indicator.className = 'pace-indicator behind';
        }
      }

      function updateNextRank() {
        let nextRank = null;
        for (const rank of ranks) {
          if (rank.points > currentPoints) {
            nextRank = rank;
            break;
          }
        }

        const pointsEl = document.querySelector('.next-rank-points');
        const nameEl = document.querySelector('.next-rank-name');
        
        if (nextRank) {
          pointsEl.textContent = nextRank.points - currentPoints;
          nameEl.textContent = nextRank.name;
        } else {
          pointsEl.textContent = '0';
          nameEl.textContent = 'Max Rank!';
        }
      }

      function renderGoalBreakdown(dailyPoints) {
        const breakdown = document.getElementById('goalBreakdown');
        
        if (dailyPoints <= 0) {
          breakdown.innerHTML = '<div style="color: #50c878; font-size: 0.9em;">Goal achieved!</div>';
          return;
        }

        // Calculate realistic scenarios with Season 8 points
        const scenarios = [
          { wins: Math.ceil(dailyPoints / 25), type: 'wins' },
          { loseFinal: Math.ceil(dailyPoints / 14), type: 'loseFinal' },
          { round2: Math.ceil(dailyPoints / 6), type: 'round2' },
          { round1: Math.ceil(dailyPoints / 2), type: 'round1' }
        ];

        let html = '<div style="font-size: 0.8em; margin-top: 10px; color: #b0b0b0;">Hit ANY of these:</div>';
        html += '<div style="display: grid; gap: 3px; margin-top: 5px;">';

        let addedCount = 0;
        scenarios.forEach(scenario => {
          if (scenario[Object.keys(scenario)[0]] <= 10) {
            const label = scenario.type === 'wins' ? 'üèÜ Wins' :
                         scenario.type === 'loseFinal' ? 'ü•â Lose Final' :
                         scenario.type === 'round2' ? '‚úÖ Round 2 KO' :
                         '‚ùå Round 1 KO';
            if (addedCount > 0) {
              html += `<div style="font-size: 0.7em; color: #666; text-align: center; margin: -2px 0;">‚Äî OR ‚Äî</div>`;
            }
            html += `<div style="font-size: 0.9em;">${scenario[Object.keys(scenario)[0]]} ${label}</div>`;
            addedCount++;
          }
        });

        html += '</div>';
        breakdown.innerHTML = html;
      }

      function renderProgressMilestones(goalRank) {
        const milestonesContainer = document.getElementById('progressMilestones');
        if (!milestonesContainer || !goalRank) return;

        // Clear existing milestones
        milestonesContainer.innerHTML = '';

        // Define tier milestones (first rank of each tier)
        const tierMilestones = [
          { name: 'Bronze I', points: 100, tier: 'bronze', icon: 'B1' },
          { name: 'Silver I', points: 300, tier: 'silver', icon: 'S1' },
          { name: 'Gold I', points: 600, tier: 'gold', icon: 'G1' },
          { name: 'Platinum I', points: 1000, tier: 'platinum', icon: 'P1' },
          { name: 'Diamond I', points: 1450, tier: 'diamond', icon: 'D1' },
          { name: 'Emerald I', points: 2100, tier: 'emerald', icon: 'E1' }
        ];

        // Filter milestones up to the goal
        const relevantMilestones = tierMilestones.filter(m => m.points <= goalRank.points);

        // Add milestones
        relevantMilestones.forEach(milestone => {
          const markerDiv = document.createElement('div');
          markerDiv.className = 'milestone-marker';

          // Calculate position percentage
          const position = (milestone.points / goalRank.points) * 100;
          markerDiv.style.left = `${position}%`;

          // Create dot
          const dot = document.createElement('div');
          dot.className = 'milestone-dot';
          if (currentPoints >= milestone.points) {
            dot.classList.add('achieved');
          }

          // Create label
          const label = document.createElement('div');
          label.className = 'milestone-label';
          if (currentPoints >= milestone.points) {
            label.classList.add('achieved');
          }
          label.textContent = milestone.icon;

          markerDiv.appendChild(dot);
          markerDiv.appendChild(label);
          milestonesContainer.appendChild(markerDiv);
        });

        // Add the goal milestone if it's not already included
        const goalTier = goalRank.tier.charAt(0).toUpperCase() + goalRank.tier.slice(1);
        const goalNumber = goalRank.name.split(' ')[1];
        const isGoalAlreadyIncluded = relevantMilestones.some(m => m.points === goalRank.points);

        if (!isGoalAlreadyIncluded) {
          const markerDiv = document.createElement('div');
          markerDiv.className = 'milestone-marker';
          markerDiv.style.left = '100%';

          const dot = document.createElement('div');
          dot.className = 'milestone-dot';
          if (currentPoints >= goalRank.points) {
            dot.classList.add('achieved');
          }

          const label = document.createElement('div');
          label.className = 'milestone-label';
          if (currentPoints >= goalRank.points) {
            label.classList.add('achieved');
          }
          label.textContent = goalRank.icon.substring(0, 2);

          markerDiv.appendChild(dot);
          markerDiv.appendChild(label);
          milestonesContainer.appendChild(markerDiv);
        }
      }

      function renderRankLadder() {
        const ladder = document.getElementById('rankLadder');
        const fragment = document.createDocumentFragment();

        // Use requestAnimationFrame for smooth rendering
        requestAnimationFrame(() => {
          ladder.innerHTML = '';

          ranks.forEach((rank, index) => {
            const isCompleted = currentPoints >= rank.points;
            const isCurrent = !isCompleted && (index === 0 || currentPoints >= ranks[index - 1].points);

            const rankItem = document.createElement('div');
            rankItem.className = `rank-item ${isCompleted ? 'completed' : ''} ${isCurrent ? 'current' : ''}`;
            rankItem.style.animationDelay = `${index * 0.05}s`;

            // Content wrapper
            const content = document.createElement('div');
            content.className = 'rank-item-content';

            // Rank icon
            const icon = document.createElement('div');
            icon.className = `rank-icon rank-${rank.tier}`;
            icon.textContent = rank.icon;
            icon.style.fontSize = '1.5em';
            icon.style.width = '40px';
            icon.style.height = '40px';
            icon.style.display = 'flex';
            icon.style.alignItems = 'center';
            icon.style.justifyContent = 'center';
            icon.style.borderRadius = '50%';
            icon.style.background = rank.tier === 'bronze' ? 'linear-gradient(135deg, #CD7F32, #8B4513)' :
                                    rank.tier === 'silver' ? 'linear-gradient(135deg, #C0C0C0, #808080)' :
                                    rank.tier === 'gold' ? 'linear-gradient(135deg, #FFD700, #FFA500)' :
                                    rank.tier === 'platinum' ? 'linear-gradient(135deg, #E5E4E2, #B8B8B8)' :
                                    rank.tier === 'diamond' ? 'linear-gradient(135deg, #00CED1, #00BFFF)' :
                                    'linear-gradient(135deg, #50c878, #20b2aa)';

            // Rank details
            const details = document.createElement('div');
            details.style.flex = '1';
            details.innerHTML = `
              <div style="font-weight: 600; color: ${isCompleted ? '#50c878' : isCurrent ? '#fff' : '#b0b0b0'};">
                ${rank.name}
              </div>
              <div style="font-size: 0.85em; color: #666;">
                ${rank.points} pts
              </div>
            `;

            content.appendChild(icon);
            content.appendChild(details);

            // Status indicator
            const status = document.createElement('div');
            status.className = `rank-status ${isCompleted ? 'completed' : ''}`;
            if (isCompleted) {
              status.innerHTML = '‚úì';
            } else {
              status.style.background = 'transparent';
            }

            rankItem.appendChild(content);
            rankItem.appendChild(status);

            // Highlight current rank
            if (isCurrent) {
              rankItem.style.border = '2px solid #50c878';
              rankItem.style.background = 'rgba(80, 200, 120, 0.1)';
            } else if (isCompleted) {
              rankItem.style.border = '2px solid rgba(80, 200, 120, 0.5)';
            }

            fragment.appendChild(rankItem);
          });

          ladder.appendChild(fragment);
        });
      }

      function quickAddPoints(points) {
        const oldPoints = currentPoints;
        
        // Add to undo history (max 5 items)
        undoHistory.push({
          points: points,
          timestamp: Date.now(),
          oldTotal: oldPoints
        });
        
        if (undoHistory.length > 5) {
          undoHistory.shift();
        }
        
        storage.set('undoHistory', undoHistory);
        updateUndoButton();
        
        updateCurrentPoints(currentPoints + points);
        
        // Add to daily entries
        const today = new Date().toISOString().split('T')[0];
        const existingEntry = dailyEntries.find(e => e.date === today);
        
        if (existingEntry) {
          existingEntry.points += points;
          existingEntry.total = currentPoints;
        } else {
          dailyEntries.push({
            date: today,
            points: points,
            total: currentPoints,
            notes: `Quick add: +${points}`
          });
        }
        
        storage.set('dailyEntries', dailyEntries);
        renderDailyEntries();
        
        showNotification(`+${points} points added! Total: ${currentPoints}`, 'success');
      }

      function undoLastAdd() {
        if (undoHistory.length === 0) {
          showNotification('No actions to undo', 'error');
          return;
        }
        
        const lastAction = undoHistory.pop();
        storage.set('undoHistory', undoHistory);
        
        updateCurrentPoints(lastAction.oldTotal);
        updateUndoButton();
        
        // Remove from daily entries if it was today
        const today = new Date().toISOString().split('T')[0];
        const todayEntry = dailyEntries.find(e => e.date === today);
        if (todayEntry) {
          todayEntry.points -= lastAction.points;
          if (todayEntry.points <= 0) {
            dailyEntries = dailyEntries.filter(e => e.date !== today);
          }
        }
        
        storage.set('dailyEntries', dailyEntries);
        renderDailyEntries();
        
        showNotification(`Undid +${lastAction.points} points`, 'success');
      }

      function updateUndoButton() {
        const button = document.getElementById('undoButton');
        const pointsSpan = document.getElementById('undoPoints');
        
        if (undoHistory.length > 0) {
          const lastAction = undoHistory[undoHistory.length - 1];
          pointsSpan.textContent = `-${lastAction.points}`;
          button.style.opacity = '1';
        } else {
          pointsSpan.textContent = '-0';
          button.style.opacity = '0.5';
        }
      }

      function addDailyEntry() {
        const date = document.getElementById('dateInput').value;
        const points = parseInt(document.getElementById('pointsInput').value) || 0;
        const notes = document.getElementById('notesInput').value.trim();
        
        if (!date || points === 0) {
          showNotification('Please enter date and points', 'error');
          return;
        }
        
        const existingIndex = dailyEntries.findIndex(e => e.date === date);
        
        if (existingIndex >= 0) {
          dailyEntries[existingIndex].points += points;
          dailyEntries[existingIndex].total = currentPoints + points;
          if (notes) {
            dailyEntries[existingIndex].notes = notes;
          }
        } else {
          dailyEntries.push({
            date: date,
            points: points,
            total: currentPoints + points,
            notes: notes
          });
        }
        
        // Sort by date
        dailyEntries.sort((a, b) => new Date(a.date) - new Date(b.date));
        
        storage.set('dailyEntries', dailyEntries);
        updateCurrentPoints(currentPoints + points);
        
        // Clear form
        document.getElementById('pointsInput').value = '';
        document.getElementById('notesInput').value = '';
        
        renderDailyEntries();
        showNotification(`Entry added: +${points} points`, 'success');
      }

      function renderDailyEntries() {
        const list = document.getElementById('entriesList');
        list.innerHTML = '';

        if (dailyEntries.length === 0) {
          list.innerHTML = '<div style="text-align: center; color: #666; padding: 20px;">No entries yet. Start tracking your progress!</div>';
          return;
        }

        // Show last 10 entries
        const recent = dailyEntries.slice(-10).reverse();

        recent.forEach(entry => {
          const item = document.createElement('div');
          item.className = 'entry-item';

          const dateEl = document.createElement('div');
          dateEl.textContent = new Date(entry.date).toLocaleDateString();

          const pointsEl = document.createElement('div');
          pointsEl.className = 'entry-points';
          pointsEl.innerHTML = `<span style="color: #50c878; font-weight: 600;">+${entry.points}</span> <span style="color: #666; font-size: 0.85em;">today</span>`;
          pointsEl.title = 'Total points earned on this day';

          const notesEl = document.createElement('div');
          notesEl.textContent = entry.notes || '';
          notesEl.style.color = '#888';
          notesEl.style.fontSize = '0.85em';

          const totalEl = document.createElement('div');
          totalEl.innerHTML = `<span style="color: #666; font-size: 0.85em;">Running total:</span> <span style="color: #50c878; font-weight: 600;">${entry.total}</span>`;
          totalEl.style.textAlign = 'right';
          totalEl.title = 'Your total points after this day';

          item.appendChild(dateEl);
          item.appendChild(pointsEl);
          if (entry.notes) {
            item.appendChild(notesEl);
          }
          item.appendChild(totalEl);
          
          list.appendChild(item);
        });
      }

      function checkMilestones(oldPoints, newPoints) {
        for (const rank of ranks) {
          if (oldPoints < rank.points && newPoints >= rank.points) {
            showMilestonePopup(rank);
            createConfetti();
            break;
          }
        }
      }

      function showMilestonePopup(rank) {
        const popup = document.createElement('div');
        popup.className = 'milestone-popup';
        
        let message = 'Keep climbing!';
        if (rank.tier === 'bronze') message = 'Bronze achieved! The journey begins!';
        else if (rank.tier === 'silver') message = 'Silver status! Rising through the ranks!';
        else if (rank.tier === 'gold') message = 'Golden player! Impressive progress!';
        else if (rank.tier === 'platinum') message = 'Platinum prestige! Elite territory!';
        else if (rank.tier === 'diamond') message = 'Diamond hands! Near the top!';
        else if (rank.tier === 'emerald') message = 'EMERALD LEGEND! You\'ve made it!';
        
        popup.innerHTML = `
          <div class="milestone-icon">${rank.icon}</div>
          <div class="milestone-title">${rank.name} Unlocked!</div>
          <div class="milestone-message">${message}</div>
          <div style="font-size: 0.9em; opacity: 0.8; margin-bottom: 15px;">
            ${rank.points} points achieved
          </div>
          <button class="milestone-close" onclick="this.parentElement.remove()">Continue</button>
        `;
        
        document.body.appendChild(popup);
        
        setTimeout(() => {
          popup.remove();
        }, 5000);
      }

      function createConfetti() {
        for (let i = 0; i < 50; i++) {
          setTimeout(() => {
            const confetti = document.createElement('div');
            confetti.className = 'confetti';
            confetti.style.left = Math.random() * 100 + '%';
            confetti.style.backgroundColor = ['#50c878', '#20b2aa', '#ffd700', '#ff6b6b', '#4ecdc4'][Math.floor(Math.random() * 5)];
            confetti.style.animationDuration = (Math.random() * 2 + 2) + 's';
            document.body.appendChild(confetti);
            
            setTimeout(() => confetti.remove(), 3000);
          }, i * 30);
        }
      }

      function showNotification(message, type = 'success') {
        const notification = document.getElementById('notification');
        notification.textContent = message;
        notification.className = `notification ${type} show`;
        
        setTimeout(() => {
          notification.classList.remove('show');
        }, 3000);
      }

      function animateValue(elementId, value) {
        const element = document.getElementById(elementId);
        if (!element) return;
        
        const current = element.textContent;
        const isPercentage = typeof value === 'string' && value.includes('%');
        const numericValue = parseFloat(value) || 0;
        const currentNumeric = parseFloat(current) || 0;
        
        if (Math.abs(numericValue - currentNumeric) < 0.1) {
          element.textContent = value;
          return;
        }
        
        const duration = 500;
        const steps = 20;
        const increment = (numericValue - currentNumeric) / steps;
        let step = 0;
        
        const timer = setInterval(() => {
          step++;
          const newValue = currentNumeric + (increment * step);
          
          if (step >= steps) {
            element.textContent = value;
            clearInterval(timer);
          } else {
            element.textContent = isPercentage ? newValue.toFixed(1) + '%' : Math.round(newValue);
          }
        }, duration / steps);
      }

      // Nav functions
      function shareProgress() {
        const goalRank = ranks.find(r => r.name === selectedGoal);
        const goalPoints = goalRank ? goalRank.points : 2400;
        const progress = ((currentPoints / goalPoints) * 100).toFixed(1);
        
        const text = `üéÆ THE FINALS Season 8 Progress\n` +
                    `üìä ${currentPoints}/${goalPoints} points (${progress}%)\n` +
                    `üéØ Goal: ${selectedGoal}\n` +
                    `üìÖ ${daysRemaining} days remaining\n` +
                    `üîó Track yours at: thefinalsloadout.com/wt-progress`;
        
        if (navigator.share) {
          navigator.share({
            title: 'My World Tour Progress',
            text: text
          });
        } else {
          navigator.clipboard.writeText(text);
          showNotification('Progress copied to clipboard!', 'success');
        }
      }

      function takeScreenshot() {
        document.body.classList.add('screenshot-mode');
        
        setTimeout(() => {
          showNotification('Screenshot ready! Use your device\'s screenshot feature.', 'success');
          
          setTimeout(() => {
            document.body.classList.remove('screenshot-mode');
          }, 3000);
        }, 100);
      }

      function resetData() {
        if (confirm('Are you sure you want to reset all data? This cannot be undone.')) {
          // Clear all localStorage data
          localStorage.clear();

          // Reset global variables to defaults
          currentPoints = 0;
          selectedGoal = 'Emerald I';
          dailyEntries = [];
          undoHistory = [];

          // Set fresh defaults in localStorage
          localStorage.setItem('cacheVersion', STORAGE_VERSION);
          localStorage.setItem('currentPoints', '0');
          localStorage.setItem('selectedGoal', 'Emerald I');
          localStorage.setItem('dailyEntries', '[]');
          localStorage.setItem('undoHistory', '[]');
          localStorage.setItem('seasonStartDate', SEASON_START_DATE);
          localStorage.setItem('seasonEndDate', SEASON_END_DATE);

          // Clear storage cache
          storage.cache = {};
          storage.cacheTimestamps = {};

          // Reload the page to reinitialize everything
          location.reload();
        }
      }

      // Auto-save on visibility change
      document.addEventListener('visibilitychange', () => {
        if (document.hidden) {
          // Save current state
          storage.set('currentPoints', currentPoints);
          storage.set('selectedGoal', selectedGoal);
          storage.set('dailyEntries', dailyEntries);
          storage.set('undoHistory', undoHistory);
        }
      });

      // Update timer
      setInterval(() => {
        calculateDaysRemaining();
        const daysEl = document.getElementById('daysRemaining');
        if (daysEl && parseInt(daysEl.textContent) !== daysRemaining) {
          updateDashboard();
        }
      }, 60000); // Update every minute

      // First time user functions
      function checkFirstTimeUser() {
        const hasVisited = localStorage.getItem('hasVisitedBefore');
        if (!hasVisited) {
          document.getElementById('firstTimeOverlay').style.display = 'flex';
        }
      }

      function closeFirstTimeOverlay() {
        document.getElementById('firstTimeOverlay').style.display = 'none';
        localStorage.setItem('hasVisitedBefore', 'true');

        // Add highlight animations to guide user
        const goalContainer = document.getElementById('goalSelectorContainer');
        const pointsContainer = document.getElementById('pointsInputContainer');

        goalContainer.classList.add('highlight-action');
        setTimeout(() => {
          goalContainer.classList.remove('highlight-action');
          pointsContainer.classList.add('highlight-action');
          setTimeout(() => {
            pointsContainer.classList.remove('highlight-action');
          }, 6000);
        }, 1000);
      }

      function showHelp() {
        document.getElementById('firstTimeOverlay').style.display = 'flex';
      }

      function addInteractiveHighlights() {
        const pointsInput = document.getElementById('currentPoints');
        const pointsContainer = document.getElementById('pointsInputContainer');
        const goalSelect = document.getElementById('goalSelect');
        const goalContainer = document.getElementById('goalSelectorContainer');

        // Add click handler to the entire points container
        pointsContainer.addEventListener('click', () => {
          pointsInput.focus();
          pointsInput.select();
        });

        // Remove highlight when user interacts
        goalSelect.addEventListener('change', () => {
          goalContainer.classList.remove('highlight-action');
          // Highlight points input after goal selection
          setTimeout(() => {
            pointsContainer.classList.add('highlight-action');
            setTimeout(() => {
              pointsContainer.classList.remove('highlight-action');
            }, 4000);
          }, 500);
        });

        pointsInput.addEventListener('input', () => {
          pointsContainer.classList.remove('highlight-action');
        });

        // If user hasn't set points or goal, add subtle animation
        if (currentPoints === 0 && !localStorage.getItem('hasVisitedBefore')) {
          setTimeout(() => {
            if (currentPoints === 0) {
              goalContainer.classList.add('highlight-action');
            }
          }, 2000);
        }
      }
    </script>

    <!-- Manual Update Link -->
    <div style="text-align: center; padding: 30px 10px; margin-top: 40px;">
        <p style="color: #888; font-size: 0.95em; margin-bottom: 12px;">Customize Season Settings</p>
        <a href="/wt-progress/manual"
           class="wt-manual-cta"
           style="color: #50c878; text-decoration: none; font-weight: 600; padding: 10px 20px; border: 1px solid #50c878; border-radius: 5px; display: inline-block; transition: all 0.3s ease;"
           onmouseover="this.style.background='#50c878'; this.style.color='#0a0e27';"
           onmouseout="this.style.background='transparent'; this.style.color='#50c878';"
           aria-label="Edit World Tour points, ranks, and season dates">
            Edit Points ‚Ä¢ Ranks ‚Ä¢ Dates
        </a>
    </div>

    <!-- Support Section -->
    <div style="margin-top: 3rem; padding: 2rem 1rem; background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); border-top: 2px solid #50c878;">
        <div class="support-section" style="text-align: center;">
            <div style="display:flex;align-items:center;justify-content:center;gap:1rem;flex-wrap:wrap;">
                <span style="font-size:1.5rem;">‚òï</span>
                <div>
                    <p style="margin:0;color:#50c878;font-weight:600;font-size:0.9rem;">Enjoying the World Tour tracker?</p>
                    <p style="margin:0.25rem 0 0.75rem 0;color:#b8bfc6;font-size:0.8rem;">Help keep it running with a coffee!</p>
                </div>
            </div>
            <a href="https://ko-fi.com/nextroundonme" target="_blank" rel="noopener" style="
                display: inline-block;
                margin-top: 1rem;
                padding: 0.75rem 1.5rem;
                background: linear-gradient(135deg, #50c878, #2e8b57);
                color: white;
                text-decoration: none;
                border-radius: 0.5rem;
                font-weight: 600;
                transition: transform 0.3s ease, box-shadow 0.3s ease;
            " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(80,200,120,0.3)';" onmouseout="this.style.transform=''; this.style.boxShadow='';">
                <span>üíö Support Me</span>
            </a>
        </div>
    </div>
  <!-- Bug Fixes for Date Handling and Running Totals -->
  <script src="wt-fixes.js"></script>
  </body>
</html>
