<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>THE FINALS World Tour Tracker - Manual Mode | Customize Your Own Season</title>
    <meta
      name="description"
      content="Customizable World Tour tracker for THE FINALS. Set your own season dates, rank requirements, and point values. Perfect for new seasons before the official tracker is updated."
    />

    <meta
      name="keywords"
      content="THE FINALS World Tour tracker, Emerald rank calculator, Season 9 progress, daily points calculator, rank tracker, gaming tools, quickplay points"
    />

    <!-- Mobile Web App Meta Tags -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="WT Tracker">

    <!-- Performance Optimizations -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" as="style">

    <!--  Open Graph / Facebook social   -->
    <meta property="og:type" content="website" />
    <meta
      property="og:url"
      content="https://www.thefinalsloadout.com/wt-progress/"
    />
    <meta
      property="og:title"
      content="S9 World Tour Progress Tracker - The Finals"
    />
    <meta
      property="og:description"
      content="Track your progress to any rank in The Finals Season 9. Now with Quickplay support!"
    />
    <meta
      property="og:image"
      content="https://www.thefinalsloadout.com/wt-progress/images/social1200x630.png"
    />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:image:type" content="image/png" />
    <meta
      property="og:url"
      content="https://www.thefinalsloadout.com/wt-progress/"
    />

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta
      name="twitter:title"
      content="S9 World Tour Progress Tracker - The Finals"
    />
    <meta
      name="twitter:description"
      content="Track your progress to any rank in The Finals Season 9. Now with Quickplay support!"
    />
    <meta
      name="twitter:image"
      content="https://www.thefinalsloadout.com/wt-progress/images/social1200x630.png"
    />
    <meta
      name="twitter:url"
      content="https://www.thefinalsloadout.com/wt-progress/"
    />

    <!-- Structured Data - WebApplication -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "THE FINALS World Tour Progress Tracker",
      "applicationCategory": "GameApplication",
      "operatingSystem": "Web",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "4.8",
        "ratingCount": "200"
      },
      "description": "Track World Tour progress and calculate points needed for any rank",
      "screenshot": "https://thefinalsloadout.com/wt-progress/images/screenshot.png"
    }
    </script>

    <!-- FAQ Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [{
        "@type": "Question",
        "name": "How many points do I need for Emerald rank in THE FINALS Season 9?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "You need 2,400 points to reach Emerald I, the highest rank in World Tour. Emerald IV starts at 1,800 points."
        }
      },{
        "@type": "Question",
        "name": "How do World Tour points work in Season 9?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "In World Tour Season 9 Cashout/Ranked: Win = 25 points, Lose Final = 14 points, Knocked out Round 2 = 6 points, Knocked out Round 1 = 2 points. Quickplay: 1st Place = 4 points, 2nd Place = 3 points, 3rd Place = 2 points."
        }
      },{
        "@type": "Question",
        "name": "What is Quickplay mode in THE FINALS Season 9?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Quickplay is a new way to earn World Tour points in Season 9. You earn 4 points for 1st place, 3 points for 2nd place, and 2 points for 3rd place."
        }
      }]
    }
    </script>

    <link rel="icon" type="image/x-icon" href="images/favicon.ico" />
    <link rel="apple-touch-icon" href="images/logo.png" />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      /* Accessibility - Screen reader only content */
      .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border-width: 0;
      }

      /* Focus indicators */
      *:focus {
        outline: 2px solid #ff3366;
        outline-offset: 2px;
      }

      button:focus,
      input:focus,
      select:focus,
      a:focus {
        outline: 3px solid #ff3366;
        outline-offset: 3px;
        box-shadow: 0 0 0 4px rgba(255, 51, 102, 0.2);
      }

      body {
        background: linear-gradient(
          135deg,
          #0a0a0a 0%,
          #1a1a1a 50%,
          #0d1117 100%
        );
        color: #ffffff;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        padding: 0;
        margin: 0;
        min-height: 100vh;
        position: relative;
      }

      body::before {
        content: "";
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: radial-gradient(
            circle at 20% 50%,
            rgba(255, 51, 102, 0.05) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 80% 80%,
            rgba(255, 102, 153, 0.03) 0%,
            transparent 50%
          );
        pointer-events: none;
        z-index: 1;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px 20px 20px;
        position: relative;
        z-index: 2;
      }

      /* Season 9 Badge */
      .season-badge {
        display: inline-flex;
        align-items: center;
        background: linear-gradient(135deg, #ff3366, #ff6699);
        color: #000;
        padding: 0.25rem 0.75rem;
        border-radius: 20px;
        font-size: 0.85rem;
        font-weight: 700;
        margin-bottom: 1rem;
        animation: pulse 2s infinite;
      }

      @keyframes pulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.05); }
      }

      /* Step indicators */
      .step-indicator {
        display: inline-flex;
        align-items: center;
        background: linear-gradient(135deg, #ff3366, #ff6699);
        color: #000;
        padding: 0.25rem 0.75rem;
        border-radius: 20px;
        font-size: 0.9rem;
        font-weight: 800;
        margin-bottom: 0.5rem;
        text-transform: uppercase;
        letter-spacing: 1px;
        animation: pulse-attention 2s infinite;
      }

      @keyframes pulse-attention {
        0%, 100% {
          transform: scale(1);
          box-shadow: 0 0 0 0 rgba(255, 51, 102, 0.7);
        }
        50% {
          transform: scale(1.05);
          box-shadow: 0 0 20px 5px rgba(255, 51, 102, 0.3);
        }
      }

      /* First load animation */
      @keyframes highlight-first-load {
        0%, 100% {
          box-shadow: 0 0 30px rgba(255, 51, 102, 0.5);
          border-color: #ff3366;
        }
        50% {
          box-shadow: 0 0 50px rgba(255, 51, 102, 0.8);
          border-color: #ff6699;
        }
      }

      .highlight-action {
        animation: highlight-first-load 2s ease-in-out 3;
      }

      /* First time overlay */
      .first-time-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.9);
        z-index: 9999;
        display: flex;
        align-items: center;
        justify-content: center;
        backdrop-filter: blur(5px);
      }

      .first-time-content {
        background: linear-gradient(135deg, #1a1a1a 0%, #0d0d0d 100%);
        border: 3px solid #ff3366;
        border-radius: 20px;
        padding: 2rem;
        max-width: 500px;
        text-align: center;
        box-shadow: 0 0 50px rgba(255, 51, 102, 0.5);
      }

      .first-time-title {
        font-size: 1.8rem;
        font-weight: 700;
        margin-bottom: 1.5rem;
        background: linear-gradient(135deg, #ff3366, #ff6699);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }

      .first-time-step {
        display: flex;
        align-items: center;
        margin: 1.5rem 0;
        text-align: left;
        padding: 1rem;
        background: rgba(255, 51, 102, 0.1);
        border-radius: 10px;
        border: 1px solid rgba(255, 51, 102, 0.3);
      }

      .first-time-step-number {
        background: linear-gradient(135deg, #ff3366, #ff6699);
        color: #000;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 800;
        font-size: 1.2rem;
        margin-right: 1rem;
        flex-shrink: 0;
      }

      .first-time-step-text {
        color: #fff;
        font-size: 1rem;
      }

      .first-time-button {
        background: linear-gradient(135deg, #ff3366, #ff6699);
        color: #000;
        border: none;
        padding: 1rem 2rem;
        border-radius: 10px;
        font-size: 1.1rem;
        font-weight: 700;
        cursor: pointer;
        margin-top: 1.5rem;
        transition: all 0.3s;
      }

      .first-time-button:hover {
        transform: scale(1.05);
        box-shadow: 0 5px 20px rgba(255, 51, 102, 0.5);
      }

      /* Help button */
      .help-button {
        position: fixed;
        bottom: 80px;
        right: 20px;
        background: linear-gradient(135deg, #ff3366, #ff6699);
        color: #000;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        font-weight: 700;
        cursor: pointer;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        transition: all 0.3s;
        z-index: 1000;
      }

      .help-button:hover {
        transform: scale(1.1);
        box-shadow: 0 6px 20px rgba(255, 51, 102, 0.5);
      }

      /* Track Your Progress Section */
      .track-progress-section {
        margin-bottom: 30px;
        box-sizing: border-box;
        width: 100%;
      }

      .track-progress-header {
        text-align: center;
        margin-bottom: 30px;
      }

      .setup-container {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 20px;
        margin-top: 20px;
        margin-bottom: 30px;
      }

      .setup-step {
        background: linear-gradient(135deg, rgba(20, 20, 30, 0.8) 0%, rgba(10, 10, 15, 0.9) 100%);
        border: 1px solid rgba(106, 27, 154, 0.3);
        border-radius: 12px;
        padding: 20px 25px 15px;
        position: relative;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        transition: all 0.3s;
      }
      
      .setup-step:hover {
        border-color: rgba(106, 27, 154, 0.5);
        box-shadow: 0 6px 20px rgba(106, 27, 154, 0.2);
      }

      .step-number {
        position: absolute;
        top: -22px;
        left: 25px;
        background: #ff3366;
        color: #0a0a0a;
        width: 45px;
        height: 45px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        font-size: 1.65em;
        box-shadow: 0 2px 10px rgba(255, 51, 102, 0.5);
      }

      .step-title {
        font-size: 1.8em;
        margin-bottom: 20px;
        margin-top: 10px;
        color: #fff;
        font-weight: 600;
      }

      /* Goal Selector */
      .goal-selector-container {
        background: linear-gradient(135deg, rgba(255, 51, 102, 0.15) 0%, rgba(255, 51, 102, 0.05) 100%);
        border: 3px solid #ff3366;
        border-radius: 15px;
        padding: 1.5rem;
        margin: 2rem 0;
        box-shadow: 0 0 30px rgba(255, 51, 102, 0.3);
        position: relative;
      }

      .goal-selector-container.highlight-action {
        animation: highlight-first-load 2s ease-in-out infinite;
      }

      .goal-selector-header {
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
        margin-bottom: 1rem;
        gap: 0.5rem;
      }

      .goal-selector-title {
        font-size: 1.35rem;
        font-weight: 700;
        color: #ff3366;
        margin-bottom: 8px;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        justify-content: center;
        width: 100%;
      }

      .goal-hint {
        font-size: 1rem;
        color: #fff;
        background: rgba(255, 51, 102, 0.2);
        padding: 0.5rem 1rem;
        border-radius: 8px;
        margin-bottom: 1rem;
        font-weight: 600;
        border: 1px solid rgba(255, 51, 102, 0.4);
        text-transform: uppercase;
        letter-spacing: 0.5px;
        animation: pulse-attention 2s ease-in-out infinite;
        display: inline-block;
      }

      .goal-selector {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 1rem;
        width: 100%;
      }

      .goal-select {
        background: linear-gradient(135deg, rgba(106, 27, 154, 0.3) 0%, rgba(0, 0, 0, 0.8) 100%);
        border: 2px solid #6a1b9a;
        color: #fff;
        padding: 1rem 1.5rem;
        border-radius: 12px;
        font-size: 16px; /* Prevents iOS zoom */
        font-weight: 700;
        cursor: pointer;
        transition: all 0.3s;
        min-width: 280px;
        box-shadow: 0 4px 15px rgba(106, 27, 154, 0.3);
        text-transform: uppercase;
        letter-spacing: 0.5px;
        /* Allow native picker on mobile */
        -webkit-appearance: none;
        appearance: none;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='%23ff3366' viewBox='0 0 16 16'%3E%3Cpath d='M8 11L3 6h10l-5 5z'/%3E%3C/svg%3E");
        background-repeat: no-repeat;
        background-position: right 1rem center;
        padding-right: 2.5rem;
      }

      .goal-select:hover {
        background-color: rgba(106, 27, 154, 0.4);
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(106, 27, 154, 0.4);
        border-color: #ff3366;
      }

      .goal-select:focus {
        outline: none;
        border-color: #ff3366;
        box-shadow: 0 0 0 3px rgba(255, 51, 102, 0.3);
      }

      /* Fix dropdown option styling */
      .goal-select option {
        background: #1a1a1a;
        color: #ffffff;
        padding: 12px;
        font-size: 16px;
      }

      .goal-select option:checked {
        background: #6a1b9a;
        color: #fff;
      }

      .goal-display {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 1.1rem;
      }

      .goal-rank-icon {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        font-size: 0.8rem;
      }

      .goal-points {
        color: #b0b0b0;
        font-size: 0.9rem;
      }

      /* Stats Grid */
      .stats-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 20px;
        margin-bottom: 30px;
        align-items: stretch;
      }

      .stat-card {
        background: linear-gradient(135deg, rgba(20, 20, 30, 0.8) 0%, rgba(10, 10, 15, 0.9) 100%);
        border: 1px solid rgba(106, 27, 154, 0.3);
        border-radius: 15px;
        padding: 20px;
        text-align: center;
        transition: all 0.3s;
        display: flex;
        flex-direction: column;
        justify-content: center;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      }

      .stat-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 30px rgba(106, 27, 154, 0.3);
        border-color: rgba(255, 51, 102, 0.5);
      }

      .stat-card.half-height {
        flex: 1;
        padding: 15px 20px;
        min-height: 0;
      }

      .stats-column {
        display: flex;
        flex-direction: column;
        gap: 20px;
      }

      .stat-card.primary {
        background: linear-gradient(
          135deg,
          rgba(106, 27, 154, 0.2) 0%,
          rgba(255, 51, 102, 0.1) 100%
        );
        border: 2px solid rgba(106, 27, 154, 0.6);
        box-shadow: 0 4px 20px rgba(106, 27, 154, 0.3);
      }

      .stat-label {
        font-size: 1rem;
        color: #b0b0b0;
        margin-bottom: 10px;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      .stat-value {
        font-size: 3rem;
        font-weight: 700;
        background: linear-gradient(135deg, #ff3366, #ff6699);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }

      .points-input-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        position: relative;
        gap: 12px;
        padding: 1rem;
        background: linear-gradient(135deg, rgba(106, 27, 154, 0.2) 0%, rgba(255, 51, 102, 0.15) 100%);
        border-radius: 15px;
        border: 2px solid rgba(106, 27, 154, 0.6);
        transition: all 0.3s;
        overflow: hidden;
        box-shadow: 0 4px 25px rgba(106, 27, 154, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.05);
      }

      .points-input-container.highlight-action {
        animation: highlight-first-load 2s ease-in-out infinite;
      }

      .points-input-container:hover {
        border-color: #ff3366;
        box-shadow: 0 8px 35px rgba(106, 27, 154, 0.5), 0 0 20px rgba(255, 51, 102, 0.3);
        transform: translateY(-2px);
      }

      .setup-step .input-hint {
        font-size: 1rem;
        color: #888;
        background: none;
        padding: 0;
        margin-top: 5px;
        border-radius: 0;
        font-weight: 400;
        text-transform: none;
        letter-spacing: normal;
        cursor: default;
        animation: none;
        box-shadow: none;
      }

      .input-hint {
        font-size: 1.1rem;
        color: #fff;
        background: linear-gradient(135deg, #ff3366, #ff6699);
        padding: 0.75rem 1.5rem;
        border-radius: 10px;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 1px;
        cursor: pointer;
        transition: all 0.3s;
        animation: pulse-attention 2s ease-in-out infinite;
        box-shadow: 0 4px 15px rgba(255, 51, 102, 0.3);
      }

      .input-hint:hover {
        transform: scale(1.05);
        box-shadow: 0 6px 20px rgba(255, 51, 102, 0.5);
      }

      .points-input-container:hover .input-hint {
        opacity: 0.8;
      }

      /* Floating Sparkles Animation */
      .sparkles-wrapper {
        overflow: hidden;
        width: 100%;
        height: 100%;
        pointer-events: none;
        position: absolute;
        top: 0;
        left: 0;
        z-index: 1;
        border-radius: 10px;
      }

      .sparkle {
        bottom: -10px;
        position: absolute;
        animation: floating-sparkles infinite ease-in-out;
        pointer-events: none;
        width: 3px;
        height: 3px;
        background-color: rgba(255, 255, 255, 0.9);
        border-radius: 50%;
        box-shadow: 0 0 6px rgba(255, 51, 102, 0.8), 0 0 12px rgba(106, 27, 154, 0.6);
      }

      @keyframes floating-sparkles {
        0% {
          transform: translateY(0);
          opacity: 0;
        }
        10% {
          opacity: 1;
        }
        85% {
          opacity: 0;
        }
        100% {
          transform: translateY(-80px);
          opacity: 0;
        }
      }

      .sparkle:nth-child(1) { left: 8%; animation-duration: 2.8s; animation-delay: 0.1s; }
      .sparkle:nth-child(2) { left: 18%; animation-duration: 2.4s; animation-delay: 0.6s; }
      .sparkle:nth-child(3) { left: 28%; animation-duration: 3.0s; animation-delay: 0.3s; }
      .sparkle:nth-child(4) { left: 38%; animation-duration: 2.2s; animation-delay: 0.8s; }
      .sparkle:nth-child(5) { left: 50%; animation-duration: 2.6s; animation-delay: 0.2s; }
      .sparkle:nth-child(6) { left: 62%; animation-duration: 2.9s; animation-delay: 0.5s; }
      .sparkle:nth-child(7) { left: 72%; animation-duration: 2.3s; animation-delay: 0.9s; }
      .sparkle:nth-child(8) { left: 82%; animation-duration: 2.7s; animation-delay: 0.4s; }
      .sparkle:nth-child(9) { left: 88%; animation-duration: 2.5s; animation-delay: 0.7s; }
      .sparkle:nth-child(10) { left: 95%; animation-duration: 3.1s; animation-delay: 0.15s; }

      .setup-step .points-input {
        background: rgba(255, 255, 255, 0.05);
        border: 2px solid rgba(255, 51, 102, 0.5);
        color: #ff3366;
        font-size: 3em;
        font-weight: 700;
        text-align: center;
        width: 100%;
        padding: 20px;
        cursor: text;
        transition: all 0.3s;
        border-radius: 10px;
        -webkit-appearance: none;
        -moz-appearance: textfield;
        box-shadow: none;
      }

      .setup-step .points-input:focus {
        outline: none;
        border-color: #ff3366;
        background: rgba(255, 255, 255, 0.08);
        box-shadow: 0 0 20px rgba(255, 51, 102, 0.3);
      }

      .points-input {
        background: rgba(0, 0, 0, 0.6);
        border: 3px solid #ff3366;
        color: #ff3366;
        font-size: 3em;
        font-weight: 700;
        text-align: center;
        width: 200px;
        padding: 15px;
        cursor: pointer;
        transition: all 0.3s;
        border-radius: 12px;
        -webkit-appearance: none;
        -moz-appearance: textfield;
        box-shadow: 0 0 20px rgba(255, 51, 102, 0.2) inset;
      }
      
      .points-input::placeholder {
        color: rgba(255, 51, 102, 0.3);
        font-size: 0.5em;
      }

      .points-input:hover {
        background: rgba(255, 51, 102, 0.15);
        border-color: rgba(255, 51, 102, 0.6);
        transform: scale(1.02);
      }

      .points-input:focus {
        outline: 3px solid #ff3366;
        outline-offset: 3px;
        background: rgba(255, 51, 102, 0.2);
        border: 3px solid #ff3366;
        box-shadow: 0 0 30px rgba(255, 51, 102, 0.5);
        transform: scale(1.05);
      }

      /* Progress Section */
      .progress-section {
        margin: 30px 0;
        background: linear-gradient(135deg, rgba(20, 20, 30, 0.8) 0%, rgba(10, 10, 15, 0.9) 100%);
        border-radius: 15px;
        padding: 25px;
        border: 1px solid rgba(106, 27, 154, 0.3);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      }

      .progress-section h2 {
        margin-bottom: 20px;
        font-size: 1.5em;
        background: linear-gradient(135deg, #ff3366, #ff6699);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }

      .progress-container {
        position: relative;
        height: 40px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 20px;
        overflow: visible;
        margin-bottom: 50px;
        margin-top: 20px;
      }

      .progress-bar {
        height: 100%;
        background: linear-gradient(90deg, #ff3366, #ff6699);
        border-radius: 20px;
        transition: width 0.5s ease;
        box-shadow: 0 0 20px rgba(255, 51, 102, 0.5);
        position: relative;
        z-index: 1;
      }

      .progress-text {
        position: absolute;
        top: 50%;
        right: 20px;
        transform: translateY(-50%);
        font-weight: 700;
        font-size: 1.3rem;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
        z-index: 2;
      }

      .progress-milestones {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 100%;
        z-index: 2;
        pointer-events: none;
      }

      .milestone-marker {
        position: absolute;
        top: -10px;
        transform: translateX(-50%);
        display: flex;
        flex-direction: column;
        align-items: center;
        z-index: 3;
      }

      .milestone-dot {
        width: 18px;
        height: 18px;
        border-radius: 50%;
        background: #2a2a3e;
        border: 3px solid #6a6a8a;
        margin-bottom: 5px;
        transition: all 0.3s;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.4);
      }

      .milestone-dot.achieved {
        background: #ff3366;
        border-color: #ff6699;
        box-shadow: 0 0 12px rgba(255, 51, 102, 0.6), 0 2px 4px rgba(0, 0, 0, 0.3);
      }

      .milestone-label {
        font-size: 0.85em;
        color: #c0c0c0;
        text-transform: uppercase;
        margin-top: 25px;
        white-space: nowrap;
        font-weight: 600;
        text-shadow: 0 1px 3px rgba(0, 0, 0, 0.8);
      }

      .milestone-label.achieved {
        color: #ff6699;
        font-weight: 700;
        text-shadow: 0 0 8px rgba(255, 51, 102, 0.5), 0 1px 3px rgba(0, 0, 0, 0.8);
      }

      .pace-indicator {
        text-align: center;
        padding: 14px 18px;
        border-radius: 10px;
        font-weight: 600;
        font-size: 1.1rem;
        transition: all 0.3s;
        border: 1px solid rgba(106, 27, 154, 0.3);
      }
      
      /* Tooltip Icon Styles */
      .tooltip-icon {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 22px;
        height: 22px;
        background: rgba(255, 51, 102, 0.2);
        border: 1px solid rgba(255, 51, 102, 0.4);
        border-radius: 50%;
        font-size: 0.75rem !important;
        color: #ff6699 !important;
        cursor: pointer;
        transition: all 0.2s;
        user-select: none;
        -webkit-tap-highlight-color: transparent;
      }
      
      .tooltip-icon:hover {
        background: rgba(255, 51, 102, 0.4);
        border-color: #ff3366;
        transform: scale(1.1);
      }
      
      .tooltip-icon:active {
        transform: scale(0.95);
      }
      
      /* Tooltip Content Styles - Centered Modal */
      .tooltip-content {
        display: none;
        position: fixed !important;
        background: rgb(0, 0, 0) !important;
        border: 2px solid #ff3366 !important;
        border-radius: 16px !important;
        padding: 24px !important;
        width: 320px !important;
        max-width: calc(100vw - 40px) !important;
        max-height: calc(100vh - 100px) !important;
        overflow-y: auto !important;
        z-index: 999999 !important;
        text-align: left !important;
        font-size: 1rem !important;
        box-shadow: 0 12px 40px rgba(0,0,0,0.9), 0 0 0 9999px rgba(0,0,0,0.5) !important;
        color: white !important;
        text-transform: none !important;
        letter-spacing: normal !important;
        font-family: inherit !important;
        line-height: 1.6 !important;
        /* Center on screen */
        left: 50% !important;
        top: 50% !important;
        transform: translate(-50%, -50%) !important;
      }
      
      .tooltip-content.active {
        display: block !important;
      }
      
      /* Close button for tooltips */
      .tooltip-close {
        position: absolute;
        top: 10px;
        right: 12px;
        width: 28px;
        height: 28px;
        border: none;
        background: rgba(255, 51, 102, 0.2);
        border-radius: 50%;
        color: #ff6699;
        font-size: 18px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s;
      }
      
      .tooltip-close:hover {
        background: rgba(255, 51, 102, 0.4);
        color: #fff;
      }

      .pace-indicator.ahead {
        background: linear-gradient(135deg, rgba(106, 27, 154, 0.2), rgba(255, 51, 102, 0.15));
        color: #ff6699;
        border-color: rgba(106, 27, 154, 0.5);
      }

      .pace-indicator.behind {
        background: rgba(255, 71, 87, 0.15);
        color: #ff6b6b;
        border-color: rgba(255, 71, 87, 0.3);
      }

      .pace-indicator.on-track {
        background: linear-gradient(135deg, rgba(106, 27, 154, 0.15), rgba(155, 89, 182, 0.1));
        color: #9b59b6;
        border-color: rgba(155, 89, 182, 0.4);
      }

      /* Quick Actions */
      .match-results-section {
        background: rgba(255, 255, 255, 0.03);
        border-radius: 15px;
        padding: 20px;
        margin: 30px 0;
        border: 1px solid rgba(106, 27, 154, 0.3);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      }

      .match-results-section h2 {
        margin-bottom: 20px;
        font-size: 1.5em;
        background: linear-gradient(135deg, #6a1b9a, #ff3366);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }

      .quick-actions {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 15px;
      }

      .quick-action-btn {
        background: linear-gradient(135deg, rgba(20, 20, 30, 0.9) 0%, rgba(10, 10, 15, 0.95) 100%);
        border: 2px solid;
        color: #ffffff;
        padding: 20px 15px;
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.3s;
        font-weight: 600;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 8px;
        min-height: 120px;
        position: relative;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
      }

      .quick-action-icon {
        font-size: 2rem;
        margin-bottom: 8px;
      }
      
      .quick-action-icon.icon-text {
        width: 48px;
        height: 48px;
        border-radius: 50%;
        background: linear-gradient(135deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0.05));
        border: 2px solid currentColor;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 800;
        font-size: 1.3rem;
        letter-spacing: -1px;
      }

      .quick-action-label {
        font-size: 1.15rem;
        font-weight: 600;
        margin-bottom: 5px;
      }

      .quick-action-points {
        font-weight: 800;
        font-size: 1.5rem;
        color: #ff3366;
      }

      .quick-action-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.4);
      }

      .quick-action-btn.win {
        border-color: #6a1b9a;
        background: linear-gradient(135deg, rgba(106, 27, 154, 0.2), rgba(255, 51, 102, 0.1));
      }

      .quick-action-btn.win:hover {
        background: linear-gradient(135deg, rgba(106, 27, 154, 0.3), rgba(255, 51, 102, 0.2));
        box-shadow: 0 5px 20px rgba(106, 27, 154, 0.4);
      }

      .quick-action-btn.second {
        border-color: #9b59b6;
        background: linear-gradient(135deg, rgba(155, 89, 182, 0.1), rgba(155, 89, 182, 0.05));
      }

      .quick-action-btn.third {
        border-color: #ff6699;
        background: linear-gradient(135deg, rgba(255, 102, 153, 0.1), rgba(255, 102, 153, 0.05));
      }

      .quick-action-btn.qualified {
        border-color: #ff3366;
        background: linear-gradient(135deg, rgba(255, 51, 102, 0.1), rgba(255, 51, 102, 0.05));
      }

      .quick-action-btn.eliminated {
        border-color: #ff4757;
        background: linear-gradient(135deg, rgba(255, 71, 87, 0.1), rgba(255, 71, 87, 0.05));
      }

      .quick-action-btn.undo {
        border-color: #ff4757;
        background: linear-gradient(135deg, rgba(255, 71, 87, 0.1), rgba(255, 71, 87, 0.05));
      }

      .quick-action-btn.undo .quick-action-label {
        color: #ff4757;
      }

      /* Rank Ladder */
      .rank-ladder {
        background: linear-gradient(135deg, rgba(20, 20, 30, 0.8) 0%, rgba(10, 10, 15, 0.9) 100%);
        border-radius: 15px;
        padding: 20px;
        margin: 30px 0;
        border: 1px solid rgba(106, 27, 154, 0.3);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      }

      .rank-ladder h2 {
        margin-bottom: 20px;
        font-size: 1.5em;
        background: linear-gradient(135deg, #ff3366, #ff6699);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }

      #rankLadder {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 15px;
      }

      .rank-item {
        display: flex;
        align-items: center;
        padding: 14px 18px;
        background: rgba(255, 255, 255, 0.02);
        border-radius: 10px;
        border: 1px solid rgba(255, 255, 255, 0.05);
        transition: all 0.3s;
        opacity: 0;
        animation: fadeInUp 0.5s forwards;
        position: relative;
        font-size: 1.1rem;
      }

      .rank-item-content {
        display: flex;
        align-items: center;
        flex: 1;
        gap: 10px;
      }

      .rank-status {
        width: 24px;
        height: 24px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.9em;
        border: 2px solid rgba(255, 255, 255, 0.2);
      }

      .rank-status.completed {
        background: #ff3366;
        border-color: #ff3366;
        color: #0a0a0a;
      }

      @keyframes fadeInUp {
        to {
          opacity: 1;
          transform: translateY(0);
        }
        from {
          opacity: 0;
          transform: translateY(20px);
        }
      }

      /* Scroll Reveal Animation */
      .scroll-reveal {
        opacity: 0;
        transform: translateY(30px);
        transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .scroll-reveal.revealed {
        opacity: 1;
        transform: translateY(0);
      }

      /* Stagger animations for children */
      .setup-container > .scroll-reveal:nth-child(1) { transition-delay: 0.1s; }
      .setup-container > .scroll-reveal:nth-child(2) { transition-delay: 0.2s; }
      .stats-grid > .scroll-reveal:nth-child(1) { transition-delay: 0.1s; }
      .stats-grid > .scroll-reveal:nth-child(2) { transition-delay: 0.2s; }
      .stats-grid > .scroll-reveal:nth-child(3) { transition-delay: 0.3s; }

      .rank-item:hover {
        transform: translateX(5px);
        background: rgba(255, 51, 102, 0.1);
        border-color: rgba(255, 51, 102, 0.3);
      }

      .rank-item.completed {
        background: rgba(255, 51, 102, 0.15);
        border-color: #ff3366;
      }

      .rank-item.current {
        background: linear-gradient(135deg, rgba(106, 27, 154, 0.2), rgba(255, 51, 102, 0.15));
        border-color: #6a1b9a;
        box-shadow: 0 0 20px rgba(106, 27, 154, 0.4);
      }

      .rank-icon {
        width: 45px;
        height: 45px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        font-size: 0.9rem;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
      }

      /* Rank colors */
      .rank-bronze { background: linear-gradient(135deg, #CD7F32, #8B4513); }
      .rank-silver { background: linear-gradient(135deg, #C0C0C0, #808080); }
      .rank-gold { background: linear-gradient(135deg, #FFD700, #FFA500); }
      .rank-platinum { background: linear-gradient(135deg, #E5E4E2, #B0B0B0); }
      .rank-diamond { background: linear-gradient(135deg, #B9F2FF, #00CED1); }
      .rank-emerald { background: linear-gradient(135deg, #ff3366, #6a1b9a); }

      /* Daily Entries */
      .daily-entries-section {
        background: rgba(255, 255, 255, 0.03);
        border-radius: 15px;
        padding: 25px;
        margin: 30px 0;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .entry-form {
        display: grid;
        grid-template-columns: 1fr 1fr 2fr auto;
        gap: 10px;
        margin-bottom: 20px;
      }

      .entry-input {
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: #ffffff;
        padding: 10px;
        border-radius: 8px;
        font-size: 1em;
      }

      .entry-input:focus {
        border-color: #ff3366;
        background: rgba(255, 51, 102, 0.1);
      }

      .add-entry-btn {
        background: linear-gradient(135deg, #ff3366, #ff6699);
        color: #000;
        border: none;
        padding: 10px 20px;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.3s;
      }

      .add-entry-btn:hover {
        transform: scale(1.05);
        box-shadow: 0 5px 15px rgba(255, 51, 102, 0.3);
      }

      .entries-list {
        max-height: 400px;
        overflow-y: auto;
      }

      .entry-item {
        display: grid;
        grid-template-columns: 100px 80px 1fr auto;
        align-items: center;
        padding: 12px;
        margin-bottom: 8px;
        background: rgba(255, 255, 255, 0.02);
        border-radius: 8px;
        border: 1px solid rgba(255, 255, 255, 0.05);
        transition: all 0.3s;
      }

      .entry-item:hover {
        background: rgba(255, 51, 102, 0.05);
        transform: translateX(5px);
      }

      .entry-points {
        color: #ff3366;
        font-weight: 600;
      }

      /* Notification */
      .notification {
        position: fixed;
        top: 100px;
        right: 20px;
        padding: 15px 20px;
        border-radius: 10px;
        background: rgba(255, 51, 102, 0.9);
        color: #000;
        font-weight: 600;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
        transform: translateX(400px);
        transition: transform 0.3s;
        z-index: 1000;
      }

      .notification.show {
        transform: translateX(0);
      }

      .notification.error {
        background: rgba(255, 71, 87, 0.9);
        color: #fff;
      }

      /* Confetti */
      .confetti {
        position: fixed;
        width: 10px;
        height: 10px;
        background: #ff3366;
        animation: confetti-fall 3s linear;
        z-index: 999;
      }

      @keyframes confetti-fall {
        to {
          transform: translateY(100vh) rotate(360deg);
          opacity: 0;
        }
      }

      /* Milestone Popup */
      .milestone-popup {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) scale(0);
        background: linear-gradient(135deg, rgba(10, 10, 10, 0.98) 0%, rgba(26, 26, 26, 0.98) 100%);
        border: 3px solid #ff3366;
        border-radius: 20px;
        padding: 30px;
        text-align: center;
        z-index: 1001;
        animation: milestone-appear 0.5s forwards;
        box-shadow: 0 0 50px rgba(255, 51, 102, 0.5);
      }

      @keyframes milestone-appear {
        to {
          transform: translate(-50%, -50%) scale(1);
        }
      }

      .milestone-icon {
        font-size: 4em;
        margin-bottom: 15px;
      }

      .milestone-title {
        font-size: 2em;
        font-weight: 700;
        margin-bottom: 10px;
        background: linear-gradient(135deg, #ff3366, #ff6699);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }

      .milestone-message {
        font-size: 1.2em;
        color: #b0b0b0;
        margin-bottom: 20px;
      }

      .milestone-close {
        background: linear-gradient(135deg, #ff3366, #ff6699);
        color: #000;
        border: none;
        padding: 12px 30px;
        border-radius: 10px;
        cursor: pointer;
        font-weight: 700;
        font-size: 1.1em;
        transition: all 0.3s;
      }

      .milestone-close:hover {
        transform: scale(1.05);
        box-shadow: 0 5px 15px rgba(255, 51, 102, 0.3);
      }

      /* Celebration State */
      .celebration-mode {
        animation: celebration-pulse 2s infinite;
      }

      @keyframes celebration-pulse {
        0%, 100% {
          box-shadow: 0 0 30px rgba(255, 51, 102, 0.5);
        }
        50% {
          box-shadow: 0 0 50px rgba(255, 51, 102, 0.8);
        }
      }

      /* Logo with pink glow to match theme */
      .wt-logo {
        filter: drop-shadow(0 0 20px rgba(255, 51, 102, 0.6))
                drop-shadow(0 0 40px rgba(255, 51, 102, 0.4))
                drop-shadow(0 0 60px rgba(255, 51, 102, 0.2));
        transition: filter 0.3s ease;
      }
      
      .wt-logo:hover {
        filter: drop-shadow(0 0 25px rgba(255, 51, 102, 0.8))
                drop-shadow(0 0 50px rgba(255, 51, 102, 0.5))
                drop-shadow(0 0 80px rgba(255, 51, 102, 0.3));
      }

      /* Mobile Responsive */
      @media (max-width: 768px) {
        .container {
          padding: 10px;
        }

        /* Make logo 30% bigger on mobile */
        .wt-logo {
          width: 52% !important;  /* 40% * 1.3 = 52% */
          max-width: 364px !important;  /* 280px * 1.3 = 364px */
        }

        .setup-container {
          grid-template-columns: 1fr;
          gap: 20px;
        }

        .setup-step {
          padding: 15px 15px 12px;
        }

        .stats-grid {
          grid-template-columns: 1fr;
        }

        .stats-column {
          display: contents;
        }

        .stats-column .stat-card {
          padding: 20px;
        }

        .goal-select {
          width: 100%;
          font-size: 16px !important; /* Prevents iOS zoom on focus */
          padding: 16px;
          touch-action: manipulation;
          min-height: 56px;
          /* Reset to native on mobile for better UX */
          -webkit-appearance: menulist-button !important;
          appearance: menulist-button !important;
          background-image: none !important;
          padding-right: 1rem;
        }

        .entry-form {
          grid-template-columns: 1fr;
        }

        .quick-actions {
          grid-template-columns: repeat(2, 1fr);
          gap: 10px;
        }

        .quick-action-btn {
          min-height: 100px;
          padding: 15px 10px;
        }

        .quick-action-icon {
          font-size: 1.8rem;
        }
        
        .quick-action-icon.icon-text {
          width: 44px;
          height: 44px;
          font-size: 1.2rem;
        }

        .quick-action-label {
          font-size: 1.1rem;
        }

        .quick-action-points {
          font-size: 1.4rem;
        }

        #rankLadder {
          grid-template-columns: 1fr;
        }

        .rank-item {
          font-size: 1.15rem;
          padding: 16px 18px;
        }
        
        .rank-icon {
          width: 50px;
          height: 50px;
          font-size: 1.3rem;
        }
        
        .rank-name {
          font-size: 1.15rem;
          font-weight: 600;
        }
        
        .rank-points {
          font-size: 1rem;
        }
        
        .stat-value {
          font-size: 2.8rem !important;
        }
        
        .stat-label {
          font-size: 1rem;
        }
        
        .stat-subtitle {
          font-size: 1.05rem !important;
        }
        
        .pace-indicator {
          font-size: 1.15rem;
          padding: 16px 20px;
        }
        
        .progress-text {
          font-size: 1.2rem;
        }
        
        .setup-step .points-input,
        .points-input {
          font-size: 2.8rem;
        }

        /* Touch-friendly scrolling */
        .rank-ladder {
          -webkit-overflow-scrolling: touch;
          scroll-behavior: smooth;
        }

        /* Swipe hint */
        .rank-ladder::after {
          content: "â†• Swipe to scroll";
          display: block;
          text-align: center;
          color: #666;
          font-size: 0.8rem;
          margin-top: 10px;
        }
      }

      /* Loading state */
      .loading {
        opacity: 0.5;
        pointer-events: none;
      }

      /* Last updated indicator */
      .last-updated {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background: rgba(0, 0, 0, 0.8);
        padding: 8px 15px;
        border-radius: 20px;
        font-size: 0.85rem;
        color: #b0b0b0;
        border: 1px solid rgba(255, 255, 255, 0.1);
        z-index: 100;
      }

      /* Screenshot mode */
      .screenshot-mode .last-updated {
        display: none;
      }

      /* Nav */
      nav {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        background: rgba(10, 10, 10, 0.95);
        backdrop-filter: blur(10px);
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        z-index: 999;
        padding: 15px 0;
      }

      .nav-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .nav-logo {
        display: flex;
        align-items: center;
        gap: 10px;
        text-decoration: none;
        color: #fff;
        font-weight: 700;
        font-size: 1.2rem;
      }

      .nav-actions {
        display: flex;
        gap: 15px;
      }

      .nav-btn {
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: #fff;
        padding: 8px 16px;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s;
        font-weight: 600;
      }

      .nav-btn:hover {
        background: rgba(255, 51, 102, 0.2);
        border-color: #ff3366;
      }

      /* Scrollbar styling */
      ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
      }

      ::-webkit-scrollbar-track {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 4px;
      }

      ::-webkit-scrollbar-thumb {
        background: rgba(255, 51, 102, 0.5);
        border-radius: 4px;
      }

      ::-webkit-scrollbar-thumb:hover {
        background: rgba(255, 51, 102, 0.7);
      }
    </style>

    <!-- Credibility Badge Styles -->
    <style>
        a.credibility-badge {
            display: inline-block;
            margin: 10px auto 15px;
            background: rgba(20, 20, 20, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            padding: 8px 20px;
            border-radius: 12px;
            user-select: none;
            animation: subtlePulseBadge 2s ease-out;
            transition: all 0.3s ease-out;
            z-index: 10;
            text-decoration: none;
            color: inherit;
            overflow: hidden;
        }

        @keyframes subtlePulseBadge {
            0% {
                transform: scale(0.98);
                opacity: 0;
            }
            50% {
                opacity: 1;
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        .badge-top {
            font-size: 9px;
            letter-spacing: 2px;
            opacity: 0.7;
            margin-bottom: 4px;
            text-align: center;
            font-weight: 600;
        }

        .badge-main {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            position: relative;
        }

        .badge-icon {
            font-size: 14px;
            transition: transform 0.3s ease-out;
        }

        .badge-text {
            position: relative;
            height: 18px;
            width: 145px;
            display: flex;
            align-items: center;
            overflow: hidden;
        }

        .text-default,
        .text-hover {
            position: absolute;
            white-space: nowrap;
            transition: opacity 0.25s ease-out;
            width: 100%;
            text-align: center;
            left: 0;
        }

        .text-default {
            opacity: 1;
        }

        .text-hover {
            opacity: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
        }

        .hover-icon {
            font-size: 12px;
            animation: none;
        }

        a.credibility-badge:hover .text-default {
            opacity: 0;
        }

        a.credibility-badge:hover .text-hover {
            opacity: 1;
        }

        a.credibility-badge:hover .hover-icon {
            animation: heartBeatBadge 1s ease-out infinite;
        }

        @keyframes heartBeatBadge {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.1);
            }
        }

        a.credibility-badge:hover {
            background: rgba(30, 30, 30, 0.15);
            border-color: rgba(255, 255, 255, 0.15);
            transform: scale(1.02);
        }

        /* Mobile adjustments */
        @media (max-width: 768px) {
            a.credibility-badge {
                margin: 10px auto;
                transform: none;
            }

            a.credibility-badge:hover {
                transform: none;
            }

            .badge-main {
                cursor: default;
            }

            .text-hover {
                display: none;
            }

            @keyframes subtlePulseBadge {
                0% {
                    transform: scale(0.98);
                    opacity: 0;
                }
                50% {
                    opacity: 1;
                }
                100% {
                    transform: scale(1);
                    opacity: 1;
                }
            }
        }

        /* Very small mobile screens */
        @media (max-width: 480px) {
            a.credibility-badge {
                padding: 6px 12px;
            }

            .badge-top {
                font-size: 8px;
                letter-spacing: 1.5px;
            }

            .badge-main {
                font-size: 12px;
            }

            .badge-icon {
                font-size: 12px;
            }
        }
    </style>
  </head>
  <body>
    <!-- First Time User Overlay -->
    <div id="firstTimeOverlay" class="first-time-overlay" style="display: none;">
      <div class="first-time-content">
        <h2 class="first-time-title">Welcome to World Tour Tracker!</h2>
        <p style="color: #b0b0b0; margin-bottom: 1.5rem;">Get started in just 2 simple steps:</p>

        <div class="first-time-step">
          <div class="first-time-step-number">1</div>
          <div class="first-time-step-text">
            <strong style="color: #ff3366;">Select Your Goal Rank</strong><br>
            Choose your target rank from the dropdown menu
          </div>
        </div>

        <div class="first-time-step">
          <div class="first-time-step-number">2</div>
          <div class="first-time-step-text">
            <strong style="color: #ff3366;">Enter Your Current Points</strong><br>
            Tap the points field and enter your current World Tour points
          </div>
        </div>

        <button class="first-time-button" onclick="closeFirstTimeOverlay()">Get Started!</button>
      </div>
    </div>

    <!-- Help Button -->
    <button class="help-button" onclick="showHelp()" title="Need help?">?</button>
    <!-- Mobile Menu Button and Overlay -->
    <style>
        /* Main Navigation Bar Styles */
        .main-nav {
            background: linear-gradient(135deg, rgba(26, 26, 26, 0.98) 0%, rgba(13, 13, 13, 0.98) 100%);
            border-bottom: 2px solid rgba(255, 51, 102, 0.3);
            padding: 15px 20px;
            position: sticky;
            top: 0;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }
        
        .nav-links {
            display: flex;
            justify-content: center;
            gap: 30px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .nav-link {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            font-family: 'Inter', sans-serif;
            font-weight: 600;
            font-size: 0.95rem;
            letter-spacing: 1px;
            text-transform: uppercase;
            transition: all 0.3s ease;
            padding: 8px 15px;
            border-radius: 8px;
            position: relative;
        }
        
        .nav-link:hover {
            color: #ff3366;
            background: rgba(255, 51, 102, 0.1);
            transform: translateY(-2px);
        }
        
        .nav-link.active {
            color: #ff3366;
            background: rgba(255, 51, 102, 0.15);
        }
        
        .nav-link.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 15px;
            right: 15px;
            height: 2px;
            background: linear-gradient(90deg, transparent, #ff3366, transparent);
        }
        
        /* Hide mobile menu button on desktop */
        @media (min-width: 769px) {
            #menuBtn, #simpleMenu, #menuOverlay {
                display: none !important;
            }
        }
        
        /* Mobile styles */
        @media (max-width: 768px) {
            /* Hide desktop nav on mobile */
            .desktop-nav {
                display: none !important;
            }
            #simpleMenu {
                position: fixed;
                top: 0;
                left: -280px;
                width: 280px;
                height: 100vh;
                background: linear-gradient(135deg, #1a1a1a 0%, #0d0d0d 100%);
                z-index: 99999;
                transition: left 0.3s ease;
                padding-top: 60px;
                box-shadow: 5px 0 20px rgba(0,0,0,0.7);
                border-right: 2px solid rgba(255, 51, 102, 0.3);
            }
            #simpleMenu.show {
                left: 0;
            }
            #simpleMenu a {
                display: block;
                color: white;
                padding: 15px;
                border-bottom: 1px solid #333;
                text-decoration: none;
                transition: all 0.3s;
            }
            #simpleMenu a:hover {
                background: rgba(255, 51, 102, 0.1);
                padding-left: 25px;
            }
            #simpleMenu a.active {
                color: #ff3366;
                background: rgba(255, 51, 102, 0.15);
            }
            #menuBtn {
                position: fixed;
                top: 10px;
                left: 10px;
                z-index: 100000;
                background: rgba(26, 26, 26, 0.95);
                color: #ff3366;
                border: 1px solid rgba(255, 51, 102, 0.3);
                border-radius: 8px;
                padding: 10px 12px;
                cursor: pointer;
                font-size: 20px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.3);
                transition: all 0.3s;
            }
            #menuBtn:hover {
                background: rgba(255, 51, 102, 0.1);
                transform: scale(1.1);
            }
            
            /* Dark overlay */
            #menuOverlay {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0,0,0,0.5);
                z-index: 99998;
                display: none;
            }
            #menuOverlay.show {
                display: block;
            }
        }
    </style>
    
    <button id="menuBtn" onclick="document.getElementById('simpleMenu').classList.toggle('show'); document.getElementById('menuOverlay').classList.toggle('show')">â˜°</button>
    
    <div id="menuOverlay" onclick="document.getElementById('simpleMenu').classList.remove('show'); this.classList.remove('show')"></div>
    
    <div id="simpleMenu">
        <a href="/">LOADOUT GENERATOR</a>
        <a href="/ragequit/">RAGE QUIT</a>
        <a href="/wt-progress/" class="active">WORLD TOUR</a>
    </div>
    
    <!-- Navigation Bar (Desktop) -->
    <nav class="main-nav desktop-nav">
        <div class="nav-links desktop-nav-links">
            <a href="/" class="nav-link">LOADOUT GENERATOR</a>
            <a href="/wt-progress/" class="nav-link">WORLD TOUR</a>
            <a href="/wt-progress/manual.html" class="nav-link active">MANUAL MODE</a>
        </div>
    </nav>

    <div class="container">
      <!-- Hero Section -->
      <div style="text-align: center; max-width: 800px; margin: 1rem auto 1rem; padding: 2rem 1rem 0;">
        <h1 style="
          font-size: 2.5rem;
          font-weight: 800;
          background: linear-gradient(135deg, #ff3366 0%, #ff6699 50%, #6a1b9a 100%);
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          background-clip: text;
          margin: 0 0 0.5rem 0;
          text-transform: uppercase;
          letter-spacing: 2px;
          text-shadow: 0 0 40px rgba(255, 51, 102, 0.3);
        ">The Finals</h1>
        <h2 style="
          font-size: 1.8rem;
          font-weight: 700;
          color: #fff;
          margin: 0 0 1rem 0;
          letter-spacing: 3px;
          text-transform: uppercase;
        ">World Tour <span style="color: #ff3366;">Manual</span></h2>
        
        <div style="background: linear-gradient(135deg, #6a1b9a, #ff3366); padding: 8px 20px; border-radius: 20px; display: inline-block; margin-bottom: 1rem;">
          <span style="color: white; font-weight: 700; font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px;">âš™ï¸ Customize Your Season</span>
        </div>

        <p id="seasonDatesDisplay" style="font-size: 0.95rem; color: #b0b0b0; margin-bottom: 1rem;">
          Configure your season settings below
        </p>
      </div>
      
      <!-- Settings Panel -->
      <div id="settingsPanel" class="settings-panel" style="
        background: linear-gradient(135deg, rgba(106, 27, 154, 0.15), rgba(255, 51, 102, 0.1));
        border: 2px solid rgba(106, 27, 154, 0.5);
        border-radius: 16px;
        padding: 24px;
        margin: 0 auto 2rem;
        max-width: 900px;
      ">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 10px;">
          <h2 style="color: #ff3366; font-size: 1.5rem; margin: 0;">âš™ï¸ Season Settings</h2>
          <div style="display: flex; gap: 10px;">
            <button onclick="saveSettings()" style="
              background: linear-gradient(135deg, #6a1b9a, #ff3366);
              border: none;
              color: white;
              padding: 10px 24px;
              border-radius: 8px;
              font-weight: 700;
              cursor: pointer;
              font-size: 1rem;
            ">ðŸ’¾ Save Settings</button>
            <button onclick="resetToDefaults()" style="
              background: transparent;
              border: 2px solid #ff4757;
              color: #ff4757;
              padding: 10px 20px;
              border-radius: 8px;
              font-weight: 600;
              cursor: pointer;
              font-size: 0.9rem;
            ">Reset</button>
          </div>
        </div>
        
        <!-- Season Info -->
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 24px;">
          <div>
            <label style="color: #b0b0b0; font-size: 0.9rem; display: block; margin-bottom: 6px;">Season Name</label>
            <input type="text" id="settingSeasonName" value="Season 9" style="
              width: 100%;
              padding: 12px;
              background: rgba(0,0,0,0.4);
              border: 2px solid rgba(106, 27, 154, 0.5);
              border-radius: 8px;
              color: white;
              font-size: 1rem;
            ">
          </div>
          <div>
            <label style="color: #b0b0b0; font-size: 0.9rem; display: block; margin-bottom: 6px;">Start Date</label>
            <input type="date" id="settingStartDate" value="2025-12-10" style="
              width: 100%;
              padding: 12px;
              background: rgba(0,0,0,0.4);
              border: 2px solid rgba(106, 27, 154, 0.5);
              border-radius: 8px;
              color: white;
              font-size: 1rem;
            ">
          </div>
          <div>
            <label style="color: #b0b0b0; font-size: 0.9rem; display: block; margin-bottom: 6px;">End Date</label>
            <input type="date" id="settingEndDate" value="2026-03-18" style="
              width: 100%;
              padding: 12px;
              background: rgba(0,0,0,0.4);
              border: 2px solid rgba(106, 27, 154, 0.5);
              border-radius: 8px;
              color: white;
              font-size: 1rem;
            ">
          </div>
        </div>
        
        <!-- Point Values -->
        <div style="margin-bottom: 24px;">
          <h3 style="color: #ff6699; font-size: 1.1rem; margin-bottom: 12px;">ðŸ’° Point Values</h3>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
            <!-- Cashout/Ranked -->
            <div style="background: rgba(0,0,0,0.3); padding: 16px; border-radius: 10px; border: 1px solid rgba(106, 27, 154, 0.3);">
              <h4 style="color: #b0b0b0; font-size: 0.95rem; margin-bottom: 12px;">Cashout / Ranked</h4>
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                <div>
                  <label style="color: #888; font-size: 0.8rem;">Win</label>
                  <input type="number" id="cashoutWin" value="25" min="0" style="width: 100%; padding: 8px; background: rgba(0,0,0,0.5); border: 1px solid #6a1b9a; border-radius: 6px; color: #ff3366; font-weight: 700; text-align: center;">
                </div>
                <div>
                  <label style="color: #888; font-size: 0.8rem;">Lose Final</label>
                  <input type="number" id="cashoutLoseFinal" value="14" min="0" style="width: 100%; padding: 8px; background: rgba(0,0,0,0.5); border: 1px solid #6a1b9a; border-radius: 6px; color: #ff3366; font-weight: 700; text-align: center;">
                </div>
                <div>
                  <label style="color: #888; font-size: 0.8rem;">Round 2 KO</label>
                  <input type="number" id="cashoutRound2" value="6" min="0" style="width: 100%; padding: 8px; background: rgba(0,0,0,0.5); border: 1px solid #6a1b9a; border-radius: 6px; color: #ff3366; font-weight: 700; text-align: center;">
                </div>
                <div>
                  <label style="color: #888; font-size: 0.8rem;">Round 1 KO</label>
                  <input type="number" id="cashoutRound1" value="2" min="0" style="width: 100%; padding: 8px; background: rgba(0,0,0,0.5); border: 1px solid #6a1b9a; border-radius: 6px; color: #ff3366; font-weight: 700; text-align: center;">
                </div>
              </div>
            </div>
            
            <!-- Quickplay -->
            <div style="background: rgba(0,0,0,0.3); padding: 16px; border-radius: 10px; border: 1px solid rgba(106, 27, 154, 0.3);">
              <h4 style="color: #b0b0b0; font-size: 0.95rem; margin-bottom: 12px;">Quickplay</h4>
              <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px;">
                <div>
                  <label style="color: #888; font-size: 0.8rem;">1st Place</label>
                  <input type="number" id="qp1st" value="4" min="0" style="width: 100%; padding: 8px; background: rgba(0,0,0,0.5); border: 1px solid #6a1b9a; border-radius: 6px; color: #ff3366; font-weight: 700; text-align: center;">
                </div>
                <div>
                  <label style="color: #888; font-size: 0.8rem;">2nd Place</label>
                  <input type="number" id="qp2nd" value="3" min="0" style="width: 100%; padding: 8px; background: rgba(0,0,0,0.5); border: 1px solid #6a1b9a; border-radius: 6px; color: #ff3366; font-weight: 700; text-align: center;">
                </div>
                <div>
                  <label style="color: #888; font-size: 0.8rem;">3rd Place</label>
                  <input type="number" id="qp3rd" value="2" min="0" style="width: 100%; padding: 8px; background: rgba(0,0,0,0.5); border: 1px solid #6a1b9a; border-radius: 6px; color: #ff3366; font-weight: 700; text-align: center;">
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Rank Requirements (Collapsible) -->
        <details style="background: rgba(0,0,0,0.2); border-radius: 10px; padding: 0;">
          <summary style="padding: 16px; cursor: pointer; color: #ff6699; font-weight: 600; font-size: 1.1rem; list-style: none; display: flex; align-items: center; gap: 8px;">
            <span style="transition: transform 0.2s;">â–¶</span> ðŸ† Rank Point Requirements (click to expand)
          </summary>
          <div style="padding: 0 16px 16px; display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 8px;" id="rankInputsContainer">
            <!-- Rank inputs will be generated by JavaScript -->
          </div>
        </details>
      </div>

      <!-- Main Container -->
      <div class="container">
        <!-- Track Your Progress Section -->
        <div class="track-progress-section">
          <div class="track-progress-header">
            <h2 style="font-size: 2em; background: linear-gradient(135deg, #6a1b9a, #ff3366); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 30px;">Track Your Progress</h2>
          </div>

          <div class="setup-container">
            <div class="setup-step scroll-reveal">
              <div class="step-number">1</div>
              <h3 class="step-title">Select Your S9 Goal</h3>
              <div class="goal-selector" style="min-height: 100px; display: flex; align-items: center; justify-content: center;">
                <select id="goalSelect" class="goal-select" onchange="updateGoal()">
                  <!-- Options will be populated by JavaScript -->
                </select>
              </div>
            </div>

            <div class="setup-step scroll-reveal">
              <div class="step-number">2</div>
              <h3 class="step-title">Enter Current Points</h3>
              <div class="points-input-container" id="pointsInputContainer">
                <!-- Floating sparkles animation -->
                <div class="sparkles-wrapper">
                  <i class="sparkle"></i>
                  <i class="sparkle"></i>
                  <i class="sparkle"></i>
                  <i class="sparkle"></i>
                  <i class="sparkle"></i>
                  <i class="sparkle"></i>
                  <i class="sparkle"></i>
                  <i class="sparkle"></i>
                  <i class="sparkle"></i>
                  <i class="sparkle"></i>
                </div>
                <input
                  type="number"
                  id="currentPoints"
                  class="points-input"
                  value="0"
                  min="0"
                  max="2400"
                  aria-label="Current points"
                  title="Click to edit your current points"
                  placeholder="0"
                />
                <div class="input-hint">Tap to update your points</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Stats Grid -->
        <div class="stats-grid">

        <div class="stats-column scroll-reveal">
          <div class="stat-card half-height">
            <div class="stat-icon" style="font-size: 2em; margin-bottom: 10px;">ðŸ“…</div>
            <div class="stat-label" id="daysRemainingLabel">Days Remaining</div>
            <div class="stat-value" id="daysRemaining" style="font-size: 3.2rem;">--</div>
            <div class="stat-subtitle" id="seasonEndDate" style="font-size: 1.1rem; color: #888; margin-top: 5px;">--</div>
          </div>
          <div class="stat-card half-height">
            <div class="stat-icon" style="font-size: 2em; margin-bottom: 10px;">ðŸŽ¯</div>
            <div class="stat-label">Points to Next Rank</div>
            <div class="stat-value" id="pointsToNext" style="font-size: 3.2rem;">
              <span class="next-rank-points">--</span>
            </div>
            <div class="stat-subtitle next-rank-name" style="font-size: 1.1rem; color: #888; margin-top: 5px;">--</div>
          </div>
        </div>

        <div class="stat-card primary" style="position: relative;">
          <div class="stat-icon" style="font-size: 2em; margin-bottom: 10px;">â¬‡ï¸</div>
          <div class="stat-label">Daily Points Needed
            <span class="tooltip-icon">?</span>
            <div class="tooltip-content" data-tooltip-type="daily">
              <div style="color: #ff3366; font-weight: 700; margin-bottom: 12px; font-size: 1.1rem;">ðŸŽ¯ Your Daily Target</div>
              <div style="color: #e0e0e0;">
                <strong style="color: #ff6699;">What it shows:</strong><br>
                How many points you need to earn each day (on average) to reach your goal by the end of the season.
                <br><br>
                <strong style="color: #ff6699;">The math:</strong><br>
                (Goal Points âˆ’ Your Points) Ã· Days Left
                <br><br>
                <strong style="color: #ff6699;">Example:</strong><br>
                Goal: <span style="color: #fff;">2,400 points</span><br>
                You have: <span style="color: #fff;">600 points</span><br>
                Days left: <span style="color: #fff;">60 days</span><br>
                (2,400 âˆ’ 600) Ã· 60 = <span style="color: #ff3366; font-weight: 700;">30 pts/day</span>
                <br><br>
                <em style="color: #888;">Hit this daily, and you'll reach your goal!</em>
              </div>
            </div>
          </div>
          <div class="stat-value" id="pointsPerDay" style="font-size: 3.5rem;">--</div>
          <div class="stat-subtitle" id="dailyGoalStatus" style="font-size: 1.1rem; color: #ff3366; margin-top: 10px;"></div>
          <div class="goal-breakdown" id="goalBreakdown"></div>
        </div>

        <div class="stats-column scroll-reveal">
          <div class="stat-card half-height" style="position: relative; z-index: 1000 !important;">
            <div class="stat-icon" style="font-size: 2em; margin-bottom: 10px;">ðŸ“ˆ</div>
            <div class="stat-label">Projected Completion
              <span class="tooltip-icon">?</span>
              <div class="tooltip-content" data-tooltip-type="projected">
                <div style="color: #ff3366; font-weight: 700; margin-bottom: 12px; font-size: 1.1rem;">ðŸ“ˆ Will You Reach Your Goal?</div>
                <div style="color: #e0e0e0;">
                  <strong style="color: #ff6699;">What it shows:</strong><br>
                  If you keep playing at your current pace, will you hit your goal by the end of the season?
                  <br><br>
                  <strong style="color: #ff6699;">How we calculate it:</strong><br>
                  1. We look at how many points you earn per day on average<br>
                  2. We multiply that by the total season days<br>
                  3. We compare that to your goal
                  <br><br>
                  <strong style="color: #ff6699;">Example:</strong><br>
                  You average <span style="color: #fff;">30 points/day</span><br>
                  Season is <span style="color: #fff;">98 days</span> = 2,940 total points<br>
                  Goal is <span style="color: #fff;">2,400 points</span><br>
                  <span style="color: #ff3366; font-weight: 700;">2,940 Ã· 2,400 = 122%</span> ðŸŽ‰
                  <br><br>
                  <em style="color: #888;">Over 100% = You're on track!</em>
                </div>
              </div>
            </div>
            <div class="stat-value" id="completion" style="font-size: 3.2rem;">--</div>
            <div class="stat-subtitle" id="completionStatus" style="font-size: 1.1rem; color: #ff3366; margin-top: 5px;"></div>
          </div>
          <div class="stat-card half-height" style="position: relative;">
            <div class="stat-icon" style="font-size: 2em; margin-bottom: 10px;">ðŸ“†</div>
            <div class="stat-label">Est. Completion Date
              <span class="tooltip-icon">?</span>
              <div class="tooltip-content" data-tooltip-type="completion">
                <div style="color: #ff3366; font-weight: 700; margin-bottom: 12px; font-size: 1.1rem;">ðŸ“† When Will You Reach Your Goal?</div>
                <div style="color: #e0e0e0;">
                  <strong style="color: #ff6699;">What it shows:</strong><br>
                  The date you'll hit your goal if you keep playing at your current pace.
                  <br><br>
                  <strong style="color: #ff6699;">How we calculate it:</strong><br>
                  1. Points still needed Ã· your daily average<br>
                  2. = Days until you reach your goal<br>
                  3. Add those days to today's date
                  <br><br>
                  <strong style="color: #ff6699;">Example:</strong><br>
                  You need <span style="color: #fff;">1,800 more points</span><br>
                  You average <span style="color: #fff;">30 points/day</span><br>
                  1,800 Ã· 30 = <span style="color: #fff;">60 days</span><br>
                  <span style="color: #ff3366; font-weight: 700;">Goal date: 60 days from now!</span>
                  <br><br>
                  <em style="color: #888;">Green = Before season ends âœ“</em>
                </div>
              </div>
            </div>
            <div class="stat-value" id="completionDate" style="font-size: 3.2rem;">--</div>
          </div>
        </div>
      </div>

        <!-- Add Match Results Section -->
        <div class="match-results-section scroll-reveal">
        <h2>Add Match Results</h2>
        
        <!-- Mode Toggle -->
        <div class="mode-toggle" style="display: flex; gap: 10px; margin-bottom: 20px; justify-content: center;">
          <button id="cashoutModeBtn" class="mode-btn active" onclick="setMatchMode('cashout')" style="
            flex: 1;
            max-width: 200px;
            padding: 12px 20px;
            background: linear-gradient(135deg, #6a1b9a, #ff3366);
            border: 2px solid #6a1b9a;
            border-radius: 10px;
            color: white;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(106, 27, 154, 0.4);
          ">
            ðŸ’° Cashout / Ranked
          </button>
          <button id="quickplayModeBtn" class="mode-btn" onclick="setMatchMode('quickplay')" style="
            flex: 1;
            max-width: 200px;
            padding: 12px 20px;
            background: transparent;
            border: 2px solid rgba(106, 27, 154, 0.3);
            border-radius: 10px;
            color: #888;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
          ">
            âš¡ Quickplay
          </button>
        </div>
        
        <!-- Cashout/Ranked Buttons -->
        <div id="cashoutButtons" class="quick-actions">
          <button class="quick-action-btn win" onclick="quickAddPoints(25, 'win')">
            <span class="quick-action-icon icon-text">W</span>
            <span class="quick-action-label">Win</span>
            <span class="quick-action-points">+25</span>
          </button>
          <button class="quick-action-btn third" onclick="quickAddPoints(14, 'loseFinal')">
            <span class="quick-action-icon icon-text">2</span>
            <span class="quick-action-label">Lose Final</span>
            <span class="quick-action-points">+14</span>
          </button>
          <button class="quick-action-btn qualified" onclick="quickAddPoints(6, 'round2')">
            <span class="quick-action-icon icon-text">R2</span>
            <span class="quick-action-label">Round 2 KO</span>
            <span class="quick-action-points">+6</span>
          </button>
          <button class="quick-action-btn eliminated" onclick="quickAddPoints(2, 'round1')">
            <span class="quick-action-icon icon-text">R1</span>
            <span class="quick-action-label">Round 1 KO</span>
            <span class="quick-action-points">+2</span>
          </button>
          <button id="undoButton" class="quick-action-btn undo" onclick="undoLastAdd()">
            <span class="quick-action-icon">â†</span>
            <span class="quick-action-label">Undo</span>
            <span class="quick-action-points" id="undoPoints">-0</span>
          </button>
        </div>
        
        <!-- Quickplay Buttons (hidden by default) -->
        <div id="quickplayButtons" class="quick-actions" style="display: none;">
          <button class="quick-action-btn win" onclick="quickAddPoints(4, 'qp1st')">
            <span class="quick-action-icon icon-text">1</span>
            <span class="quick-action-label">1st Place</span>
            <span class="quick-action-points">+4</span>
          </button>
          <button class="quick-action-btn second" onclick="quickAddPoints(3, 'qp2nd')">
            <span class="quick-action-icon icon-text">2</span>
            <span class="quick-action-label">2nd Place</span>
            <span class="quick-action-points">+3</span>
          </button>
          <button class="quick-action-btn third" onclick="quickAddPoints(2, 'qp3rd')">
            <span class="quick-action-icon icon-text">3</span>
            <span class="quick-action-label">3rd Place</span>
            <span class="quick-action-points">+2</span>
          </button>
          <button id="undoButtonQP" class="quick-action-btn undo" onclick="undoLastAdd()">
            <span class="quick-action-icon">â†</span>
            <span class="quick-action-label">Undo</span>
            <span class="quick-action-points" id="undoPointsQP">-0</span>
          </button>
        </div>
        </div>
        
        <script>
          // Match mode toggle
          let currentMatchMode = 'cashout';
          
          function setMatchMode(mode) {
            currentMatchMode = mode;
            const cashoutBtn = document.getElementById('cashoutModeBtn');
            const quickplayBtn = document.getElementById('quickplayModeBtn');
            const cashoutBtns = document.getElementById('cashoutButtons');
            const quickplayBtns = document.getElementById('quickplayButtons');
            
            if (mode === 'cashout') {
              cashoutBtn.style.background = 'linear-gradient(135deg, #6a1b9a, #ff3366)';
              cashoutBtn.style.borderColor = '#6a1b9a';
              cashoutBtn.style.color = 'white';
              cashoutBtn.style.boxShadow = '0 4px 15px rgba(106, 27, 154, 0.4)';
              quickplayBtn.style.background = 'transparent';
              quickplayBtn.style.borderColor = 'rgba(106, 27, 154, 0.3)';
              quickplayBtn.style.color = '#888';
              quickplayBtn.style.boxShadow = 'none';
              cashoutBtns.style.display = 'grid';
              quickplayBtns.style.display = 'none';
            } else {
              quickplayBtn.style.background = 'linear-gradient(135deg, #6a1b9a, #ff3366)';
              quickplayBtn.style.borderColor = '#6a1b9a';
              quickplayBtn.style.color = 'white';
              quickplayBtn.style.boxShadow = '0 4px 15px rgba(106, 27, 154, 0.4)';
              cashoutBtn.style.background = 'transparent';
              cashoutBtn.style.borderColor = 'rgba(106, 27, 154, 0.3)';
              cashoutBtn.style.color = '#888';
              cashoutBtn.style.boxShadow = 'none';
              cashoutBtns.style.display = 'none';
              quickplayBtns.style.display = 'grid';
            }
          }
        </script>

        <!-- Progress Section -->
        <div class="progress-section scroll-reveal" style="position: relative;">
        <h2 id="progressTitle" style="display: inline-flex; align-items: center; gap: 8px;">
          Progress to Goal
          <span class="tooltip-icon">?</span>
          <div class="tooltip-content" data-tooltip-type="progress">
            <div style="color: #ff3366; font-weight: 700; margin-bottom: 12px; font-size: 1.1rem;">ðŸ“Š How This Progress Bar Works</div>
            <div style="color: #e0e0e0;">
              <strong style="color: #ff6699;">What it shows:</strong><br>
              How close you are to your goal rank right now.
              <br><br>
              <strong style="color: #ff6699;">The math:</strong><br>
              Your Points Ã· Goal Points Ã— 100
              <br><br>
              <strong style="color: #ff6699;">Example:</strong><br>
              If you have <span style="color: #fff;">600 points</span> and your goal is <span style="color: #fff;">2400 points</span>:<br>
              600 Ã· 2400 = <span style="color: #ff3366; font-weight: 700;">25%</span> complete!
            </div>
          </div>
        </h2>
        <div class="progress-container">
          <div id="progressBar" class="progress-bar" style="width: 0%"></div>
          <div id="progressText" class="progress-text">0%</div>
          <div class="progress-milestones" id="progressMilestones">
            <!-- Milestone markers will be added dynamically -->
          </div>
        </div>
        <div class="pace-indicator" id="paceIndicator">Calculating pace...</div>
        </div>

        <!-- Rank Ladder -->
        <div class="rank-ladder">
          <h2>Rank Progression</h2>
          <div id="rankLadder"></div>
        </div>

        <!-- Hidden placeholder for daily entries (used by JS) -->
        <div id="entriesList" style="display: none;"></div>
        <input type="hidden" id="dateInput" />
        <input type="hidden" id="pointsInput" />
        <input type="hidden" id="notesInput" />

        </div>
    </div>

    <!-- Last Updated Indicator -->
    <div class="last-updated" id="lastUpdated">
      Last updated: just now
    </div>

    <!-- Notification -->
    <div id="notification" class="notification"></div>

    <script>
      // ========== MANUAL MODE - CONFIGURABLE SETTINGS ==========
      
      // Default values (used if no saved settings)
      const DEFAULT_SETTINGS = {
        seasonName: 'Season 9',
        startDate: '2025-12-10',
        endDate: '2026-03-18',
        cashout: { win: 25, loseFinal: 14, round2: 6, round1: 2 },
        quickplay: { first: 4, second: 3, third: 2 },
        rankPoints: {
          'Bronze IV': 25, 'Bronze III': 50, 'Bronze II': 75, 'Bronze I': 100,
          'Silver IV': 150, 'Silver III': 200, 'Silver II': 250, 'Silver I': 300,
          'Gold IV': 375, 'Gold III': 450, 'Gold II': 525, 'Gold I': 600,
          'Platinum IV': 700, 'Platinum III': 800, 'Platinum II': 900, 'Platinum I': 1000,
          'Diamond IV': 1150, 'Diamond III': 1300, 'Diamond II': 1450, 'Diamond I': 1600,
          'Emerald IV': 1800, 'Emerald III': 2000, 'Emerald II': 2200, 'Emerald I': 2400
        }
      };
      
      // Load settings from localStorage or use defaults
      function loadSettings() {
        try {
          const saved = localStorage.getItem('manualModeSettings');
          if (saved) {
            return { ...DEFAULT_SETTINGS, ...JSON.parse(saved) };
          }
        } catch (e) {
          console.error('Error loading settings:', e);
        }
        return DEFAULT_SETTINGS;
      }
      
      // Current settings
      let settings = loadSettings();
      console.log('Loaded settings:', settings);
      
      // Dynamic configuration based on settings
      const STORAGE_VERSION = 'manual-v1';
      let SEASON_START_DATE = settings.startDate;
      let SEASON_END_DATE = settings.endDate;
      let SEASON_DAYS = Math.ceil((new Date(SEASON_END_DATE) - new Date(SEASON_START_DATE)) / (1000 * 60 * 60 * 24));
      console.log('Season dates:', SEASON_START_DATE, 'to', SEASON_END_DATE, '=', SEASON_DAYS, 'days');
      
      // Rank definitions with tier info
      const RANK_DEFINITIONS = [
        { name: "Bronze IV", icon: "B4", color: "#CD7F32", tier: "bronze" },
        { name: "Bronze III", icon: "B3", color: "#CD7F32", tier: "bronze" },
        { name: "Bronze II", icon: "B2", color: "#CD7F32", tier: "bronze" },
        { name: "Bronze I", icon: "B1", color: "#CD7F32", tier: "bronze" },
        { name: "Silver IV", icon: "S4", color: "#C0C0C0", tier: "silver" },
        { name: "Silver III", icon: "S3", color: "#C0C0C0", tier: "silver" },
        { name: "Silver II", icon: "S2", color: "#C0C0C0", tier: "silver" },
        { name: "Silver I", icon: "S1", color: "#C0C0C0", tier: "silver" },
        { name: "Gold IV", icon: "G4", color: "#FFD700", tier: "gold" },
        { name: "Gold III", icon: "G3", color: "#FFD700", tier: "gold" },
        { name: "Gold II", icon: "G2", color: "#FFD700", tier: "gold" },
        { name: "Gold I", icon: "G1", color: "#FFD700", tier: "gold" },
        { name: "Platinum IV", icon: "P4", color: "#E5E4E2", tier: "platinum" },
        { name: "Platinum III", icon: "P3", color: "#E5E4E2", tier: "platinum" },
        { name: "Platinum II", icon: "P2", color: "#E5E4E2", tier: "platinum" },
        { name: "Platinum I", icon: "P1", color: "#E5E4E2", tier: "platinum" },
        { name: "Diamond IV", icon: "D4", color: "#B9F2FF", tier: "diamond" },
        { name: "Diamond III", icon: "D3", color: "#B9F2FF", tier: "diamond" },
        { name: "Diamond II", icon: "D2", color: "#B9F2FF", tier: "diamond" },
        { name: "Diamond I", icon: "D1", color: "#B9F2FF", tier: "diamond" },
        { name: "Emerald IV", icon: "E4", color: "#ff3366", tier: "emerald" },
        { name: "Emerald III", icon: "E3", color: "#ff3366", tier: "emerald" },
        { name: "Emerald II", icon: "E2", color: "#ff3366", tier: "emerald" },
        { name: "Emerald I", icon: "E1", color: "#ff3366", tier: "emerald" }
      ];
      
      // Build ranks array from settings
      let ranks = RANK_DEFINITIONS.map(r => ({
        ...r,
        points: settings.rankPoints[r.name] || DEFAULT_SETTINGS.rankPoints[r.name]
      }));
      
      // Point values for quick add buttons
      let pointValues = {
        cashout: { ...settings.cashout },
        quickplay: { ...settings.quickplay }
      };
      
      // Save settings to localStorage
      function saveSettings() {
        try {
          // Read values from inputs
          settings.seasonName = document.getElementById('settingSeasonName').value;
          settings.startDate = document.getElementById('settingStartDate').value;
          settings.endDate = document.getElementById('settingEndDate').value;
          
          // Cashout points
          settings.cashout.win = parseInt(document.getElementById('cashoutWin').value) || 25;
          settings.cashout.loseFinal = parseInt(document.getElementById('cashoutLoseFinal').value) || 14;
          settings.cashout.round2 = parseInt(document.getElementById('cashoutRound2').value) || 6;
          settings.cashout.round1 = parseInt(document.getElementById('cashoutRound1').value) || 2;
          
          // Quickplay points
          settings.quickplay.first = parseInt(document.getElementById('qp1st').value) || 4;
          settings.quickplay.second = parseInt(document.getElementById('qp2nd').value) || 3;
          settings.quickplay.third = parseInt(document.getElementById('qp3rd').value) || 2;
          
          // Rank points
          RANK_DEFINITIONS.forEach(r => {
            const input = document.getElementById('rank_' + r.name.replace(/\s/g, '_'));
            if (input) {
              settings.rankPoints[r.name] = parseInt(input.value) || DEFAULT_SETTINGS.rankPoints[r.name];
            }
          });
          
          // Save to localStorage
          localStorage.setItem('manualModeSettings', JSON.stringify(settings));
          
          // Update runtime values
          SEASON_START_DATE = settings.startDate;
          SEASON_END_DATE = settings.endDate;
          SEASON_DAYS = Math.ceil((new Date(SEASON_END_DATE) - new Date(SEASON_START_DATE)) / (1000 * 60 * 60 * 24));
          console.log('Updated season dates:', SEASON_START_DATE, 'to', SEASON_END_DATE, '=', SEASON_DAYS, 'days');
          
          // Rebuild ranks array
          ranks = RANK_DEFINITIONS.map(r => ({
            ...r,
            points: settings.rankPoints[r.name]
          }));
          
          // Update point values
          pointValues.cashout = { ...settings.cashout };
          pointValues.quickplay = { ...settings.quickplay };
          
          // Show notification and refresh page to apply all changes
          showNotification('âœ… Settings saved! Refreshing...', 'success');
          
          // Refresh after a short delay so user sees the notification
          setTimeout(() => {
            window.location.reload();
          }, 800);
        } catch (e) {
          console.error('Error saving settings:', e);
          showNotification('âŒ Error saving settings', 'error');
        }
      }
      
      // Reset to defaults
      function resetToDefaults() {
        if (confirm('Reset all settings to Season 9 defaults? Your current points will be preserved.')) {
          localStorage.removeItem('manualModeSettings');
          settings = { ...DEFAULT_SETTINGS };
          populateSettingsInputs();
          saveSettings();
          showNotification('Settings reset to defaults', 'success');
        }
      }
      
      // Populate settings inputs from current settings
      function populateSettingsInputs() {
        document.getElementById('settingSeasonName').value = settings.seasonName;
        document.getElementById('settingStartDate').value = settings.startDate;
        document.getElementById('settingEndDate').value = settings.endDate;
        
        document.getElementById('cashoutWin').value = settings.cashout.win;
        document.getElementById('cashoutLoseFinal').value = settings.cashout.loseFinal;
        document.getElementById('cashoutRound2').value = settings.cashout.round2;
        document.getElementById('cashoutRound1').value = settings.cashout.round1;
        
        document.getElementById('qp1st').value = settings.quickplay.first;
        document.getElementById('qp2nd').value = settings.quickplay.second;
        document.getElementById('qp3rd').value = settings.quickplay.third;
        
        // Generate rank inputs
        const container = document.getElementById('rankInputsContainer');
        container.innerHTML = RANK_DEFINITIONS.map(r => `
          <div style="display: flex; flex-direction: column; gap: 4px;">
            <label style="color: #888; font-size: 0.75rem;">${r.name}</label>
            <input type="number" id="rank_${r.name.replace(/\s/g, '_')}" 
                   value="${settings.rankPoints[r.name]}" min="0"
                   style="padding: 8px; background: rgba(0,0,0,0.5); border: 1px solid #6a1b9a; 
                          border-radius: 6px; color: #ff3366; font-weight: 700; text-align: center;">
          </div>
        `).join('');
      }
      
      // Update season dates display
      function updateSeasonDisplay() {
        const start = new Date(settings.startDate);
        const end = new Date(settings.endDate);
        const days = Math.ceil((end - start) / (1000 * 60 * 60 * 24));
        
        // Update hero section
        const display = document.getElementById('seasonDatesDisplay');
        if (display) {
          display.textContent = `${settings.seasonName}: ${start.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' })} - ${end.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' })} â€¢ ${days} Days`;
        }
        
        // Update "Days Remaining" label
        const daysLabel = document.getElementById('daysRemainingLabel');
        if (daysLabel) {
          daysLabel.textContent = `Days Remaining in ${settings.seasonName}`;
        }
        
        // Update "Season ends" subtitle
        const seasonEndEl = document.getElementById('seasonEndDate');
        if (seasonEndEl) {
          seasonEndEl.textContent = `Season ends ${end.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}`;
        }
      }
      
      // Update quick add buttons with current point values
      function updateQuickAddButtons() {
        // Cashout buttons
        const cashoutBtns = document.querySelectorAll('#cashoutButtons .quick-action-btn');
        if (cashoutBtns.length >= 4) {
          cashoutBtns[0].querySelector('.quick-action-points').textContent = '+' + pointValues.cashout.win;
          cashoutBtns[0].onclick = () => quickAddPoints(pointValues.cashout.win, 'win');
          
          cashoutBtns[1].querySelector('.quick-action-points').textContent = '+' + pointValues.cashout.loseFinal;
          cashoutBtns[1].onclick = () => quickAddPoints(pointValues.cashout.loseFinal, 'loseFinal');
          
          cashoutBtns[2].querySelector('.quick-action-points').textContent = '+' + pointValues.cashout.round2;
          cashoutBtns[2].onclick = () => quickAddPoints(pointValues.cashout.round2, 'round2');
          
          cashoutBtns[3].querySelector('.quick-action-points').textContent = '+' + pointValues.cashout.round1;
          cashoutBtns[3].onclick = () => quickAddPoints(pointValues.cashout.round1, 'round1');
        }
        
        // Quickplay buttons
        const qpBtns = document.querySelectorAll('#quickplayButtons .quick-action-btn');
        if (qpBtns.length >= 3) {
          qpBtns[0].querySelector('.quick-action-points').textContent = '+' + pointValues.quickplay.first;
          qpBtns[0].onclick = () => quickAddPoints(pointValues.quickplay.first, 'qp1st');
          
          qpBtns[1].querySelector('.quick-action-points').textContent = '+' + pointValues.quickplay.second;
          qpBtns[1].onclick = () => quickAddPoints(pointValues.quickplay.second, 'qp2nd');
          
          qpBtns[2].querySelector('.quick-action-points').textContent = '+' + pointValues.quickplay.third;
          qpBtns[2].onclick = () => quickAddPoints(pointValues.quickplay.third, 'qp3rd');
        }
      }

      // Storage Management with Versioning
      class StorageManager {
        constructor() {
          this.cache = {};
          this.cacheTimestamps = {};
          this.CACHE_TTL = 5 * 60 * 1000; // 5 minutes
          this.initializeStorage();
        }

        initializeStorage() {
          try {
            const version = localStorage.getItem('cacheVersion');
            
            if (version !== STORAGE_VERSION) {
              this.migrateData(version);
            }

            // Initialize with defaults if needed
            this.ensureDefaults();
            
            // Update last visit
            localStorage.setItem('lastVisit', Date.now().toString());
            
          } catch (error) {
            console.error('Storage initialization error:', error);
            this.handleStorageError(error);
          }
        }

        migrateData(oldVersion) {
          if (!oldVersion) {
            // Fresh install
            this.clearStorage();
          } else if (oldVersion === 'v7.0') {
            // Migrate from Season 7
            const shouldMigrate = confirm('Previous season data detected. Would you like to convert your progress proportionally to Season 9? (Cancel for fresh start)');
            
            if (shouldMigrate) {
              this.migrateFromSeason7();
            } else {
              this.clearStorage();
            }
          }
          
          localStorage.setItem('cacheVersion', STORAGE_VERSION);
        }

        migrateFromSeason7() {
          try {
            const oldPoints = parseInt(localStorage.getItem('currentPoints') || '0');
            // Proportional conversion: Previous season max was 2400, S9 max is 2400
            const conversionRatio = 2400 / 2400;
            const newPoints = Math.round(oldPoints * conversionRatio);
            
            localStorage.setItem('currentPoints', newPoints.toString());
            
            // Clear old daily entries as they won't match new point system
            localStorage.removeItem('dailyEntries');
            
            showNotification(`Migrated to Season 9! Your ${oldPoints} points converted to ${newPoints} points.`, 'success');
          } catch (error) {
            console.error('Migration error:', error);
            this.clearStorage();
          }
        }

        ensureDefaults() {
          const defaults = {
            currentPoints: '0',
            selectedGoal: 'Emerald I',
            dailyEntries: '[]',
            undoHistory: '[]',
            seasonStartDate: SEASON_START_DATE,
            seasonEndDate: SEASON_END_DATE,
            cacheVersion: STORAGE_VERSION
          };

          for (const [key, value] of Object.entries(defaults)) {
            if (!localStorage.getItem(key)) {
              localStorage.setItem(key, value);
            }
          }
        }

        get(key, defaultValue = null) {
          try {
            // Check cache first
            if (this.cache[key] && this.cacheTimestamps[key]) {
              const age = Date.now() - this.cacheTimestamps[key];
              if (age < this.CACHE_TTL) {
                return this.cache[key];
              }
            }

            const value = localStorage.getItem(key);
            if (value === null) return defaultValue;

            // Try to parse JSON
            try {
              const parsed = JSON.parse(value);
              this.cache[key] = parsed;
              this.cacheTimestamps[key] = Date.now();
              return parsed;
            } catch {
              return value;
            }
          } catch (error) {
            console.error(`Error getting ${key}:`, error);
            return defaultValue;
          }
        }

        set(key, value) {
          try {
            const stringValue = typeof value === 'string' ? value : JSON.stringify(value);
            
            // Compress large data
            if (key === 'dailyEntries' && stringValue.length > 10000) {
              this.compressEntries();
            }
            
            localStorage.setItem(key, stringValue);
            this.cache[key] = value;
            this.cacheTimestamps[key] = Date.now();
            
            // Update last updated time
            this.updateLastUpdated();
            
            return true;
          } catch (error) {
            if (error.name === 'QuotaExceededError') {
              this.handleQuotaExceeded();
            }
            console.error(`Error setting ${key}:`, error);
            return false;
          }
        }

        compressEntries() {
          const entries = this.get('dailyEntries', []);
          if (entries.length > 50) {
            // Keep only last 50 entries
            const compressed = entries.slice(-50);
            localStorage.setItem('dailyEntries', JSON.stringify(compressed));
            showNotification('Compressed old entries to save space', 'info');
          }
        }

        handleQuotaExceeded() {
          // Clear old data
          const entries = this.get('dailyEntries', []);
          if (entries.length > 10) {
            const recent = entries.slice(-10);
            this.set('dailyEntries', recent);
            showNotification('Cleared old entries due to storage limit', 'info');
          }
        }

        handleStorageError(error) {
          console.error('Storage error:', error);
          if (confirm('Storage error detected. Reset data?')) {
            this.clearStorage();
            location.reload();
          }
        }

        clearStorage() {
          const keysToKeep = ['cacheVersion'];
          const allKeys = Object.keys(localStorage);
          
          allKeys.forEach(key => {
            if (!keysToKeep.includes(key)) {
              localStorage.removeItem(key);
            }
          });
          
          this.cache = {};
          this.cacheTimestamps = {};
        }

        updateLastUpdated() {
          const now = Date.now();
          const lastVisit = parseInt(localStorage.getItem('lastVisit') || '0');
          const diff = now - lastVisit;
          
          let text = 'Last updated: ';
          if (diff < 60000) {
            text += 'just now';
          } else if (diff < 3600000) {
            text += `${Math.floor(diff / 60000)} minutes ago`;
          } else if (diff < 86400000) {
            text += `${Math.floor(diff / 3600000)} hours ago`;
          } else {
            text += `${Math.floor(diff / 86400000)} days ago`;
          }
          
          const element = document.getElementById('lastUpdated');
          if (element) {
            element.textContent = text;
          }
        }
      }

      // Initialize storage manager
      const storage = new StorageManager();

      // Global state
      let currentPoints = 0;
      let selectedGoal = 'Emerald I';
      let dailyEntries = [];
      let undoHistory = [];
      let daysRemaining = 0;
      let isUpdating = false;

      // Debounce function
      function debounce(func, wait) {
        let timeout;
        return function executedFunction(...args) {
          const later = () => {
            clearTimeout(timeout);
            func(...args);
          };
          clearTimeout(timeout);
          timeout = setTimeout(later, wait);
        };
      }

      // Initialize on load
      document.addEventListener('DOMContentLoaded', () => {
        // Initialize Manual Mode settings panel
        populateSettingsInputs();
        updateSeasonDisplay();
        updateQuickAddButtons();
        
        // Scroll Reveal Animation
        const observerOptions = {
          threshold: 0.1,
          rootMargin: '0px 0px -50px 0px'
        };

        const scrollObserver = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              entry.target.classList.add('revealed');
            }
          });
        }, observerOptions);

        // Observe all elements with scroll-reveal class
        setTimeout(() => {
          document.querySelectorAll('.scroll-reveal').forEach(el => {
            scrollObserver.observe(el);
          });
        }, 100);
        initializeApp();
        checkFirstTimeUser();
        addInteractiveHighlights();

        // Simple tooltip system - click to toggle, centered modal style
        function initTooltips() {
          const icons = document.querySelectorAll('.tooltip-icon');
          console.log('Found tooltip icons:', icons.length);
          
          icons.forEach((icon, index) => {
            const tooltip = icon.nextElementSibling;
            console.log('Icon', index, 'tooltip:', tooltip?.classList?.contains('tooltip-content'));
            
            if (tooltip && tooltip.classList.contains('tooltip-content')) {
              // Add close button if not already present
              if (!tooltip.querySelector('.tooltip-close')) {
                const closeBtn = document.createElement('button');
                closeBtn.className = 'tooltip-close';
                closeBtn.innerHTML = 'Ã—';
                closeBtn.onclick = function(e) {
                  e.stopPropagation();
                  tooltip.classList.remove('active');
                };
                tooltip.insertBefore(closeBtn, tooltip.firstChild);
              }
              
              // Click handler for icon
              icon.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                
                // Close all other tooltips
                document.querySelectorAll('.tooltip-content.active').forEach(t => {
                  if (t !== tooltip) t.classList.remove('active');
                });
                
                // Toggle this tooltip
                const isActive = tooltip.classList.contains('active');
                
                if (!isActive) {
                  // Move to body for proper z-index
                  document.body.appendChild(tooltip);
                  tooltip.classList.add('active');
                } else {
                  tooltip.classList.remove('active');
                }
              });
            }
          });
          
          // Close on click outside (on the dark overlay)
          document.addEventListener('click', function(e) {
            if (!e.target.closest('.tooltip-icon') && !e.target.closest('.tooltip-content')) {
              document.querySelectorAll('.tooltip-content.active').forEach(t => {
                t.classList.remove('active');
              });
            }
          });
          
          // Close on Escape key
          document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
              document.querySelectorAll('.tooltip-content.active').forEach(t => {
                t.classList.remove('active');
              });
            }
          });
        }
        
        // Run after DOM is ready
        initTooltips();
      });

      function initializeApp() {
        // Load saved data
        currentPoints = parseInt(storage.get('currentPoints', 0));
        selectedGoal = storage.get('selectedGoal', 'Emerald I');
        dailyEntries = storage.get('dailyEntries', []);
        undoHistory = storage.get('undoHistory', []);

        // Initialize UI
        initializeGoalSelector();
        initializePointsInput();
        calculateDaysRemaining();
        updateDashboard();
        renderRankLadder();
        renderDailyEntries();

        // Set today's date in entry form (if date input exists)
        const dateInput = document.getElementById('dateInput');
        if (dateInput && dateInput.type === 'date') {
          dateInput.valueAsDate = new Date();
        }

        // Update last updated indicator every minute
        setInterval(() => storage.updateLastUpdated(), 60000);
      }

      function initializeGoalSelector() {
        const select = document.getElementById('goalSelect');
        select.innerHTML = '';
        
        ranks.forEach(rank => {
          const option = document.createElement('option');
          option.value = rank.name;
          option.textContent = `${rank.name} (${rank.points} points)`;
          if (rank.name === selectedGoal) {
            option.selected = true;
          }
          select.appendChild(option);
        });

        updateGoalDisplay();
      }

      // Global reference to cancel debounce when needed
      let pendingPointsUpdate = null;
      
      function initializePointsInput() {
        const input = document.getElementById('currentPoints');
        input.value = currentPoints;
        
        // Debounced update with cancel capability
        const debouncedUpdate = debounce((value) => {
          if (pendingPointsUpdate === null) return; // Cancelled
          pendingPointsUpdate = null;
          updateCurrentPoints(parseInt(value) || 0);
        }, 500);
        
        input.addEventListener('input', (e) => {
          pendingPointsUpdate = e.target.value;
          debouncedUpdate(e.target.value);
        });

        input.addEventListener('focus', () => {
          input.select();
        });
        
        // Also update immediately on blur (when clicking away)
        input.addEventListener('blur', () => {
          if (pendingPointsUpdate !== null) {
            updateCurrentPoints(parseInt(pendingPointsUpdate) || 0);
            pendingPointsUpdate = null;
          }
        });
      }

      function updateGoal() {
        const select = document.getElementById('goalSelect');
        selectedGoal = select.value;
        storage.set('selectedGoal', selectedGoal);
        
        updateGoalDisplay();
        updateDashboard();
        
        showNotification(`Goal updated to ${selectedGoal}!`, 'success');
      }

      function updateGoalDisplay() {
        const goalRank = ranks.find(r => r.name === selectedGoal);
        if (!goalRank) return;

        // These elements were removed, so check if they exist first
        const iconEl = document.getElementById('goalIcon');
        const nameEl = document.getElementById('goalName');
        const pointsEl = document.getElementById('goalPoints');

        if (iconEl) {
          iconEl.textContent = goalRank.icon;
          iconEl.className = `goal-rank-icon rank-${goalRank.tier}`;
        }
        if (nameEl) {
          nameEl.textContent = goalRank.name;
        }
        if (pointsEl) {
          pointsEl.textContent = `${goalRank.points} points`;
        }
      }

      function updateCurrentPoints(newPoints) {
        if (isUpdating) return;
        isUpdating = true;

        const oldPoints = currentPoints;
        const goalRank = ranks.find(r => r.name === selectedGoal);
        const maxPoints = goalRank ? goalRank.points : 2400;
        
        newPoints = Math.max(0, Math.min(maxPoints, newPoints));
        currentPoints = newPoints;

        // Update the input field
        const pointsInput = document.getElementById('currentPoints');
        if (pointsInput) {
          pointsInput.value = currentPoints;
        }
        
        storage.set('currentPoints', currentPoints);

        // Check for rank achievements
        checkMilestones(oldPoints, newPoints);

        updateDashboard();
        renderRankLadder();
        
        isUpdating = false;
      }

      function calculateDaysRemaining() {
        const today = new Date();
        const seasonEnd = new Date(SEASON_END_DATE);
        const diffTime = seasonEnd - today;
        daysRemaining = Math.max(0, Math.ceil(diffTime / (1000 * 60 * 60 * 24)));
        return daysRemaining;
      }

      function updateDashboard() {
        const goalRank = ranks.find(r => r.name === selectedGoal);
        const goalPoints = goalRank ? goalRank.points : 2400;
        const pointsNeeded = Math.max(0, goalPoints - currentPoints);
        const pointsPerDay = daysRemaining > 0 ? Math.ceil(pointsNeeded / daysRemaining) : 0;

        // Store the required points per day for the graph
        localStorage.setItem('requiredPointsPerDay', pointsPerDay.toString());

        // Calculate projected completion based on average daily points
        // Use the configured season start date
        const seasonStart = new Date(SEASON_START_DATE);
        const today = new Date();
        const daysElapsed = Math.max(1, Math.ceil((today - seasonStart) / (1000 * 60 * 60 * 24)));
        const avgPointsPerDay = currentPoints / daysElapsed;
        const projectedTotalPoints = currentPoints + (avgPointsPerDay * daysRemaining);
        const completion = Math.round((projectedTotalPoints / goalPoints) * 100);

        // Calculate projected completion date
        let completionDateText = '--';
        let completionDateColor = '#ff3366';
        let completionDateSubtext = '';
        const seasonEnd = new Date(SEASON_END_DATE);

        if (avgPointsPerDay > 0) {
          const pointsRemaining = goalPoints - currentPoints;

          // Check if already at or above goal
          if (pointsRemaining <= 0) {
            completionDateText = 'âœ… GOAL REACHED!';
            completionDateColor = '#ff3366';
          } else {
            const daysToGoal = Math.ceil(pointsRemaining / avgPointsPerDay);
            const completionDate = new Date();
            completionDate.setDate(completionDate.getDate() + daysToGoal);

            // Compare dates properly (set both to midnight for accurate comparison)
            const completionDateMidnight = new Date(completionDate);
            completionDateMidnight.setHours(0, 0, 0, 0);
            const seasonEndMidnight = new Date(seasonEnd);
            seasonEndMidnight.setHours(23, 59, 59, 999); // End of day for season end

            if (completionDateMidnight <= seasonEndMidnight) {
              // Will complete before season ends
              if (daysToGoal === 1) {
                completionDateText = 'Tomorrow';
              } else if (daysToGoal <= 7) {
                completionDateText = `In ${daysToGoal} days`;
              } else {
                completionDateText = completionDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
              }

              // Calculate how many days ahead of schedule
              const daysAhead = daysRemaining - daysToGoal;
              if (daysAhead > 0 && daysToGoal > 0) {
                completionDateSubtext = `${daysAhead} days ahead of schedule`;
                completionDateColor = '#ff3366';
              }
            } else {
              // Won't complete at current pace
              completionDateText = `<span style="color: #ff4757;">âŒ</span> <span style="color: #ff4757;">${completionDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}</span>`;
              completionDateColor = '#ff4757';

              // Calculate how many days past season end
              const daysOverdue = Math.ceil((completionDate - seasonEnd) / (1000 * 60 * 60 * 24));
              completionDateSubtext = `${daysOverdue} days past season end`;
            }
          }
        } else if (currentPoints === 0) {
          completionDateText = 'Start playing!';
          completionDateColor = '#888';
        }

        // Update stats with animation
        animateValue('daysRemaining', daysRemaining);
        animateValue('pointsPerDay', pointsPerDay);
        animateValue('completion', completion + '%');

        // Update completion date
        const completionDateEl = document.getElementById('completionDate');
        if (completionDateEl) {
          completionDateEl.innerHTML = completionDateText;
          completionDateEl.style.color = completionDateColor;
        }

        // Add completion date subtext
        const completionDateCard = completionDateEl?.closest('.stat-card');
        if (completionDateCard) {
          let subtextEl = completionDateCard.querySelector('.completion-date-subtext');
          if (!subtextEl && completionDateSubtext) {
            subtextEl = document.createElement('div');
            subtextEl.className = 'completion-date-subtext';
            subtextEl.style.fontSize = '0.9em';
            subtextEl.style.marginTop = '5px';
            completionDateCard.appendChild(subtextEl);
          }
          if (subtextEl) {
            subtextEl.textContent = completionDateSubtext;
            subtextEl.style.color = completionDateColor === '#ff4757' ? '#ff4757' : '#888';
          }
        }

        // Update season end date
        const seasonEndDateEl = document.getElementById('seasonEndDate');
        if (seasonEndDateEl) {
          const endDate = new Date(SEASON_END_DATE);
          seasonEndDateEl.textContent = `Season ends ${endDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}`;
        }

        // Update daily goal status
        const dailyGoalStatusEl = document.getElementById('dailyGoalStatus');
        if (dailyGoalStatusEl) {
          // Check if user has achieved daily goal today
          const today = new Date().toISOString().split('T')[0];
          const todayEntry = dailyEntries.find(e => e.date === today);

          if (todayEntry && todayEntry.points >= pointsPerDay) {
            dailyGoalStatusEl.textContent = 'Goal achieved for today! âœ…';
            dailyGoalStatusEl.style.color = '#ff3366';
          } else if (todayEntry && todayEntry.points > 0) {
            const remaining = pointsPerDay - todayEntry.points;
            dailyGoalStatusEl.textContent = `${remaining} more points needed today`;
            dailyGoalStatusEl.style.color = '#9b59b6';
          } else if (pointsPerDay > 0) {
            dailyGoalStatusEl.textContent = '';
          } else {
            dailyGoalStatusEl.textContent = 'Goal already reached!';
            dailyGoalStatusEl.style.color = '#ff3366';
          }
        }

        // Update completion status
        const completionStatusEl = document.getElementById('completionStatus');
        if (completionStatusEl) {
          if (completion >= 100) {
            completionStatusEl.textContent = 'On pace to reach goal! âœ…';
            completionStatusEl.style.color = '#ff3366';
          } else if (completion >= 80) {
            completionStatusEl.textContent = 'Slightly behind pace';
            completionStatusEl.style.color = '#9b59b6';
          } else if (completion > 0) {
            completionStatusEl.textContent = 'Need to increase pace';
            completionStatusEl.style.color = '#ff4757';
          } else {
            completionStatusEl.textContent = '';
          }
        }

        // Update progress bar
        const progressBar = document.getElementById('progressBar');
        const progressText = document.getElementById('progressText');
        const progressTitle = document.getElementById('progressTitle');
        const progressPercent = Math.min(100, (currentPoints / goalPoints) * 100);

        progressBar.style.width = `${progressPercent}%`;
        progressText.textContent = `${Math.round(progressPercent)}%`;
        progressTitle.textContent = `Progress to ${selectedGoal}`;

        // Update milestone markers
        renderProgressMilestones(goalRank);

        // Check if goal achieved
        if (currentPoints >= goalPoints) {
          progressBar.parentElement.parentElement.classList.add('celebration-mode');
          document.getElementById('paceIndicator').textContent = `ðŸŽ‰ ${selectedGoal} Achieved! Congratulations!`;
          document.getElementById('paceIndicator').className = 'pace-indicator ahead';
        } else {
          progressBar.parentElement.parentElement.classList.remove('celebration-mode');
          updatePaceIndicator();
        }

        // Update next rank
        updateNextRank();

        // Update goal breakdown
        renderGoalBreakdown(pointsPerDay);
      }

      function updatePaceIndicator() {
        const goalRank = ranks.find(r => r.name === selectedGoal);
        const goalPoints = goalRank ? goalRank.points : 2400;

        const seasonStart = new Date(SEASON_START_DATE);
        const today = new Date();
        const seasonEnd = new Date(SEASON_END_DATE);

        const totalDays = Math.ceil((seasonEnd - seasonStart) / (1000 * 60 * 60 * 24));
        const daysElapsed = Math.ceil((today - seasonStart) / (1000 * 60 * 60 * 24));
        const daysRemaining = Math.ceil((seasonEnd - today) / (1000 * 60 * 60 * 24));

        const indicator = document.getElementById('paceIndicator');

        // Check if goal is already achieved
        if (currentPoints >= goalPoints) {
          indicator.textContent = 'ðŸŽ‰ Goal Achieved!';
          indicator.className = 'pace-indicator ahead';
          return;
        }

        // Calculate using same method as completion date for consistency
        const pointsNeeded = goalPoints - currentPoints;
        const avgPointsPerDay = daysElapsed > 0 ? currentPoints / daysElapsed : 0;

        if (avgPointsPerDay === 0) {
          indicator.textContent = 'âš ï¸ Start earning points to see pace';
          indicator.className = 'pace-indicator behind';
          return;
        }

        const daysToGoal = Math.ceil(pointsNeeded / avgPointsPerDay);
        const daysAheadOrBehind = daysRemaining - daysToGoal;

        if (Math.abs(daysAheadOrBehind) <= 2) {
          indicator.textContent = 'âœ… On track to reach goal';
          indicator.className = 'pace-indicator on-track';
        } else if (daysAheadOrBehind > 0) {
          indicator.textContent = `ðŸš€ ${daysAheadOrBehind} days ahead of schedule`;
          indicator.className = 'pace-indicator ahead';
        } else {
          // Calculate extra percentage needed per day
          const requiredDailyPoints = pointsNeeded / daysRemaining;
          const currentDailyRate = avgPointsPerDay;
          const extraPercentNeeded = Math.round(((requiredDailyPoints - currentDailyRate) / currentDailyRate) * 100);

          if (extraPercentNeeded > 0 && extraPercentNeeded < 500) {
            indicator.textContent = `âš ï¸ Behind schedule - need ${extraPercentNeeded}% more points per day`;
          } else {
            indicator.textContent = `âš ï¸ ${Math.abs(daysAheadOrBehind)} days behind schedule`;
          }
          indicator.className = 'pace-indicator behind';
        }
      }

      function updateNextRank() {
        let nextRank = null;
        for (const rank of ranks) {
          if (rank.points > currentPoints) {
            nextRank = rank;
            break;
          }
        }

        const pointsEl = document.querySelector('.next-rank-points');
        const nameEl = document.querySelector('.next-rank-name');
        
        if (nextRank) {
          pointsEl.textContent = nextRank.points - currentPoints;
          nameEl.textContent = nextRank.name;
        } else {
          pointsEl.textContent = '0';
          nameEl.textContent = 'Max Rank!';
        }
      }

      function renderGoalBreakdown(dailyPoints) {
        const breakdown = document.getElementById('goalBreakdown');
        
        if (dailyPoints <= 0) {
          breakdown.innerHTML = '<div style="color: #ff3366; font-size: 0.9em;">Goal achieved!</div>';
          return;
        }

        // Calculate realistic scenarios with Season 9 points
        const scenarios = [
          { wins: Math.ceil(dailyPoints / 25), type: 'wins' },
          { loseFinal: Math.ceil(dailyPoints / 14), type: 'loseFinal' },
          { round2: Math.ceil(dailyPoints / 6), type: 'round2' },
          { round1: Math.ceil(dailyPoints / 2), type: 'round1' }
        ];

        let html = '<div style="font-size: 0.8em; margin-top: 10px; color: #b0b0b0;">Hit ANY of these:</div>';
        html += '<div style="display: grid; gap: 3px; margin-top: 5px;">';

        let addedCount = 0;
        scenarios.forEach(scenario => {
          if (scenario[Object.keys(scenario)[0]] <= 10) {
            const label = scenario.type === 'wins' ? 'ðŸ† Wins' :
                         scenario.type === 'loseFinal' ? 'ðŸ¥‰ Lose Final' :
                         scenario.type === 'round2' ? 'âœ… Round 2 KO' :
                         'âŒ Round 1 KO';
            if (addedCount > 0) {
              html += `<div style="font-size: 0.7em; color: #666; text-align: center; margin: -2px 0;">â€” OR â€”</div>`;
            }
            html += `<div style="font-size: 0.9em;">${scenario[Object.keys(scenario)[0]]} ${label}</div>`;
            addedCount++;
          }
        });

        html += '</div>';
        breakdown.innerHTML = html;
      }

      function renderProgressMilestones(goalRank) {
        const milestonesContainer = document.getElementById('progressMilestones');
        if (!milestonesContainer || !goalRank) return;

        // Clear existing milestones
        milestonesContainer.innerHTML = '';

        // Define tier milestones (first rank of each tier)
        const tierMilestones = [
          { name: 'Bronze I', points: 100, tier: 'bronze', icon: 'B1' },
          { name: 'Silver I', points: 300, tier: 'silver', icon: 'S1' },
          { name: 'Gold I', points: 600, tier: 'gold', icon: 'G1' },
          { name: 'Platinum I', points: 1000, tier: 'platinum', icon: 'P1' },
          { name: 'Diamond I', points: 1450, tier: 'diamond', icon: 'D1' },
          { name: 'Emerald I', points: 2100, tier: 'emerald', icon: 'E1' }
        ];

        // Filter milestones up to the goal
        const relevantMilestones = tierMilestones.filter(m => m.points <= goalRank.points);

        // Add milestones
        relevantMilestones.forEach(milestone => {
          const markerDiv = document.createElement('div');
          markerDiv.className = 'milestone-marker';

          // Calculate position percentage
          const position = (milestone.points / goalRank.points) * 100;
          markerDiv.style.left = `${position}%`;

          // Create dot
          const dot = document.createElement('div');
          dot.className = 'milestone-dot';
          if (currentPoints >= milestone.points) {
            dot.classList.add('achieved');
          }

          // Create label
          const label = document.createElement('div');
          label.className = 'milestone-label';
          if (currentPoints >= milestone.points) {
            label.classList.add('achieved');
          }
          label.textContent = milestone.icon;

          markerDiv.appendChild(dot);
          markerDiv.appendChild(label);
          milestonesContainer.appendChild(markerDiv);
        });

        // Add the goal milestone if it's not already included
        const goalTier = goalRank.tier.charAt(0).toUpperCase() + goalRank.tier.slice(1);
        const goalNumber = goalRank.name.split(' ')[1];
        const isGoalAlreadyIncluded = relevantMilestones.some(m => m.points === goalRank.points);

        if (!isGoalAlreadyIncluded) {
          const markerDiv = document.createElement('div');
          markerDiv.className = 'milestone-marker';
          markerDiv.style.left = '100%';

          const dot = document.createElement('div');
          dot.className = 'milestone-dot';
          if (currentPoints >= goalRank.points) {
            dot.classList.add('achieved');
          }

          const label = document.createElement('div');
          label.className = 'milestone-label';
          if (currentPoints >= goalRank.points) {
            label.classList.add('achieved');
          }
          label.textContent = goalRank.icon.substring(0, 2);

          markerDiv.appendChild(dot);
          markerDiv.appendChild(label);
          milestonesContainer.appendChild(markerDiv);
        }
      }

      function renderRankLadder() {
        const ladder = document.getElementById('rankLadder');
        const fragment = document.createDocumentFragment();

        // Use requestAnimationFrame for smooth rendering
        requestAnimationFrame(() => {
          ladder.innerHTML = '';

          ranks.forEach((rank, index) => {
            const isCompleted = currentPoints >= rank.points;
            const isCurrent = !isCompleted && (index === 0 || currentPoints >= ranks[index - 1].points);

            const rankItem = document.createElement('div');
            rankItem.className = `rank-item ${isCompleted ? 'completed' : ''} ${isCurrent ? 'current' : ''}`;
            rankItem.style.animationDelay = `${index * 0.05}s`;

            // Content wrapper
            const content = document.createElement('div');
            content.className = 'rank-item-content';

            // Rank icon
            const icon = document.createElement('div');
            icon.className = `rank-icon rank-${rank.tier}`;
            icon.textContent = rank.icon;
            icon.style.fontSize = '1.4rem';
            icon.style.width = '48px';
            icon.style.height = '48px';
            icon.style.display = 'flex';
            icon.style.alignItems = 'center';
            icon.style.justifyContent = 'center';
            icon.style.borderRadius = '50%';
            icon.style.background = rank.tier === 'bronze' ? 'linear-gradient(135deg, #CD7F32, #8B4513)' :
                                    rank.tier === 'silver' ? 'linear-gradient(135deg, #C0C0C0, #808080)' :
                                    rank.tier === 'gold' ? 'linear-gradient(135deg, #FFD700, #FFA500)' :
                                    rank.tier === 'platinum' ? 'linear-gradient(135deg, #E5E4E2, #B8B8B8)' :
                                    rank.tier === 'diamond' ? 'linear-gradient(135deg, #00CED1, #00BFFF)' :
                                    'linear-gradient(135deg, #ff3366, #ff6699)';

            // Rank details
            const details = document.createElement('div');
            details.style.flex = '1';
            details.innerHTML = `
              <div class="rank-name" style="font-weight: 700; font-size: 1.1rem; color: ${isCompleted ? '#ff3366' : isCurrent ? '#fff' : '#b0b0b0'};">
                ${rank.name}
              </div>
              <div class="rank-points" style="font-size: 1rem; color: #888; margin-top: 2px;">
                ${rank.points} pts
              </div>
            `;

            content.appendChild(icon);
            content.appendChild(details);

            // Status indicator
            const status = document.createElement('div');
            status.className = `rank-status ${isCompleted ? 'completed' : ''}`;
            if (isCompleted) {
              status.innerHTML = 'âœ“';
            } else {
              status.style.background = 'transparent';
            }

            rankItem.appendChild(content);
            rankItem.appendChild(status);

            // Highlight current rank
            if (isCurrent) {
              rankItem.style.border = '2px solid #ff3366';
              rankItem.style.background = 'rgba(255, 51, 102, 0.1)';
            } else if (isCompleted) {
              rankItem.style.border = '2px solid rgba(255, 51, 102, 0.5)';
            }

            fragment.appendChild(rankItem);
          });

          ladder.appendChild(fragment);
        });
      }

      function quickAddPoints(points) {
        // Cancel any pending debounce update
        pendingPointsUpdate = null;
        
        // Always read the CURRENT input value first - respects manual edits
        const inputEl = document.getElementById('currentPoints');
        const inputValue = parseInt(inputEl.value) || 0;
        
        // Force sync currentPoints with whatever is in the input field
        currentPoints = inputValue;
        storage.set('currentPoints', currentPoints);
        
        const oldPoints = currentPoints;
        const newTotal = oldPoints + points;
        
        // Add to undo history (max 5 items)
        undoHistory.push({
          points: points,
          timestamp: Date.now(),
          oldTotal: oldPoints
        });
        
        if (undoHistory.length > 5) {
          undoHistory.shift();
        }
        
        storage.set('undoHistory', undoHistory);
        updateUndoButton();

        // Add to daily entries
        const today = new Date().toISOString().split('T')[0];
        const existingEntry = dailyEntries.find(e => e.date === today);

        if (existingEntry) {
          existingEntry.points += points;
          existingEntry.total = newTotal;
        } else {
          dailyEntries.push({
            date: today,
            points: points,
            total: newTotal,
            notes: `Quick add: +${points}`
          });
        }

        // Update currentPoints AFTER setting the entry totals
        updateCurrentPoints(newTotal);
        
        storage.set('dailyEntries', dailyEntries);
        renderDailyEntries();
        
        showNotification(`+${points} points added! Total: ${currentPoints}`, 'success');
      }

      function undoLastAdd() {
        if (undoHistory.length === 0) {
          showNotification('No actions to undo', 'error');
          return;
        }
        
        const lastAction = undoHistory.pop();
        storage.set('undoHistory', undoHistory);
        
        updateCurrentPoints(lastAction.oldTotal);
        updateUndoButton();
        
        // Remove from daily entries if it was today
        const today = new Date().toISOString().split('T')[0];
        const todayEntry = dailyEntries.find(e => e.date === today);
        if (todayEntry) {
          todayEntry.points -= lastAction.points;
          if (todayEntry.points <= 0) {
            dailyEntries = dailyEntries.filter(e => e.date !== today);
          }
        }
        
        storage.set('dailyEntries', dailyEntries);
        renderDailyEntries();
        
        showNotification(`Undid +${lastAction.points} points`, 'success');
      }

      function updateUndoButton() {
        const button = document.getElementById('undoButton');
        const pointsSpan = document.getElementById('undoPoints');
        
        if (undoHistory.length > 0) {
          const lastAction = undoHistory[undoHistory.length - 1];
          pointsSpan.textContent = `-${lastAction.points}`;
          button.style.opacity = '1';
        } else {
          pointsSpan.textContent = '-0';
          button.style.opacity = '0.5';
        }
      }

      function addDailyEntry() {
        const date = document.getElementById('dateInput').value;
        const points = parseInt(document.getElementById('pointsInput').value) || 0;
        const notes = document.getElementById('notesInput').value.trim();
        
        if (!date || points === 0) {
          showNotification('Please enter date and points', 'error');
          return;
        }
        
        // Sync currentPoints with input field value first
        const currentPointsInput = document.getElementById('currentPoints');
        const inputValue = parseInt(currentPointsInput.value) || 0;
        if (inputValue !== currentPoints) {
          currentPoints = inputValue;
          storage.set('currentPoints', currentPoints);
        }
        
        const newTotal = currentPoints + points;
        const existingIndex = dailyEntries.findIndex(e => e.date === date);

        if (existingIndex >= 0) {
          dailyEntries[existingIndex].points += points;
          dailyEntries[existingIndex].total = newTotal;
          if (notes) {
            dailyEntries[existingIndex].notes = notes;
          }
        } else {
          dailyEntries.push({
            date: date,
            points: points,
            total: newTotal,
            notes: notes
          });
        }

        // Sort by date
        dailyEntries.sort((a, b) => new Date(a.date) - new Date(b.date));

        storage.set('dailyEntries', dailyEntries);
        updateCurrentPoints(newTotal);
        
        // Clear form
        document.getElementById('pointsInput').value = '';
        document.getElementById('notesInput').value = '';
        
        renderDailyEntries();
        showNotification(`Entry added: +${points} points`, 'success');
      }

      // Helper function to get relative date text
      function getRelativeDateText(dateString) {
        const entryDate = new Date(dateString);
        const today = new Date();

        // Reset time parts for accurate day comparison
        entryDate.setHours(0, 0, 0, 0);
        today.setHours(0, 0, 0, 0);

        const diffTime = today - entryDate;
        const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));

        if (diffDays === 0) return 'today';
        if (diffDays === 1) return 'yesterday';
        if (diffDays <= 7) return `${diffDays} days ago`;
        return new Date(dateString).toLocaleDateString();
      }

      function renderDailyEntries() {
        const list = document.getElementById('entriesList');
        list.innerHTML = '';

        if (dailyEntries.length === 0) {
          list.innerHTML = '<div style="text-align: center; color: #666; padding: 20px;">No entries yet. Start tracking your progress!</div>';
          return;
        }

        // Show last 10 entries
        const recent = dailyEntries.slice(-10).reverse();

        recent.forEach(entry => {
          const item = document.createElement('div');
          item.className = 'entry-item';

          const dateEl = document.createElement('div');
          dateEl.textContent = new Date(entry.date).toLocaleDateString();

          const pointsEl = document.createElement('div');
          pointsEl.className = 'entry-points';
          const relativeDate = getRelativeDateText(entry.date);
          pointsEl.innerHTML = `<span style="color: #ff3366; font-weight: 600;">+${entry.points}</span> <span style="color: #666; font-size: 0.85em;">${relativeDate}</span>`;
          pointsEl.title = 'Total points earned on this day';

          const notesEl = document.createElement('div');
          notesEl.textContent = entry.notes || '';
          notesEl.style.color = '#888';
          notesEl.style.fontSize = '0.85em';

          const totalEl = document.createElement('div');
          totalEl.innerHTML = `<span style="color: #666; font-size: 0.85em;">Running total:</span> <span style="color: #ff3366; font-weight: 600;">${entry.total}</span>`;
          totalEl.style.textAlign = 'right';
          totalEl.title = 'Your total points after this day';

          item.appendChild(dateEl);
          item.appendChild(pointsEl);
          if (entry.notes) {
            item.appendChild(notesEl);
          }
          item.appendChild(totalEl);
          
          list.appendChild(item);
        });
      }

      function checkMilestones(oldPoints, newPoints) {
        for (const rank of ranks) {
          if (oldPoints < rank.points && newPoints >= rank.points) {
            showMilestonePopup(rank);
            createConfetti();
            break;
          }
        }
      }

      function showMilestonePopup(rank) {
        const popup = document.createElement('div');
        popup.className = 'milestone-popup';
        
        let message = 'Keep climbing!';
        if (rank.tier === 'bronze') message = 'Bronze achieved! The journey begins!';
        else if (rank.tier === 'silver') message = 'Silver status! Rising through the ranks!';
        else if (rank.tier === 'gold') message = 'Golden player! Impressive progress!';
        else if (rank.tier === 'platinum') message = 'Platinum prestige! Elite territory!';
        else if (rank.tier === 'diamond') message = 'Diamond hands! Near the top!';
        else if (rank.tier === 'emerald') message = 'EMERALD LEGEND! You\'ve made it!';
        
        popup.innerHTML = `
          <div class="milestone-icon">${rank.icon}</div>
          <div class="milestone-title">${rank.name} Unlocked!</div>
          <div class="milestone-message">${message}</div>
          <div style="font-size: 0.9em; opacity: 0.8; margin-bottom: 15px;">
            ${rank.points} points achieved
          </div>
          <button class="milestone-close" onclick="this.parentElement.remove()">Continue</button>
        `;
        
        document.body.appendChild(popup);
        
        setTimeout(() => {
          popup.remove();
        }, 5000);
      }

      function createConfetti() {
        for (let i = 0; i < 50; i++) {
          setTimeout(() => {
            const confetti = document.createElement('div');
            confetti.className = 'confetti';
            confetti.style.left = Math.random() * 100 + '%';
            confetti.style.backgroundColor = ['#ff3366', '#ff6699', '#6a1b9a', '#9b59b6', '#ff6b6b'][Math.floor(Math.random() * 5)];
            confetti.style.animationDuration = (Math.random() * 2 + 2) + 's';
            document.body.appendChild(confetti);
            
            setTimeout(() => confetti.remove(), 3000);
          }, i * 30);
        }
      }

      function showNotification(message, type = 'success') {
        const notification = document.getElementById('notification');
        notification.textContent = message;
        notification.className = `notification ${type} show`;
        
        setTimeout(() => {
          notification.classList.remove('show');
        }, 3000);
      }

      function animateValue(elementId, value) {
        const element = document.getElementById(elementId);
        if (!element) return;
        
        const current = element.textContent;
        const isPercentage = typeof value === 'string' && value.includes('%');
        const numericValue = parseFloat(value) || 0;
        const currentNumeric = parseFloat(current) || 0;
        
        if (Math.abs(numericValue - currentNumeric) < 0.1) {
          element.textContent = value;
          return;
        }
        
        const duration = 500;
        const steps = 20;
        const increment = (numericValue - currentNumeric) / steps;
        let step = 0;
        
        const timer = setInterval(() => {
          step++;
          const newValue = currentNumeric + (increment * step);
          
          if (step >= steps) {
            element.textContent = value;
            clearInterval(timer);
          } else {
            element.textContent = isPercentage ? newValue.toFixed(1) + '%' : Math.round(newValue);
          }
        }, duration / steps);
      }

      // Nav functions
      function shareProgress() {
        const goalRank = ranks.find(r => r.name === selectedGoal);
        const goalPoints = goalRank ? goalRank.points : 2400;
        const progress = ((currentPoints / goalPoints) * 100).toFixed(1);
        
        const text = `ðŸŽ® THE FINALS Season 9 Progress\n` +
                    `ðŸ“Š ${currentPoints}/${goalPoints} points (${progress}%)\n` +
                    `ðŸŽ¯ Goal: ${selectedGoal}\n` +
                    `ðŸ“… ${daysRemaining} days remaining\n` +
                    `ðŸ”— Track yours at: thefinalsloadout.com/wt-progress`;
        
        if (navigator.share) {
          navigator.share({
            title: 'My World Tour Progress',
            text: text
          });
        } else {
          navigator.clipboard.writeText(text);
          showNotification('Progress copied to clipboard!', 'success');
        }
      }

      function takeScreenshot() {
        document.body.classList.add('screenshot-mode');
        
        setTimeout(() => {
          showNotification('Screenshot ready! Use your device\'s screenshot feature.', 'success');
          
          setTimeout(() => {
            document.body.classList.remove('screenshot-mode');
          }, 3000);
        }, 100);
      }

      function resetData() {
        if (confirm('Are you sure you want to reset all data? This cannot be undone.')) {
          // Clear all localStorage data
          localStorage.clear();

          // Reset global variables to defaults
          currentPoints = 0;
          selectedGoal = 'Emerald I';
          dailyEntries = [];
          undoHistory = [];

          // Set fresh defaults in localStorage
          localStorage.setItem('cacheVersion', STORAGE_VERSION);
          localStorage.setItem('currentPoints', '0');
          localStorage.setItem('selectedGoal', 'Emerald I');
          localStorage.setItem('dailyEntries', '[]');
          localStorage.setItem('undoHistory', '[]');
          localStorage.setItem('seasonStartDate', SEASON_START_DATE);
          localStorage.setItem('seasonEndDate', SEASON_END_DATE);

          // Clear storage cache
          storage.cache = {};
          storage.cacheTimestamps = {};

          // Reload the page to reinitialize everything
          location.reload();
        }
      }

      // Auto-save on visibility change
      document.addEventListener('visibilitychange', () => {
        if (document.hidden) {
          // Save current state
          storage.set('currentPoints', currentPoints);
          storage.set('selectedGoal', selectedGoal);
          storage.set('dailyEntries', dailyEntries);
          storage.set('undoHistory', undoHistory);
        }
      });

      // Update timer
      setInterval(() => {
        calculateDaysRemaining();
        const daysEl = document.getElementById('daysRemaining');
        if (daysEl && parseInt(daysEl.textContent) !== daysRemaining) {
          updateDashboard();
        }
      }, 60000); // Update every minute

      // First time user functions
      function checkFirstTimeUser() {
        const hasVisited = localStorage.getItem('hasVisitedBefore');
        if (!hasVisited) {
          document.getElementById('firstTimeOverlay').style.display = 'flex';
        }
      }

      function closeFirstTimeOverlay() {
        document.getElementById('firstTimeOverlay').style.display = 'none';
        localStorage.setItem('hasVisitedBefore', 'true');

        // Add highlight animations to guide user
        const goalContainer = document.getElementById('goalSelectorContainer');
        const pointsContainer = document.getElementById('pointsInputContainer');

        goalContainer.classList.add('highlight-action');
        setTimeout(() => {
          goalContainer.classList.remove('highlight-action');
          pointsContainer.classList.add('highlight-action');
          setTimeout(() => {
            pointsContainer.classList.remove('highlight-action');
          }, 6000);
        }, 1000);
      }

      function showHelp() {
        document.getElementById('firstTimeOverlay').style.display = 'flex';
      }

      function addInteractiveHighlights() {
        const pointsInput = document.getElementById('currentPoints');
        const pointsContainer = document.getElementById('pointsInputContainer');
        const goalSelect = document.getElementById('goalSelect');
        const goalContainer = document.getElementById('goalSelectorContainer');

        // Add click handler to the entire points container
        pointsContainer.addEventListener('click', () => {
          pointsInput.focus();
          pointsInput.select();
        });

        // Remove highlight when user interacts
        goalSelect.addEventListener('change', () => {
          goalContainer.classList.remove('highlight-action');
          // Highlight points input after goal selection
          setTimeout(() => {
            pointsContainer.classList.add('highlight-action');
            setTimeout(() => {
              pointsContainer.classList.remove('highlight-action');
            }, 4000);
          }, 500);
        });

        pointsInput.addEventListener('input', () => {
          pointsContainer.classList.remove('highlight-action');
        });

        // If user hasn't set points or goal, add subtle animation
        if (currentPoints === 0 && !localStorage.getItem('hasVisitedBefore')) {
          setTimeout(() => {
            if (currentPoints === 0) {
              goalContainer.classList.add('highlight-action');
            }
          }, 2000);
        }
      }
    </script>

    <!-- Feedback Section -->
    <div style="text-align: center; padding: 30px 10px; margin-top: 40px;">
        <p style="color: #888; font-size: 0.95em; margin-bottom: 12px;">Found a bug or have suggestions?</p>
        <a href="/feedback/"
           style="color: #9b59b6; text-decoration: none; font-weight: 600; padding: 10px 20px; border: 1px solid #9b59b6; border-radius: 5px; display: inline-block; transition: all 0.3s ease;"
           onmouseover="this.style.background='linear-gradient(135deg, #6a1b9a, #9b59b6)'; this.style.borderColor='#6a1b9a'; this.style.color='#fff';"
           onmouseout="this.style.background='transparent'; this.style.borderColor='#9b59b6'; this.style.color='#9b59b6';">
            ðŸ“ Submit Feedback
        </a>
    </div>

  <!-- Bug Fixes for Date Handling and Running Totals (optional) -->
  <script src="wt-fixes.js" onerror="console.log('wt-fixes.js not found, using built-in functions')"></script>
  </body>
</html>
