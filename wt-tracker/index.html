<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>S7 Emerald Progress Tracker</title>
    <link rel="icon" type="image/x-icon" href="images/favicon.ico" />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        background-color: #1a1a1a;
        color: #ffffff;
        font-family: "Arial", sans-serif;
        padding: 20px;
        min-height: 100vh;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
      }

      .logo {
        display: block;
        margin: 0 auto 30px auto;
        max-width: 300px;
        height: auto;
      }

      /* Progress Dashboard */
      .dashboard {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 20px;
        margin-bottom: 40px;
      }

      .stat-card {
        background: linear-gradient(135deg, #2e6349 0%, #1a1a1a 100%);
        border: 2px solid #3b7f5f;
        border-radius: 10px;
        padding: 20px;
        text-align: center;
        position: relative;
        overflow: hidden;
      }

      .stat-card::before {
        content: "";
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: radial-gradient(
          circle,
          rgba(80, 200, 120, 0.1) 0%,
          transparent 70%
        );
        animation: pulse 4s ease-in-out infinite;
        pointer-events: none;
      }

      @keyframes pulse {
        0%,
        100% {
          transform: scale(1);
          opacity: 0.5;
        }
        50% {
          transform: scale(1.1);
          opacity: 0.8;
        }
      }

      .stat-label {
        font-size: 0.9em;
        color: #aaa;
        margin-bottom: 10px;
      }

      .stat-value {
        font-size: 2.5em;
        font-weight: bold;
        color: #50c878;
        text-shadow: 0 0 10px rgba(80, 200, 120, 0.5);
      }

      .highlight {
        background: #3b7f5f;
        border: 2px solid #50c878;
        box-shadow: 0 0 20px rgba(80, 200, 120, 0.3);
      }

      /* Progress Bar */
      .progress-section {
        margin-bottom: 40px;
      }

      .progress-container {
        background: #0a0a0a;
        border: 2px solid #3b7f5f;
        border-radius: 20px;
        padding: 5px;
        position: relative;
        height: 40px;
        overflow: hidden;
      }

      .progress-bar {
        height: 100%;
        background: linear-gradient(90deg, #2e6349 0%, #50c878 100%);
        border-radius: 15px;
        transition: width 0.5s ease;
        position: relative;
        box-shadow: 0 0 20px rgba(80, 200, 120, 0.5);
      }

      .progress-text {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-weight: bold;
        z-index: 10;
      }

      /* Rank Ladder */
      .rank-ladder {
        background: #0a0a0a;
        border: 2px solid #3b7f5f;
        border-radius: 10px;
        padding: 20px;
        margin-bottom: 40px;
      }

      .rank-item {
        display: grid;
        grid-template-columns: 60px 150px 100px 100px 100px 150px 1fr;
        align-items: center;
        padding: 10px;
        margin-bottom: 5px;
        border-radius: 5px;
        transition: all 0.3s ease;
      }

      .rank-item:hover {
        transform: translateX(5px);
        box-shadow: 0 0 15px rgba(80, 200, 120, 0.3);
      }

      .rank-item.completed {
        background: rgba(80, 200, 120, 0.2);
        border-left: 4px solid #50c878;
      }

      .rank-item.current {
        background: rgba(255, 215, 0, 0.2);
        border-left: 4px solid #ffd700;
        animation: glow 2s ease-in-out infinite;
      }

      @keyframes glow {
        0%,
        100% {
          box-shadow: 0 0 5px rgba(255, 215, 0, 0.5);
        }
        50% {
          box-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
        }
      }

      .rank-item.locked {
        background: rgba(128, 128, 128, 0.1);
        opacity: 0.6;
      }

      .rank-icon {
        width: 50px;
        height: 50px;
        background: #3b7f5f;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        font-size: 0.8em;
      }

      .mini-progress {
        height: 20px;
        background: #0a0a0a;
        border: 1px solid #3b7f5f;
        border-radius: 10px;
        overflow: hidden;
        position: relative;
      }

      .mini-progress-bar {
        height: 100%;
        background: linear-gradient(90deg, #2e6349 0%, #50c878 100%);
        transition: width 0.5s ease;
      }

      /* Win Points Reference - Updated to be smaller and centered */
      .reference-card {
        position: fixed;
        right: 20px;
        top: 50%;
        transform: translateY(-50%);
        background: #2e6349;
        border: 2px solid #3b7f5f;
        border-radius: 10px;
        padding: 15px;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5);
        font-size: 0.9em;
      }

      .reference-card h3 {
        color: #50c878;
        margin-bottom: 10px;
        text-align: center;
        font-size: 1.1em;
      }

      .reference-item {
        display: flex;
        justify-content: space-between;
        margin-bottom: 8px;
        padding: 4px;
        border-bottom: 1px solid #3b7f5f;
      }

      /* Daily Tracker */
      .daily-tracker {
        background: #0a0a0a;
        border: 2px solid #3b7f5f;
        border-radius: 10px;
        padding: 20px;
      }

      .daily-input {
        display: grid;
        grid-template-columns: 150px 150px 150px 1fr;
        gap: 10px;
        margin-bottom: 10px;
        align-items: center;
      }

      input {
        background: #2e6349;
        border: 1px solid #50c878;
        color: #fff;
        padding: 8px;
        border-radius: 5px;
        font-size: 1em;
      }

      input:focus {
        outline: none;
        box-shadow: 0 0 10px rgba(80, 200, 120, 0.5);
      }

      .points-input-container {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
      }

      #currentPointsInput {
        background: rgba(0, 0, 0, 0.5);
        border: 2px solid #50c878;
        color: #50c878;
        font-size: 2.5em;
        text-align: center;
        width: 150px;
        font-weight: bold;
        text-shadow: 0 0 10px rgba(80, 200, 120, 0.5);
        padding: 5px;
        border-radius: 5px;
        position: relative;
        z-index: 10;
      }

      #currentPointsInput:hover {
        background: rgba(80, 200, 120, 0.1);
        border-color: #ffd700;
      }

      #currentPointsInput:focus {
        background: rgba(80, 200, 120, 0.2);
        border: 2px solid #ffd700;
        outline: none;
      }

      .edit-btn {
        background: #50c878;
        border: none;
        color: #1a1a1a;
        padding: 5px 10px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 0.8em;
        font-weight: bold;
      }

      .edit-btn:hover {
        background: #ffd700;
      }

      button {
        background: linear-gradient(135deg, #3b7f5f 0%, #50c878 100%);
        border: none;
        color: #fff;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        font-weight: bold;
        transition: all 0.3s ease;
      }

      button:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(80, 200, 120, 0.4);
      }

      .delete-btn {
        background: #ff4444;
        padding: 5px 10px;
        font-size: 0.9em;
        margin-left: 10px;
      }

      .delete-btn:hover {
        background: #cc0000;
        box-shadow: 0 5px 15px rgba(255, 68, 68, 0.4);
      }

      /* Responsive */
      @media (max-width: 768px) {
        body {
          padding: 10px;
        }

        .logo {
          max-width: 200px;
          margin-bottom: 20px;
        }

        .dashboard {
          grid-template-columns: 1fr;
          gap: 15px;
        }

        .stat-card {
          padding: 15px;
        }

        .stat-value {
          font-size: 2em;
        }

        .stat-label {
          font-size: 0.85em;
        }

        #currentPointsInput {
          font-size: 2em;
          width: 120px;
        }

        /* Fix rank ladder for mobile */
        .rank-item {
          display: flex;
          flex-wrap: wrap;
          align-items: center;
          padding: 8px;
          font-size: 0.85em;
        }

        .rank-icon {
          width: 40px;
          height: 40px;
          font-size: 0.7em;
          margin-right: 10px;
        }

        .rank-item > div:nth-child(2) {
          flex: 1;
          min-width: 80px;
        }

        .rank-item > div:nth-child(3),
        .rank-item > div:nth-child(4),
        .rank-item > div:nth-child(5),
        .rank-item > div:nth-child(6) {
          margin: 0 5px;
          font-size: 0.8em;
        }

        .mini-progress {
          width: 100%;
          margin-top: 8px;
          height: 15px;
        }

        /* Hide reference card on mobile */
        .reference-card {
          display: none;
        }

        /* Daily tracker adjustments */
        .daily-input {
          grid-template-columns: 1fr;
          gap: 8px;
        }

        .daily-input input,
        .daily-input button {
          width: 100%;
        }

        /* Progress section */
        .progress-section h2 {
          font-size: 1.3em;
        }

        .progress-container {
          height: 35px;
        }

        .progress-text {
          font-size: 0.9em;
        }

        /* Entry display */
        .daily-tracker {
          padding: 15px;
        }

        /* Delete button positioning */
        .delete-btn {
          white-space: nowrap;
          font-size: 0.8em;
          padding: 4px 8px;
        }
      }

      /* Extra small devices */
      @media (max-width: 480px) {
        .stat-value {
          font-size: 1.8em;
        }

        #currentPointsInput {
          font-size: 1.8em;
          width: 100px;
        }

        .rank-item {
          font-size: 0.75em;
        }

        h2 {
          font-size: 1.2em;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <img
        src="https://thefinalsloadout.com/wt-tracker/images/logo.webp"
        alt="The Finals"
        class="logo"
      />

      <!-- Progress Dashboard -->
      <div class="dashboard">
        <div class="stat-card">
          <div class="stat-label">Current Points (Click number to edit)</div>
          <div class="points-input-container">
            <input
              type="number"
              id="currentPointsInput"
              value="400"
              min="0"
              max="2400"
            />
          </div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Days Remaining</div>
          <div class="stat-value" id="daysRemaining">60</div>
        </div>
        <div class="stat-card highlight">
          <div class="stat-label">Points Needed Per Day</div>
          <div class="stat-value" id="pointsPerDay">32</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Completion</div>
          <div class="stat-value" id="completion">16.7%</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Points to Next Rank</div>
          <div class="stat-value" id="pointsToNext">
            50<br /><span style="font-size: 0.5em; color: #aaa">(Gold 3)</span>
          </div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Projected Completion</div>
          <div class="stat-value" id="projectedDate" style="font-size: 1.5em">
            Sept 12
          </div>
        </div>
      </div>

      <!-- Main Progress Bar -->
      <div class="progress-section">
        <h2 style="color: #50c878; margin-bottom: 10px">
          Progress to Emerald 1
        </h2>
        <div class="progress-container">
          <div
            class="progress-bar"
            id="mainProgress"
            style="width: 16.7%"
          ></div>
          <div class="progress-text">400 / 2400</div>
        </div>
      </div>

      <!-- Rank Ladder -->
      <div class="rank-ladder">
        <h2 style="color: #50c878; margin-bottom: 20px">Rank Ladder</h2>
        <div id="rankLadder"></div>
      </div>

      <!-- Daily Tracker -->
      <div class="daily-tracker">
        <h2 style="color: #50c878; margin-bottom: 20px">
          Daily Points Tracker
        </h2>
        <div class="daily-input">
          <input type="date" id="dateInput" value="" />
          <input type="number" id="pointsInput" placeholder="Points earned" />
          <button onclick="addDailyEntry()">Add Entry</button>
          <input type="text" id="notesInput" placeholder="Notes (optional)" />
        </div>
        <div id="dailyEntries"></div>
      </div>
    </div>

    <!-- Win Points Reference -->
    <div class="reference-card">
      <h3>Win Points Reference</h3>
      <div class="reference-item">
        <span>Round 1</span>
        <span style="color: #50c878; font-weight: bold">2</span>
      </div>
      <div class="reference-item">
        <span>Round 2</span>
        <span style="color: #50c878; font-weight: bold">6</span>
      </div>
      <div class="reference-item">
        <span>2nd Place</span>
        <span style="color: #50c878; font-weight: bold">14</span>
      </div>
      <div class="reference-item">
        <span>1st Place</span>
        <span style="color: #50c878; font-weight: bold">25</span>
      </div>
    </div>

    <script>
      // Rank data
      const ranks = [
        { name: "Gold 4", points: 375, icon: "G4" },
        { name: "Gold 3", points: 450, icon: "G3" },
        { name: "Gold 2", points: 525, icon: "G2" },
        { name: "Gold 1", points: 600, icon: "G1" },
        { name: "Platinum 4", points: 700, icon: "P4" },
        { name: "Platinum 3", points: 800, icon: "P3" },
        { name: "Platinum 2", points: 900, icon: "P2" },
        { name: "Platinum 1", points: 1000, icon: "P1" },
        { name: "Diamond 4", points: 1150, icon: "D4" },
        { name: "Diamond 3", points: 1300, icon: "D3" },
        { name: "Diamond 2", points: 1450, icon: "D2" },
        { name: "Diamond 1", points: 1600, icon: "D1" },
        { name: "Emerald 4", points: 1800, icon: "E4" },
        { name: "Emerald 3", points: 2000, icon: "E3" },
        { name: "Emerald 2", points: 2200, icon: "E2" },
        { name: "Emerald 1", points: 2400, icon: "E1" },
      ];

      // State - with localStorage
      let currentPoints = parseInt(
        localStorage.getItem("currentPoints") || "400"
      );
      let dailyEntries = JSON.parse(
        localStorage.getItem("dailyEntries") || "[]"
      );

      // Calculate days remaining from September 10, 2025
      const endDate = new Date("2025-09-10");
      const today = new Date();
      const daysRemaining = Math.ceil(
        (endDate - today) / (1000 * 60 * 60 * 24)
      );

      // Initialize
      document.getElementById("dateInput").value = new Date()
        .toISOString()
        .split("T")[0];
      document.getElementById("currentPointsInput").value = currentPoints;

      // Add event listeners for current points input
      document
        .getElementById("currentPointsInput")
        .addEventListener("input", function (e) {
          updateCurrentPoints(e.target.value);
        });

      document
        .getElementById("currentPointsInput")
        .addEventListener("change", function (e) {
          updateCurrentPoints(e.target.value);
        });

      updateDashboard();
      renderRankLadder();
      renderDailyEntries();

      function updateCurrentPoints(value) {
        currentPoints = parseInt(value) || 0;
        localStorage.setItem("currentPoints", currentPoints);
        updateDashboard();
        renderRankLadder();
      }

      function updateDashboard() {
        const pointsNeeded = 2400 - currentPoints;
        const pointsPerDay = Math.round(pointsNeeded / daysRemaining);
        const completion = ((currentPoints / 2400) * 100).toFixed(1);
        const projectedDays = Math.ceil(pointsNeeded / pointsPerDay);
        const projectedDate = new Date();
        projectedDate.setDate(projectedDate.getDate() + projectedDays);

        // Find next rank
        let pointsToNext = 0;
        let nextRankName = "Emerald 1";
        for (let rank of ranks) {
          if (rank.points > currentPoints) {
            pointsToNext = rank.points - currentPoints;
            nextRankName = rank.name;
            break;
          }
        }

        // Update UI
        document.getElementById("daysRemaining").textContent = daysRemaining;
        document.getElementById("pointsPerDay").textContent = pointsPerDay;
        document.getElementById("completion").textContent = completion + "%";
        document.getElementById(
          "pointsToNext"
        ).innerHTML = `${pointsToNext}<br><span style="font-size: 0.5em; color: #AAA;">(${nextRankName})</span>`;
        document.getElementById("projectedDate").textContent =
          projectedDate.toLocaleDateString("en-US", {
            month: "short",
            day: "numeric",
          });

        // Update main progress bar
        document.getElementById("mainProgress").style.width = completion + "%";
        document.querySelector(
          ".progress-text"
        ).textContent = `${currentPoints} / 2400`;
      }

      function renderRankLadder() {
        const ladder = document.getElementById("rankLadder");
        ladder.innerHTML = "";

        ranks.forEach((rank, index) => {
          const prevPoints = index > 0 ? ranks[index - 1].points : 0;
          const status =
            currentPoints >= rank.points
              ? "completed"
              : currentPoints < rank.points && currentPoints >= prevPoints
              ? "current"
              : "locked";
          const completion = Math.min(
            (currentPoints / rank.points) * 100,
            100
          ).toFixed(0);
          const gap = Math.max(rank.points - currentPoints, 0);

          const rankItem = document.createElement("div");
          rankItem.className = `rank-item ${status}`;

          // Determine icon color based on rank tier
          let iconColor = "#3B7F5F";
          if (rank.name.includes("Emerald")) iconColor = "#50C878";
          else if (rank.name.includes("Diamond")) iconColor = "#87CEEB";
          else if (rank.name.includes("Platinum")) iconColor = "#E5E4E2";
          else if (rank.name.includes("Gold")) iconColor = "#FFD700";

          rankItem.innerHTML = `
                    <div class="rank-icon" style="background: ${iconColor};">${
            rank.icon
          }</div>
                    <div style="font-weight: bold;">${rank.name}</div>
                    <div>${rank.points}</div>
                    <div style="color: ${
                      status === "completed"
                        ? "#50C878"
                        : status === "current"
                        ? "#FFD700"
                        : "#808080"
                    };">${status.toUpperCase()}</div>
                    <div>${completion}%</div>
                    <div>${gap} gap</div>
                    <div class="mini-progress">
                        <div class="mini-progress-bar" style="width: ${completion}%"></div>
                    </div>
                `;

          ladder.appendChild(rankItem);
        });
      }

      function addDailyEntry() {
        const date = document.getElementById("dateInput").value;
        const points = parseInt(document.getElementById("pointsInput").value);
        const notes = document.getElementById("notesInput").value;

        if (!date || !points) {
          alert("Please enter date and points");
          return;
        }

        currentPoints += points;
        dailyEntries.push({ date, points, total: currentPoints, notes });

        // Save to localStorage
        localStorage.setItem("currentPoints", currentPoints);
        localStorage.setItem("dailyEntries", JSON.stringify(dailyEntries));

        // Update input field
        document.getElementById("currentPointsInput").value = currentPoints;

        // Clear inputs
        document.getElementById("pointsInput").value = "";
        document.getElementById("notesInput").value = "";

        // Update everything
        updateDashboard();
        renderRankLadder();
        renderDailyEntries();

        // Keep the same date instead of incrementing
        // This allows multiple entries for the same day if needed
        // const nextDate = new Date(date);
        // nextDate.setDate(nextDate.getDate() + 1);
        // document.getElementById('dateInput').value = nextDate.toISOString().split('T')[0];
      }

      function renderDailyEntries() {
        const container = document.getElementById("dailyEntries");
        container.innerHTML =
          '<h3 style="color: #50C878; margin-top: 20px;">Recent Entries</h3>';

        dailyEntries
          .slice(-5)
          .reverse()
          .forEach((entry, displayIndex) => {
            const actualIndex = dailyEntries.length - 1 - displayIndex;
            const entryDiv = document.createElement("div");
            entryDiv.style.cssText =
              "padding: 10px; margin: 5px 0; background: #2E6349; border-radius: 5px; display: flex; justify-content: space-between; align-items: center;";
            entryDiv.innerHTML = `
                    <div>
                        <strong>${entry.date}</strong> - 
                        <span style="color: #50C878;">+${
                          entry.points
                        } points</span> - 
                        Total: ${entry.total}
                        ${entry.notes ? ` - ${entry.notes}` : ""}
                    </div>
                    <button class="delete-btn" onclick="deleteEntry(${actualIndex})">Delete</button>
                `;
            container.appendChild(entryDiv);
          });
      }

      function deleteEntry(index) {
        if (confirm("Are you sure you want to delete this entry?")) {
          // Get the points from the entry being deleted
          const deletedPoints = dailyEntries[index].points;

          // Remove the entry
          dailyEntries.splice(index, 1);

          // Recalculate current points
          currentPoints =
            dailyEntries.length > 0
              ? dailyEntries[dailyEntries.length - 1].total
              : 0;

          // Update localStorage
          localStorage.setItem("currentPoints", currentPoints);
          localStorage.setItem("dailyEntries", JSON.stringify(dailyEntries));

          // Update input field
          document.getElementById("currentPointsInput").value = currentPoints;

          // Update everything
          updateDashboard();
          renderRankLadder();
          renderDailyEntries();
        }
      }
    </script>
  </body>
</html>
